{
  "EnhancedContent": "## Recommended Outbound Connectivity\n\n[StandardV2 NAT Gateway](https://learn.microsoft.com/en-us/azure/nat-gateway/nat-overview#standardv2-nat-gateway) is the next evolution of outbound connectivity in Azure. As the recommended solution for providing secure, reliable outbound Internet access, NAT Gateway continues to be the default choice for modern Azure deployments. With the highly anticipated general availability of the new StandardV2 SKU, customers gain access to the following highly requested upgrades:\n\n- Zone-redundancy: Automatically maintains outbound connectivity during single‑zone failures in AZ-enabled regions.\n- Enhanced performance: Up to 100 Gbps of throughput and 10 million packets per second - double the Standard SKU capacity.\n- Dual-stack support: Attach up to 16 IPv6 and 16 IPv4 public IP addresses for future ready connectivity.\n- Flow logs: Access historical logs of connections being established through your NAT gateway.\n\nThis blog will focus on how enabling StandardV2 NAT Gateway flow logs can be beneficial for your team along with some tips to get the most out of the data.\n\n## What are flow logs?\n\nStandardV2 NAT Gateway flow logs are enabled through Diagnostic settings on your NAT gateway resource where the log data can be sent to Log Analytics, a storage account, or Event hub destination. “NatGatewayFlowlogV1” is the released log category, and it provides IP level information on traffic flowing through your StandardV2 NAT gateway.\n\n*Enable NAT* *Gateway Flow Logs through Diagnostics setting on your StandardV2 NAT gateway resource.*\n\n*Schema output as seen on Log Analytics for a NAT gateway traffic flow.*\n\n### Why should I use flow logs?\n\nSecurity and compliance visibility\n\nPrior to NAT gateway flow logs, customers could not see NAT gateway information when their virtual machines connect outbound. This made it difficult to:\n\n- Validate that only approved destinations were being accessed\n- Audit suspicious or unexpected outbound patterns\n- Satisfy compliance requirements that mandate traffic recording\n\nFlow logs now provide visibility to the source IP -&gt; NAT gateway outbound IP -&gt; destination IP, along with details on sent/dropped packets and bytes.\n\nUsage analytics\n\nFlow logs allow you to answer usage questions such as:\n\n- Which VMs are generating the most outbound requests?\n- Which destinations receive the most traffic?\n- Is throughput growth caused by a specific workload pattern?\n\nThis level of insight is especially useful when debugging unexpected throughput increases, billing spikes, and connection bottlenecks.\n\n> >\n> *To note: Flow logs only capture established connections. This means the TCP 3* *‑* *way handshake (SYN → SYN/ACK → ACK) or the UDP ephemeral session setup must complete.* *If a connection never establishes, for example due to NSG denial, routing mismatch, or SNAT exhaustion, it will not appear in flow logs.*\n> >\n\n### Workflow of troubleshooting with flow logs\n\nLet's walk through how you can leverage flow logs to troubleshoot a scenario where you are seeing intermittent connection drops.\n\n**Scenario: You have VMs that use a StandardV2 NAT gateway to reach the Internet. However, your VMs intermittently fail to reach github.com.**\n\n**Step 1: Check NAT gateway health**\n\nStart with the datapath availability metric, which reflects the NAT gateway's overall health.\n\n- If metric &gt; 90%, this confirms NAT gateway is healthy and is working as expected to send outbound traffic to the internet. Continue to Step 2.\n- If metric is lower, visit [Troubleshoot Azure NAT Gateway connectivity - Azure NAT Gateway | Microsoft Learn](https://learn.microsoft.com/en-us/azure/nat-gateway/troubleshoot-nat-connectivity#datapath-availability-drop-on-nat-gateway-with-connection-failures) for troubleshooting tips.\n\n**Step 2: Enable StandardV2 NAT Gateway Flow Logs**\n\nTo further investigate the root cause, Enable StandardV2 NAT Gateway Flow Logs (*NatGatewayFlowLogsV1* log category in Diagnostics Setting) for the NAT gateway resource providing outbound connectivity for the impacted VMs. It is recommended to enable Log Analytics as a destination as it allows you to easily query the data. For the detailed steps, visit [Monitor with StandardV2 NAT Gateway Flow Logs - Azure NAT Gateway | Microsoft Learn](https://learn.microsoft.com/en-us/azure/nat-gateway/monitor-nat-gateway-flow-logs).\n\n> >\n> *Tip: You may enable flow logs even when not troubleshooting to ensure you’ll have historical data to reference when issues occur.*\n> >\n\n**Step 3: Confirm whether the connection was established**\n\n1. Use Log Analytics to query for flows with source IP == VM private IP and destination IP == IP address(es) of github.com. The following query will generate a table and chart of the total packets sent per minute from your source IP to the destination IP through your NAT gateway in the last 24 hours.\n\n``` NatGatewayFlowlogsV1 | where TimeGenerated > ago(1d) | where SourceIP == '10.0.0.4' //and DestinationIP == <\"github.com IP\"> | summarize TotalPacketsSent = sum(PacketsSent) by TimeGenerated = bin(TimeGenerated, 1m), SourceIP, DestinationIP | order by TimeGenerated asc ```\n2. If there are no records of this connection, it is likely an issue with establishing the connection because flow logs will only capture records of established connections. Take a look at [SNAT connection metrics](https://learn.microsoft.com/en-us/azure/nat-gateway/nat-metrics#snat-connection-count) to determine whether it may be a SNAT port exhaustion issue or NSGs/UDRs that may be blocking the traffic.\n3. If there are records of the connection, proceed with the next step.\n\n**Step 4: Check if there are any packets dropped**\n\nIn Log Analytics, query for the total \"PacketsSentDropped\" and \"PacketsReceivedDropped\" per source/outbound/destination IP connection.\n\n1. If \"PacketsSentDropped\" &gt; 0 - NAT gateway dropped traffic sent from your VM.\n2. If \"PacketsReceivedDropped\" &gt; 0, NAT gateway dropped traffic received from destination IP, github.com in this case.\n3. In both instances, it typically means the either the client or server is pushing more traffic through a single connection than is optimal, causing [connection-level rate limiting](https://learn.microsoft.com/en-us/azure/nat-gateway/nat-sku#sku-comparison).\n4. To mitigate:\n\n- - Avoid relying on one connection and instead use multiple connections.\n- Distribute traffic across multiple outbound IP addresses by assigning more public IP addresses to the NAT gateway resource.\n\n### Conclusion\n\nStandardV2 NAT Gateway Flow Logs unlock a powerful new dimension of outbound visibility and they can help you:\n\n- Validate cybersecurity readiness\n- Audit outbound flows\n- Diagnose intermittent connectivity issues\n- Understand traffic patterns and optimize architecture\n\nWe are excited to see how you leverage this new capability with your StandardV2 NAT gateways!\n\n### Have more questions?\n\nAs always, for any feedback, please feel free to reach us by [submitting your feedback](https://feedback.azure.com/d365community/forum/8ae9bf04-8326-ec11-b6e6-000d3a4f0789). We look forward to hearing your thoughts and hope this announcement helps you build more resilient applications in Azure.\n\nFor more information on StandardV2 NAT Gateway Flow Logs and how to enable it, visit:\n\n[Manage StandardV2 NAT Gateway Flow Logs - Azure NAT Gateway | Microsoft Learn](https://learn.microsoft.com/en-us/azure/nat-gateway/nat-gateway-flow-logs)\n\n[Monitor with StandardV2 NAT Gateway Flow Logs - Azure NAT Gateway | Microsoft Learn](https://learn.microsoft.com/en-us/azure/nat-gateway/monitor-nat-gateway-flow-logs)\n\nTo see the most up-to-date pricing for flow logs, visit [Azure NAT Gateway - Pricing | Microsoft Azure](https://azure.microsoft.com/en-us/pricing/details/azure-nat-gateway/?msockid=028aa4446a5a601f37ecb0076b7761c7).\n\nTo learn more about StandardV2 NAT Gateway, visit [What is Azure NAT Gateway? | Microsoft Learn](https://learn.microsoft.com/en-us/azure/nat-gateway/nat-overview#standardv2-nat-gateway).\n\nPublished Feb 06, 2026\n\nVersion 1.0\n\n[azure networking](/tag/azure%20networking?nodeId=board%3AAzureNetworkingBlog)\n\n[!\\[cozhang&#x27;s avatar\\](https://techcommunity.microsoft.com/t5/s/gxcuf89792/m_assets/avatars/default/avatar-5.svg?image-dimensions=50x50)](/users/cozhang/2733179) [cozhang](/users/cozhang/2733179) ![Icon for Microsoft rank](https://techcommunity.microsoft.com/t5/s/gxcuf89792/images/cmstNC05WEo0blc?image-dimensions=100x16&amp;constrain-image=true)Microsoft\n\nJoined October 24, 2024\n\n[View Profile](/users/cozhang/2733179)\n\n/category/azure/blog/azurenetworkingblog [Azure Networking Blog](/category/azure/blog/azurenetworkingblog) Follow this blog board to get notified when there's new activity",
  "Link": "https://techcommunity.microsoft.com/t5/azure-networking-blog/unlock-outbound-traffic-insights-with-azure-standardv2-nat/ba-p/4493138",
  "PubDate": "2026-02-06T16:07:33+00:00",
  "FeedLevelAuthor": "rss.livelink.threads-in-node",
  "OutputDir": "_community",
  "ProcessedDate": "2026-02-06 16:11:35",
  "FeedUrl": "https://techcommunity.microsoft.com/t5/s/gxcuf89792/rss/Category?category.id=Azure",
  "Title": "Unlock outbound traffic insights with Azure StandardV2 NAT Gateway flow logs",
  "FeedName": "Microsoft Tech Community",
  "Author": "cozhang",
  "Tags": [],
  "Description": "## Recommended Outbound Connectivity\n\n[StandardV2 NAT Gateway](https://learn.microsoft.com/en-us/azure/nat-gateway/nat-overview#standardv2-nat-gateway) is the next evolution of outbound connectivity in Azure. As the recommended solution for providing secure, reliable outbound Internet access, NAT Gateway continues to be the default choice for modern Azure deployments. With the highly anticipated general availability of the new StandardV2 SKU, customers gain access to the following highly requested upgrades:\n\n- Zone-redundancy: Automatically maintains outbound connectivity during single‑zone failures in AZ-enabled regions.\n- Enhanced performance: Up to 100 Gbps of throughput and 10 million packets per second - double the Standard SKU capacity.\n- Dual-stack support: Attach up to 16 IPv6 and 16 IPv4 public IP addresses for future ready connectivity.\n- Flow logs: Access historical logs of connections being established through your NAT gateway.\n\nThis blog will focus on how enabling StandardV2 NAT Gateway flow logs can be beneficial for your team along with some tips to get the most out of the data.\n\n## What are flow logs?\n\nStandardV2 NAT Gateway flow logs are enabled through Diagnostic settings on your NAT gateway resource where the log data can be sent to Log Analytics, a storage account, or Event hub destination. “NatGatewayFlowlogV1” is the released log category, and it provides IP level information on traffic flowing through your StandardV2 NAT gateway.\n\n![]()*Enable NAT* *Gateway Flow Logs through Diagnostics setting on your StandardV2 NAT gateway resource.*\n\n![]()*Schema output as seen on Log Analytics for a NAT gateway traffic flow.*\n\n### Why should I use flow logs?\n\nSecurity and compliance visibility\n\nPrior to NAT gateway flow logs, customers could not see NAT gateway information when their virtual machines connect outbound. This made it difficult to:\n\n- Validate that only approved destinations were being accessed\n- Audit suspicious or unexpected outbound patterns\n- Satisfy compliance requirements that mandate traffic recording\n\nFlow logs now provide visibility to the source IP -> NAT gateway outbound IP -> destination IP, along with details on sent/dropped packets and bytes.\n\nUsage analytics\n\nFlow logs allow you to answer usage questions such as:\n\n- Which VMs are generating the most outbound requests?\n- Which destinations receive the most traffic?\n- Is throughput growth caused by a specific workload pattern?\n\nThis level of insight is especially useful when debugging unexpected throughput increases, billing spikes, and connection bottlenecks.\n\n> >\n> *To note: Flow logs only capture established connections. This means the TCP 3* *‑* *way handshake (SYN → SYN/ACK → ACK) or the UDP ephemeral session setup must complete.* *If a connection never establishes, for example due to NSG denial, routing mismatch, or SNAT exhaustion, it will not appear in flow logs.*\n> >\n\n### Workflow of troubleshooting with flow logs\n\nLet's walk through how you can leverage flow logs to troubleshoot a scenario where you are seeing intermittent connection drops.\n\n**Scenario: You have VMs that use a StandardV2 NAT gateway to reach the Internet. However, your VMs intermittently fail to reach github.com.**\n\n**Step 1: Check NAT gateway health**\n\nStart with the datapath availability metric, which reflects the NAT gateway's overall health.\n\n- If metric > 90%, this confirms NAT gateway is healthy and is working as expected to send outbound traffic to the internet. Continue to Step 2.\n- If metric is lower, visit [Troubleshoot Azure NAT Gateway connectivity - Azure NAT Gateway | Microsoft Learn](https://learn.microsoft.com/en-us/azure/nat-gateway/troubleshoot-nat-connectivity#datapath-availability-drop-on-nat-gateway-with-connection-failures) for troubleshooting tips.\n\n**Step 2: Enable StandardV2 NAT Gateway Flow Logs**\n\nTo further investigate the root cause, Enable StandardV2 NAT Gateway Flow Logs (*NatGatewayFlowLogsV1* log category in Diagnostics Setting) for the NAT gateway resource providing outbound connectivity for the impacted VMs. It is recommended to enable Log Analytics as a destination as it allows you to easily query the data. For the detailed steps, visit [Monitor with StandardV2 NAT Gateway Flow Logs - Azure NAT Gateway | Microsoft Learn](https://learn.microsoft.com/en-us/azure/nat-gateway/monitor-nat-gateway-flow-logs).\n\n> >\n> *Tip: You may enable flow logs even when not troubleshooting to ensure you’ll have historical data to reference when issues occur.*\n> >\n\n**Step 3: Confirm whether the connection was established**\n\n1. Use Log Analytics to query for flows with source IP == VM private IP and destination IP == IP address(es) of github.com. The following query will generate a table and chart of the total packets sent per minute from your source IP to the destination IP through your NAT gateway in the last 24 hours.\n2. NatGatewayFlowlogsV1\n| where TimeGenerated > ago(1d) | where SourceIP == '10.0.0.4' //and DestinationIP == | summarize TotalPacketsSent = sum(PacketsSent) by TimeGenerated = bin(TimeGenerated, 1m), SourceIP, DestinationIP | order by TimeGenerated asc\n3. If there are no records of this connection, it is likely an issue with establishing the connection because flow logs will only capture records of established connections. Take a look at [SNAT connection metrics](https://learn.microsoft.com/en-us/azure/nat-gateway/nat-metrics#snat-connection-count) to determine whether it may be a SNAT port exhaustion issue or NSGs/UDRs that may be blocking the traffic.\n4. If there are records of the connection, proceed with the next step.\n\n**Step 4: Check if there are any packets dropped**\n\nIn Log Analytics, query for the total \"PacketsSentDropped\" and \"PacketsReceivedDropped\" per source/outbound/destination IP connection.\n\n1. If \"PacketsSentDropped\" > 0 - NAT gateway dropped traffic sent from your VM.\n2. If \"PacketsReceivedDropped\" > 0, NAT gateway dropped traffic received from destination IP, github.com in this case.\n3. In both instances, it typically means the either the client or server is pushing more traffic through a single connection than is optimal, causing [connection-level rate limiting](https://learn.microsoft.com/en-us/azure/nat-gateway/nat-sku#sku-comparison).\n4. To mitigate:\n\n- - Avoid relying on one connection and instead use multiple connections.\n- Distribute traffic across multiple outbound IP addresses by assigning more public IP addresses to the NAT gateway resource.\n\n### Conclusion\n\nStandardV2 NAT Gateway Flow Logs unlock a powerful new dimension of outbound visibility and they can help you:\n\n- Validate cybersecurity readiness\n- Audit outbound flows\n- Diagnose intermittent connectivity issues\n- Understand traffic patterns and optimize architecture\n\nWe are excited to see how you leverage this new capability with your StandardV2 NAT gateways!\n\n### Have more questions?\n\nAs always, for any feedback, please feel free to reach us by [submitting your feedback](https://feedback.azure.com/d365community/forum/8ae9bf04-8326-ec11-b6e6-000d3a4f0789). We look forward to hearing your thoughts and hope this announcement helps you build more resilient applications in Azure.\n\nFor more information on StandardV2 NAT Gateway Flow Logs and how to enable it, visit:\n\n[Manage StandardV2 NAT Gateway Flow Logs - Azure NAT Gateway | Microsoft Learn](https://learn.microsoft.com/en-us/azure/nat-gateway/nat-gateway-flow-logs)\n\n[Monitor with StandardV2 NAT Gateway Flow Logs - Azure NAT Gateway | Microsoft Learn](https://learn.microsoft.com/en-us/azure/nat-gateway/monitor-nat-gateway-flow-logs)\n\nTo see the most up-to-date pricing for flow logs, visit [Azure NAT Gateway - Pricing | Microsoft Azure](https://azure.microsoft.com/en-us/pricing/details/azure-nat-gateway/?msockid=028aa4446a5a601f37ecb0076b7761c7).\n\nTo learn more about StandardV2 NAT Gateway, visit [What is Azure NAT Gateway? | Microsoft Learn](https://learn.microsoft.com/en-us/azure/nat-gateway/nat-overview#standardv2-nat-gateway)."
}
