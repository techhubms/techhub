{
  "OutputDir": "_community",
  "Author": "sbalaji",
  "ProcessedDate": "2026-01-19 16:04:01",
  "EnhancedContent": "When managing Azure Kubernetes Service (AKS) clusters at scale, the ability to create multiple node pools in parallel can significantly reduce provisioning time. In this article, I'll share my journey troubleshooting and resolving node pool creation bottlenecks when using Crossplane to manage AKS infrastructure, culminating in a solution that enables true parallel creation of 30+ node pools.\n\n**TL;DR:** Upgrading to **Crossplane v2.1.3** (community edition) with **Azure Provider v2.2.0** resolved sequential node pool creation issues, enabling parallel provisioning with the correct field names and resource references.\n\n## **The Challenge**\n\nWhile using Crossplane to provision private AKS clusters with multiple node pools, I encountered a critical performance issue: **node pools were being created sequentially rather than in parallel**, significantly impacting deployment times. With requirements to create 30-50 node pools per cluster, this sequential behavior was unacceptable for production scenarios.\n\n### Initial Environment:\n\n- **Crossplane**: v1.13.1 (**[https://marketplace.upbound.io/providers/upbound/provider-family-azure/v1.13.1](https://nam06.safelinks.protection.outlook.com/?url=https%3A%2F%2Fmarketplace.upbound.io%2Fproviders%2Fupbound%2Fprovider-family-azure%2Fv1.13.1&amp;data=05%7C02%7Ckmohansingh%40microsoft.com%7C555af824dac94e9c72c008de1ab91305%7C72f988bf86f141af91ab2d7cd011db47%7C1%7C0%7C638977579425806520%7CUnknown%7CTWFpbGZsb3d8eyJFbXB0eU1hcGkiOnRydWUsIlYiOiIwLjAuMDAwMCIsIlAiOiJXaW4zMiIsIkFOIjoiTWFpbCIsIldUIjoyfQ%3D%3D%7C0%7C%7C%7C&amp;sdata=GeHh7nSn8wEz9ZgQOU6XlfGLGVGoiBveoyjgcNUJBhg%3D&amp;reserved=0)**)\n- **Azure Provider**: v1.13.1 (provider-azure-containerservice)\n- **AKS API**: containerservice.azure.upbound.io/v1beta1\n- **Management Cluster**: Private AKS cluster with Azure CNI Overlay\n- **Authentication**: Azure Managed Identity with Contributor role\n\n## **Investigation & Key Discoveries**\n\n### The Initial Problem:\n\nWhile designing scalable Azure Kubernetes Service (AKS) platforms, customers often leverage **multiple node pools** to isolate workloads, optimize costs, and enforce workload-specific configurations. However, during one such implementation, a customer encountered a **critical performance bottleneck** that made cluster provisioning impractical for production use. The customer attempted to provision AKS clusters with **30–50 node pools** as part of their landing zone automation. While the configuration itself was valid, the **overall cluster creation time stretched into multiple hours**, making it unsuitable for real-world production scenarios.\n\nObserved Symptoms\n\n- AKS cluster creation took **hours** to complete.\n- Node pools were provisioned **sequentially**, not in parallel.\n- Each node pool took approximately **2 minutes** to provision.\n- A cluster with **33 node pools required more than 1 hour** *only* for node pool creation.\n- This time did **not include base AKS control plane provisioning**.\n\nAs a result, the total deployment time exceeded acceptable operational limits.\n\nAt first glance, the customer’s node pool creation logic appeared to be correct. Each node pool was defined independently and was capable of creating all its nodes in parallel **within the node pool itself**.\n\nHere’s a simplified version of the Helm template used for node pool creation:\n\n### Customer's Approach & Our Alternatives:\n\nThe customer was initially using **direct managed resources** (KubernetesCluster and KubernetesClusterNodePool CRDs) to create Azure AKS infrastructure through Crossplane. While this approach worked, it exhibited the sequential creation behavior that was causing the performance issues.\n\nTo address this, we explored an alternative approach using **Crossplane Compositions** - a higher-level abstraction that allows you to define reusable infrastructure templates. We created composite resource definitions (XRDs) that could orchestrate cluster and node pool creation. However, during our investigation, we discovered that the root cause wasn't the abstraction level (managed resources vs. compositions).\n\n### Rate Limiting Investigation:\n\nInitially, we suspected Azure API rate limiting might be the culprit behind the sequential behavior. To validate this hypothesis, we attempted to create the same AKS infrastructure using alternative Infrastructure as Code (IaC) tools: **Terraform, Azure Resource Manager (ARM) templates & PowerShell (CLI)**\n\nThe results were revealing that Terraform, ARM templates and PowerShell (CLI) are successfully creating node pools in parallel without issues. This was a critical discovery that confirmed it was NOT an Azure API rate limit problem.****\n\n### Open Issues:\n\nDuring our investigation, we searched the official Crossplane GitHub repository ([https://github.com/crossplane/crossplane](https://github.com/crossplane/crossplane)) for any reported issues related to sequential node pool creation bottlenecks. No open or closed issues were found that documented this specific problem. This suggests the issue was specific to the combination of older provider versions and our use case, rather than a widely reported or known limitation.\n\n### Discovery: Version Compatibility Matters\n\nAfter an extensive testing with various Crossplane and provider versions, the breakthrough came with:\n\n``` Crossplane: v2.1.3 (community edition) Azure Provider Family: v2.2.0\n- upbound/provider-family-azure\n- upbound/provider-azure-containerservice\n```\n\n## **Conclusion**:\n\nThe journey from sequential to parallel node pool creation highlights the importance of staying current with Crossplane and provider versions. What initially appeared to be an Azure API rate limiting issue turned out to be a version compatibility challenge. The combination of Crossplane v2.1.3 and Azure Provider v2.2.0 delivers parallel resource creation capabilities, improving AKS cluster provisioning times at scale.\n\n#### Key takeaways:\n\n1. Version compatibility is critical for optimal Crossplane performance\n2. Performance issues aren't always what they seem - thorough investigation revealed it wasn't Azure rate limiting\n3. Both managed resources and compositions can work, but provider version was the key factor\n4. Proper resource references enable parallel submissions\n5. CRD inspection provides authoritative field definitions\n6. Testing with alternative IaC tools (Terraform, ARM) can help validate hypotheses\n\nUpdated Jan 19, 2026\n\nVersion 1.0\n\n[!\\[sbalaji&#x27;s avatar\\](https://techcommunity.microsoft.com/t5/s/gxcuf89792/m_assets/avatars/default/avatar-2.svg?image-dimensions=50x50)](/users/sbalaji/2889375) [sbalaji](/users/sbalaji/2889375) ![Icon for Microsoft rank](https://techcommunity.microsoft.com/t5/s/gxcuf89792/images/cmstNC05WEo0blc?image-dimensions=100x16&amp;constrain-image=true)Microsoft\n\nJoined January 31, 2025\n\n[View Profile](/users/sbalaji/2889375)\n\n/category/azure/blog/azureinfrastructureblog [Azure Infrastructure Blog](/category/azure/blog/azureinfrastructureblog) Follow this blog board to get notified when there's new activity",
  "FeedLevelAuthor": "rss.livelink.threads-in-node",
  "Link": "https://techcommunity.microsoft.com/t5/azure-infrastructure-blog/parallel-aks-node-pool-creation-with-crossplane-a-version/ba-p/4477936",
  "FeedName": "Microsoft Tech Community",
  "Tags": [],
  "PubDate": "2026-01-19T15:43:48+00:00",
  "Title": "Parallel AKS Node Pool Creation with Crossplane: A Version Compatibility Journey",
  "Description": "When managing Azure Kubernetes Service (AKS) clusters at scale, the ability to create multiple node pools in parallel can significantly reduce provisioning time. In this article, I'll share my journey troubleshooting and resolving node pool creation bottlenecks when using Crossplane to manage AKS infrastructure, culminating in a solution that enables true parallel creation of 30+ node pools.\n\n**TL;DR:** Upgrading to **Crossplane v2.1.3** (community edition) with **Azure Provider v2.2.0** resolved sequential node pool creation issues, enabling parallel provisioning with the correct field names and resource references.\n\n## **The Challenge**\n\nWhile using Crossplane to provision private AKS clusters with multiple node pools, I encountered a critical performance issue: **node pools were being created sequentially rather than in parallel**, significantly impacting deployment times. With requirements to create 30-50 node pools per cluster, this sequential behavior was unacceptable for production scenarios.\n\n### Initial Environment:\n\n- **Crossplane**: v1.13.1 (**[https://marketplace.upbound.io/providers/upbound/provider-family-azure/v1.13.1](https://nam06.safelinks.protection.outlook.com/?url=https%3A%2F%2Fmarketplace.upbound.io%2Fproviders%2Fupbound%2Fprovider-family-azure%2Fv1.13.1&data=05%7C02%7Ckmohansingh%40microsoft.com%7C555af824dac94e9c72c008de1ab91305%7C72f988bf86f141af91ab2d7cd011db47%7C1%7C0%7C638977579425806520%7CUnknown%7CTWFpbGZsb3d8eyJFbXB0eU1hcGkiOnRydWUsIlYiOiIwLjAuMDAwMCIsIlAiOiJXaW4zMiIsIkFOIjoiTWFpbCIsIldUIjoyfQ%3D%3D%7C0%7C%7C%7C&sdata=GeHh7nSn8wEz9ZgQOU6XlfGLGVGoiBveoyjgcNUJBhg%3D&reserved=0)**)\n- **Azure Provider**: v1.13.1 (provider-azure-containerservice)\n- **AKS API**: containerservice.azure.upbound.io/v1beta1\n- **Management Cluster**: Private AKS cluster with Azure CNI Overlay\n- **Authentication**: Azure Managed Identity with Contributor role\n\n## **Investigation & Key Discoveries**\n\n### The Initial Problem:\n\nWhile designing scalable Azure Kubernetes Service (AKS) platforms, customers often leverage **multiple node pools** to isolate workloads, optimize costs, and enforce workload-specific configurations. However, during one such implementation, a customer encountered a **critical performance bottleneck** that made cluster provisioning impractical for production use. The customer attempted to provision AKS clusters with **30–50 node pools** as part of their landing zone automation. While the configuration itself was valid, the **overall cluster creation time stretched into multiple hours**, making it unsuitable for real-world production scenarios.\n\nObserved Symptoms\n\n- AKS cluster creation took **hours** to complete.\n- Node pools were provisioned **sequentially**, not in parallel.\n- Each node pool took approximately **2 minutes** to provision.\n- A cluster with **33 node pools required more than 1 hour** *only* for node pool creation.\n- This time did **not include base AKS control plane provisioning**.\n\nAs a result, the total deployment time exceeded acceptable operational limits.\n\nAt first glance, the customer’s node pool creation logic appeared to be correct. Each node pool was defined independently and was capable of creating all its nodes in parallel **within the node pool itself**.\n\nHere’s a simplified version of the Helm template used for node pool creation:\n\n![]()\n\n### Customer's Approach & Our Alternatives:\n\nThe customer was initially using **direct managed resources** (KubernetesCluster and KubernetesClusterNodePool CRDs) to create Azure AKS infrastructure through Crossplane. While this approach worked, it exhibited the sequential creation behavior that was causing the performance issues.\n\nTo address this, we explored an alternative approach using **Crossplane Compositions** - a higher-level abstraction that allows you to define reusable infrastructure templates. We created composite resource definitions (XRDs) that could orchestrate cluster and node pool creation. However, during our investigation, we discovered that the root cause wasn't the abstraction level (managed resources vs. compositions).\n\n### Rate Limiting Investigation:\n\nInitially, we suspected Azure API rate limiting might be the culprit behind the sequential behavior. To validate this hypothesis, we attempted to create the same AKS infrastructure using alternative Infrastructure as Code (IaC) tools: **Terraform, Azure Resource Manager (ARM) templates & PowerShell (CLI)**\n\nThe results were revealing that Terraform, ARM templates and PowerShell (CLI) are successfully creating node pools in parallel without issues. This was a critical discovery that confirmed it was NOT an Azure API rate limit problem. ****\n\n### Open Issues:\n\nDuring our investigation, we searched the official Crossplane GitHub repository ([https://github.com/crossplane/crossplane](https://github.com/crossplane/crossplane)) for any reported issues related to sequential node pool creation bottlenecks. No open or closed issues were found that documented this specific problem. This suggests the issue was specific to the combination of older provider versions and our use case, rather than a widely reported or known limitation.\n\n### Discovery: Version Compatibility Matters\n\nAfter an extensive testing with various Crossplane and provider versions, the breakthrough came with:\n\n- Crossplane: v2.1.3 (community edition)\nAzure Provider Family: v2.2.0\n- upbound/provider-family-azure\n- upbound/provider-azure-containerservice\n\n## **Conclusion**:\n\nThe journey from sequential to parallel node pool creation highlights the importance of staying current with Crossplane and provider versions. What initially appeared to be an Azure API rate limiting issue turned out to be a version compatibility challenge. The combination of Crossplane v2.1.3 and Azure Provider v2.2.0 delivers parallel resource creation capabilities, improving AKS cluster provisioning times at scale.\n\n#### Key takeaways:\n\n1. Version compatibility is critical for optimal Crossplane performance\n2. Performance issues aren't always what they seem - thorough investigation revealed it wasn't Azure rate limiting\n3. Both managed resources and compositions can work, but provider version was the key factor\n4. Proper resource references enable parallel submissions\n5. CRD inspection provides authoritative field definitions\n6. Testing with alternative IaC tools (Terraform, ARM) can help validate hypotheses",
  "FeedUrl": "https://techcommunity.microsoft.com/t5/s/gxcuf89792/rss/Category?category.id=Azure"
}
