{
  "FeedUrl": "https://techcommunity.microsoft.com/t5/s/gxcuf89792/rss/Category?category.id=Azure",
  "EnhancedContent": "## What is the problem?\n\nA common enterprise automation scenario involves copying files from a **OneDrive folder shared by a colleague** into another storage service such as **SharePoint** or **Azure Blob Storage** using **Azure Logic Apps**.\n\nHowever, when you configure the [**OneDrive for Business ‚Äì ‚ÄúList files in folder‚Äù**](https://learn.microsoft.com/en-us/connectors/onedriveforbusiness/#list-files-in-folder) action in a Logic App, you quickly run into a limitation:\n\n- The folder picker only shows:\n- Root directory\n- Subfolders of the **authenticated user‚Äôs OneDrive**\n- **Shared folders do not appear at all**, even though you can access them in the OneDrive UI\n\nThis makes it seem like Logic Apps cannot work with shared OneDrive folders‚Äîbut that‚Äôs not entirely true.\n\nLogic app's \"List files in folder\" action from OneDrive for business connector showing list of folders while when clicked on the file picker icon\n\n## Why this happens\n\nThe OneDrive for Business connector is **user‚Äëcontext scoped**. It only enumerates folders that belong to the signed-in user‚Äôs drive and does not automatically surface folders that are **shared with the user**.\n\nEven though shared folders are visible under *‚ÄúShared with me‚Äù* in the OneDrive UI, they:\n\n- Live in a **different drive**\n- Have a **different driveId**\n- Require explicit identification before Logic Apps can access them\n\n## How to access a shared OneDrive folder\n\nThere are **two supported ways** to access a shared OneDrive directory from Logic Apps.\n\n### Option 1: Use Microsoft Graph APIs (Delegated permissions)\n\nYou can invoke Microsoft Graph APIs directly using:\n\n- [**HTTP with Microsoft Entra ID (preauthorized)**](https://learn.microsoft.com/en-us/connectors/webcontents/#invoke-an-http-request)\n- Delegated permissions on behalf of the signed‚Äëin user\n\nThis requires:\n\n- Admin consent or delegated consent workflows\n- Additional Entra ID configuration\n\nüìò Reference: [HTTP with Microsoft Entra ID (preauthorized) - Connectors | Microsoft Learn](https://learn.microsoft.com/en-us/connectors/webcontents/#authorize-the-connector-to-act-on-behalf-of-a-signed-in-user)\n\nWhile powerful, this approach adds setup complexity.\n\n### Option 2: Use Graph Explorer to configure the OneDrive connector\n\nInstead of calling Graph from Logic Apps directly, you can:\n\n1. Use **Graph Explorer** to discover the shared folder metadata\n2. Manually configure the OneDrive action using that metadata\n\n## Step-by-step: Using Graph Explorer to access a shared folder\n\n### Scenario\n\nA colleague has shared a OneDrive folder named **‚ÄúTest‚Äù** with me, and I need to process files inside it using a Logic App.\n\n### Step 1: List shared folders using Microsoft Graph\n\nIn [**Graph Explorer**](https://developer.microsoft.com/en-us/graph/graph-explorer), run the following request:\n\nGET https://graph.microsoft.com/v1.0/{*OneDrive shared folder owner username}*/drive/root/children\n\nüìòReference: [List the contents of a folder - Microsoft Graph v1.0 | Microsoft Learn](https://learn.microsoft.com/en-us/graph/api/driveitem-list-children?view=graph-rest-1.0&amp;tabs=http)\n\n‚úÖThis returns all root-level folders visible to the signed-in user, including folders **shared with you**.\n\nFrom the response, locate the shared folder. You only need **two values**:\n\n- parentReference.driveId\n- id (folder ID)\n\nGraph explorer snippet showing the request sent to the API to list the files & folders shared by a specific user on the root drive\n\n### Step 2: Configure Logic App ‚ÄúList files in folder‚Äù action\n\nIn your Logic App:\n\n1. Add **OneDrive for Business ‚Üí List files in folder**\n2. **Do not use the folder picker**\n3. Manually enter the folder value using this format: ***{driveId}******.******{folderId}***\n\nOnce saved, the action successfully lists files from the¬†**shared OneDrive folder**.\n\n### Step 3: Build the rest of your workflow\n\nAfter the folder is resolved correctly:\n\n- You can loop through files\n- Copy them to SharePoint\n- Upload them to Azure Blob Storage\n- Apply filters, conditions, or transformations\n\nAll standard OneDrive actions now work as expected.\n\n## Troubleshooting: When Graph Explorer doesn‚Äôt help\n\nIf you‚Äôre unable to find the driveId or folderId via Graph Explorer, there‚Äôs a reliable fallback.\n\n### Use browser network tracing\n\n1. Open the shared folder in OneDrive (web)\n2. Open **Browser Developer Tools ‚Üí Network**\n3. Look for requests like:Browser network trace snippet on how to fetch the required driveID & folderId\n4. In the response payload, extract:\n- CurrentFolderUniqueId ‚Üí folder ID\n- drives/{driveId} from the CurrentFolderSpItemUrl\n\nThis method is very effective when Graph results are incomplete or filtered.\n\nUpdated Feb 18, 2026\n\nVersion 1.0\n\n[azure](/tag/azure?nodeId=board%3AIntegrationsonAzureBlog)\n\n[connectors](/tag/connectors?nodeId=board%3AIntegrationsonAzureBlog)\n\n[integration](/tag/integration?nodeId=board%3AIntegrationsonAzureBlog)\n\n[logic apps](/tag/logic%20apps?nodeId=board%3AIntegrationsonAzureBlog)\n\n[logic apps standard](/tag/logic%20apps%20standard?nodeId=board%3AIntegrationsonAzureBlog)\n\n[!\\[Arpit_MSFT&#x27;s avatar\\](https://techcommunity.microsoft.com/t5/s/gxcuf89792/m_assets/avatars/default/avatar-1.svg?image-dimensions=50x50)](/users/arpit_msft/1626807) [Arpit_MSFT](/users/arpit_msft/1626807) ![Icon for Microsoft rank](https://techcommunity.microsoft.com/t5/s/gxcuf89792/images/cmstNC05WEo0blc?image-dimensions=100x16&amp;constrain-image=true)Microsoft\n\nJoined November 24, 2022\n\n[View Profile](/users/arpit_msft/1626807)\n\n/category/azure/blog/integrationsonazureblog [Azure Integration Services Blog](/category/azure/blog/integrationsonazureblog) Follow this blog board to get notified when there's new activity",
  "Title": "How to Access a Shared OneDrive Folder in Azure Logic Apps",
  "OutputDir": "_community",
  "Description": "## What is the problem?\n\nA common enterprise automation scenario involves copying files from a **OneDrive folder shared by a colleague** into another storage service such as **SharePoint** or **Azure Blob Storage** using **Azure Logic Apps**.\n\nHowever, when you configure the [**OneDrive for Business ‚Äì ‚ÄúList files in folder‚Äù**](https://learn.microsoft.com/en-us/connectors/onedriveforbusiness/#list-files-in-folder) action in a Logic App, you quickly run into a limitation:\n\n- The folder picker only shows:\n- Root directory\n- Subfolders of the **authenticated user‚Äôs OneDrive**\n- **Shared folders do not appear at all**, even though you can access them in the OneDrive UI\n\nThis makes it seem like Logic Apps cannot work with shared OneDrive folders‚Äîbut that‚Äôs not entirely true.\n\n![]()Logic app's \"List files in folder\" action from OneDrive for business connector showing list of folders while when clicked on the file picker icon\n\n## Why this happens\n\nThe OneDrive for Business connector is **user‚Äëcontext scoped**. It only enumerates folders that belong to the signed-in user‚Äôs drive and does not automatically surface folders that are **shared with the user**.\n\nEven though shared folders are visible under *‚ÄúShared with me‚Äù* in the OneDrive UI, they:\n\n- Live in a **different drive**\n- Have a **different driveId**\n- Require explicit identification before Logic Apps can access them\n\n## How to access a shared OneDrive folder\n\nThere are **two supported ways** to access a shared OneDrive directory from Logic Apps.\n\n### Option 1: Use Microsoft Graph APIs (Delegated permissions)\n\nYou can invoke Microsoft Graph APIs directly using:\n\n- [**HTTP with Microsoft Entra ID (preauthorized)**](https://learn.microsoft.com/en-us/connectors/webcontents/#invoke-an-http-request)\n- Delegated permissions on behalf of the signed‚Äëin user\n\nThis requires:\n\n- Admin consent or delegated consent workflows\n- Additional Entra ID configuration\n\nüìò Reference: [HTTP with Microsoft Entra ID (preauthorized) - Connectors | Microsoft Learn](https://learn.microsoft.com/en-us/connectors/webcontents/#authorize-the-connector-to-act-on-behalf-of-a-signed-in-user)\n\nWhile powerful, this approach adds setup complexity.\n\n### Option 2: Use Graph Explorer to configure the OneDrive connector\n\nInstead of calling Graph from Logic Apps directly, you can:\n\n1. Use **Graph Explorer** to discover the shared folder metadata\n2. Manually configure the OneDrive action using that metadata\n\n## Step-by-step: Using Graph Explorer to access a shared folder\n\n### Scenario\n\nA colleague has shared a OneDrive folder named **‚ÄúTest‚Äù** with me, and I need to process files inside it using a Logic App.\n\n### Step 1: List shared folders using Microsoft Graph\n\nIn [**Graph Explorer**](https://developer.microsoft.com/en-us/graph/graph-explorer), run the following request:\n\nGET https://graph.microsoft.com/v1.0/{*OneDrive shared folder owner username}*/drive/root/children\n\nüìòReference: [List the contents of a folder - Microsoft Graph v1.0 | Microsoft Learn](https://learn.microsoft.com/en-us/graph/api/driveitem-list-children?view=graph-rest-1.0&tabs=http)\n\n‚úÖThis returns all root-level folders visible to the signed-in user, including folders **shared with you**.\n\nFrom the response, locate the shared folder. You only need **two values**:\n\n- parentReference.driveId\n- id (folder ID)\n\n![]()\n\nGraph explorer snippet showing the request sent to the API to list the files & folders shared by a specific user on the root drive\n\n### Step 2: Configure Logic App ‚ÄúList files in folder‚Äù action\n\nIn your Logic App:\n\n1. Add **OneDrive for Business ‚Üí List files in folder**\n2. **Do not use the folder picker**\n3. Manually enter the folder value using this format: ***{driveId}******.******{folderId}***\n\n![]()\n\nOnce saved, the action successfully lists files from the **shared OneDrive folder**.\n\n### Step 3: Build the rest of your workflow\n\nAfter the folder is resolved correctly:\n\n- You can loop through files\n- Copy them to SharePoint\n- Upload them to Azure Blob Storage\n- Apply filters, conditions, or transformations\n\nAll standard OneDrive actions now work as expected.\n\n## Troubleshooting: When Graph Explorer doesn‚Äôt help\n\nIf you‚Äôre unable to find the driveId or folderId via Graph Explorer, there‚Äôs a reliable fallback.\n\n### Use browser network tracing\n\n1. Open the shared folder in OneDrive (web)\n2. Open **Browser Developer Tools ‚Üí Network**\n3. Look for requests like:![]()Browser network trace snippet on how to fetch the required driveID & folderId\n4. In the response payload, extract:\n- CurrentFolderUniqueId ‚Üí folder ID\n- drives/{driveId} from the CurrentFolderSpItemUrl\n\nThis method is very effective when Graph results are incomplete or filtered.",
  "Tags": [],
  "ProcessedDate": "2026-02-26 04:34:06",
  "FeedLevelAuthor": "rss.livelink.threads-in-node",
  "PubDate": "2026-02-26T04:31:43+00:00",
  "FeedName": "Microsoft Tech Community",
  "Link": "https://techcommunity.microsoft.com/t5/azure-integration-services-blog/how-to-access-a-shared-onedrive-folder-in-azure-logic-apps/ba-p/4484962",
  "Author": "Arpit_MSFT"
}
