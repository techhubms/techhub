{
  "PubDate": "2026-02-20T09:37:43+00:00",
  "Link": "https://techcommunity.microsoft.com/t5/apps-on-azure-blog/seamless-migrations-from-self-hosted-nginx-ingress-to-the-aks/ba-p/4495630",
  "FeedUrl": "https://techcommunity.microsoft.com/t5/s/gxcuf89792/rss/Category?category.id=Azure",
  "Title": "Seamless Migrations From Self Hosted Nginx Ingress To The AKS App Routing Add-On",
  "FeedName": "Microsoft Tech Community",
  "OutputDir": "_community",
  "ProcessedDate": "2026-02-20 10:09:54",
  "Description": "The Kubernetes Steering Committee has [announced](https://kubernetes.io/blog/2026/01/29/ingress-nginx-statement/) that the Nginx Ingress controller will be retired in March 2026. That' not far away, and once this happens Nginx Ingress will not receive any further updates, including security patches. Continuing to run the standalone Nginx Ingress controller past the end of March could open you up to security risks.\n\nAzure Kubernetes Service (AKS) offers a managed routing add-on which also implements Nginx as the Ingress Controller. Microsoft has recently [committed to supporting](https://blog.aks.azure.com/2025/11/13/ingress-nginx-update) this version of Nginx Ingress until November 2026. There is also an updated version of the App Routing add-on in the works, that will be based on Istio to allow for transition off Nginx Ingress. This new App Routing add-on will support Gateway API based ingress only, so there will be some migration required if you are using the Ingress API. There is tooling availible to support migration from Ingress to Gateway API, such as the [Ingress2Gateway tool](https://github.com/kubernetes-sigs/ingress2gateway).\n\nIf you are already using the App Routing add-on then you are supported until November and have extra time to either move to the new Istio based solution when it is released or migrate to another solution such as App Gateway for Containers. However, if you are running the standalone version of Nginx Ingress, you may want to consider migrating to the App Routing add-on to give you some extra time.\n\nTo be very clear, migrating to the App Routing add-on does not solve the problem; it buys you some more time until November and sets you up for a transition to the future Istio based App Routing add-on. Once you complete this migration you will need to plan to either move to the new version based on Istio, or migrate to another Ingress solution, before November.\n\nThis rest of this article walks through migrating from BYO Nginx to the App Routing add-on without disrupting your existing traffic.\n\n## How Parallel Running Works\n\nThe key to a zero-downtime migration is that both controllers can run simultaneously. Each controller uses a different IngressClass, so Kubernetes routes traffic based on which class your Ingress resources reference.\n\nYour BYO Nginx uses the nginx IngressClass and runs in the ingress-nginx namespace. The App Routing add-on uses the webapprouting.kubernetes.azure.com IngressClass and runs in the app-routing-system namespace. They operate completely independently, each with its own load balancer IP.\n\nThis means you can:\n\n1. Enable the add-on alongside your existing controller\n2. Create new Ingress resources targeting the add-on (or duplicate existing ones)\n3. Validate everything works via the add-on's IP\n4. Cut over DNS or backend pool configuration\n5. Remove the old Ingress resources once you're satisfied\n\nAt no point does your production traffic go offline.\n\n## Enabling the App Routing add-on\n\nStart by enabling the add-on on your existing cluster. This doesn't touch your BYO Nginx installation.\n\nbash\n\n- az aks approuting enable \\\n--resource-group \\ --name\n\nWait for the add-on to deploy. You can verify it's running by checking the app-routing-system namespace:\n- kubectl get pods -n app-routing-system\nkubectl get svc -n app-routing-system\n\nYou should see the Nginx controller pod running and a service called nginx with a load balancer IP. This IP is separate from your BYO controller's IP.\n\nbash\n- # Get both IPs for comparison\nBYO\\_IP=$(kubectl get svc ingress-nginx-controller -n ingress-nginx \\ -o jsonpath='{.status.loadBalancer.ingress[0].ip}') add-on\\_IP=$(kubectl get svc nginx -n app-routing-system \\ -o jsonpath='{.status.loadBalancer.ingress[0].ip}') echo \"BYO Nginx IP: $BYO\\_IP\" echo \"add-on IP: $add-on\\_IP\"\n\nBoth controllers are now running. Your existing applications continue to use the BYO controller because their Ingress resources still reference ingressClassName: nginx.\n\n## Migrating Applications: The Parallel Ingress Approach\n\nFor production workloads, create a second Ingress resource that targets the add-on. This lets you validate everything before cutting over traffic.\n\nHere's an example. Your existing Ingress might look like this:\n- apiVersion: networking.k8s.io/v1\nkind: Ingress metadata: name: myapp-ingress-byo namespace: myapp annotations: nginx.ingress.kubernetes.io/rewrite-target: / spec: ingressClassName: nginx # BYO controller rules:\n- host: myapp.example.com\nhttp: paths:\n- path: /\npathType: Prefix backend: service: name: myapp port: number: 80\n\nCreate a new Ingress for the add-on:\n- apiVersion: networking.k8s.io/v1\nkind: Ingress metadata: name: myapp-ingress-add-on namespace: myapp annotations: nginx.ingress.kubernetes.io/rewrite-target: / spec: ingressClassName: webapprouting.kubernetes.azure.com # add-on controller rules:\n- host: myapp.example.com\nhttp: paths:\n- path: /\npathType: Prefix backend: service: name: myapp port: number: 80\n\nApply this new Ingress resource. The add-on controller picks it up and configures routing, but your production traffic still flows through the BYO controller because DNS (or your backend pool) still points to the old IP.\n\n### Validating Before Cutover\n\nTest the new route via the add-on IP before touching anything else:\n- # For public ingress with DNS\ncurl -H \"Host: myapp.example.com\" http://$add-on\\_IP\n# For private ingress, test from a VM in the VNet\ncurl -H \"Host: myapp.example.com\" http://$add-on\\_IP\n\nRun your full validation suite against this IP. Check TLS certificates, path routing, authentication, rate limiting, custom headers, and anything else your application depends on. If you have monitoring or synthetic tests, point them at the add-on IP temporarily to gather confidence.\n\nIf something doesn't work, you can troubleshoot without affecting production. The BYO controller is still handling all real traffic.\n\n## Cutover To Routing Add-on\n\nIf your ingress has a public IP and you're using DNS to route traffic, the cutover is straightforward.\n\n- Lower your DNS TTL well in advance. Set it to 60 seconds at least an hour before you plan to cut over. This ensures changes propagate quickly and you can roll back fast if needed.\n- When you're ready, update your DNS A record to point to the add-on IP\n\nIf your ingress has a private IP and sits behind App Gateway, API Management, or Front Door, the cutover involves updating the backend pool instead of DNS.\n\n## In-Place Patching: The Faster But Riskier Option\n\nIf you're migrating a non-critical application or an internal service where some downtime is acceptable, you can patch the ingressClassName in place:\n- kubectl patch ingress myapp-ingress-byo -n myapp \\\n--type='json' \\ -p='[{\"op\":\"replace\",\"path\":\"/spec/ingressClassName\",\"value\":\"webapprouting.kubernetes.azure.com\"}]'\n\nThis is atomic from Kubernetes' perspective. The BYO controller immediately drops the route, and the add-on controller immediately picks it up. In practice, there's usually a few seconds gap while the add-on configures Nginx and reloads. Once this change is made, the Ingress will not work until you update your DNS or backend pool details to point to the new IP.\n\n## Decommissioning the BYO Nginx Controller\n\nOnce all your applications are migrated and you're confident everything works, you can remove the BYO controller.\n\nFirst, verify nothing is still using it:\n- kubectl get ingress --all-namespaces \\\n-o custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name,CLASS:.spec.ingressClassName' \\ | grep -v \"webapprouting\"\n\nIf that returns only the header row (or is empty), you're clear to proceed. If it shows any Ingress resources, you've still got work to do.\n\nRemove the BYO Nginx Helm release:\n- helm uninstall ingress-nginx -n ingress-nginx kubectl delete namespace ingress-nginx\n\nThe Azure Load Balancer provisioned for the BYO controller will be deprovisioned automatically.\n\nVerify only the add-on IngressClass remains:\n- kubectl get ingressclass\n\nYou should see only webapprouting.kubernetes.azure.com.\n\n## Key Differences Between BYO Nginx and the App Routing add-on\n\nThe add-on runs the same Nginx binary, so most of your configuration carries over. However, there are a few differences worth noting.\n\n**TLS Certificates**: The BYO setup typically uses cert-manager or manual Secrets for certificates. The add-on supports this, but it also integrates natively with Azure Key Vault. If you want to use Key Vault, you need to configure the add-on with the appropriate annotations. Otherwise, your existing cert-manager setup continues to work.\n\n**DNS Management**: If you're using external-dns with your BYO controller, it works with the add-on too. The add-on also has native integration with Azure DNS zones if you want to simplify your setup. This is optional.\n\n**Custom Nginx Configuration**: With BYO Nginx, you have full access to the ConfigMap and can customise the global Nginx configuration extensively. The add-on restricts this because it's managed by Azure. If you've done significant customisation (Lua scripts, custom modules, etc.), audit carefully to ensure the add-on supports what you need. Most standard configurations work fine.\n\n**Annotations**: The nginx.ingress.kubernetes.io/\\* annotations work the same way. The add-on adds some Azure-specific annotations for WAF integration and other features, but your existing annotations should carry over without changes.\n\n## What Comes Next\n\nThis migration gets you onto a supported platform, but it's temporary. November 2026 is not far away, and you'll need to plan your next move.\n\nMicrosoft is building a new App Routing add-on based on Istio. This is expected later in 2026 and will likely become the long-term supported option. Keep an eye on Azure updates for announcements about preview availability and migration paths.\n\nIf you need something production-ready sooner, App Gateway for Containers is worth evaluating. It's built on Envoy and supports the Kubernetes Gateway API, which is the future direction for ingress in Kubernetes. The Gateway API is more expressive than the Ingress API and is designed to be vendor-neutral.\n\nFor now, getting off the unsupported BYO Nginx controller is the priority. The App Routing add-on gives you the breathing room to make an informed decision about your long-term strategy rather than rushing into something because you're running out of time.",
  "EnhancedContent": "The Kubernetes Steering Committee has [announced](https://kubernetes.io/blog/2026/01/29/ingress-nginx-statement/) that the Nginx Ingress controller will be retired in March 2026. That' not far away, and once this happens Nginx Ingress will not receive any further updates, including security patches. Continuing to run the standalone Nginx Ingress controller past the end of March could open you up to security risks.\n\nAzure Kubernetes Service (AKS) offers a managed routing add-on which also implements Nginx as the Ingress Controller. Microsoft has recently [committed to supporting](https://blog.aks.azure.com/2025/11/13/ingress-nginx-update) this version of Nginx Ingress until November 2026. There is also an updated version of the App Routing add-on in the works, that will be based on Istio to allow for transition off Nginx Ingress. This new App Routing add-on will support Gateway API based ingress only, so there will be some migration required if you are using the Ingress API. There is tooling availible to support migration from Ingress to Gateway API, such as the [Ingress2Gateway tool](https://github.com/kubernetes-sigs/ingress2gateway).\n\nIf you are already using the App Routing add-on then you are supported until November and have extra time to either move to the new Istio based solution when it is released or migrate to another solution such as App Gateway for Containers. However, if you are running the standalone version of Nginx Ingress, you may want to consider migrating to the App Routing add-on to give you some extra time.\n\nTo be very clear, migrating to the App Routing add-on does not solve the problem; it buys you some more time until November and sets you up for a transition to the future Istio based App Routing add-on. Once you complete this migration you will need to plan to either move to the new version based on Istio, or migrate to another Ingress solution, before November.\n\nThis rest of this article walks through migrating from BYO Nginx to the App Routing add-on without disrupting your existing traffic.\n\n## How Parallel Running Works\n\nThe key to a zero-downtime migration is that both controllers can run simultaneously. Each controller uses a different IngressClass, so Kubernetes routes traffic based on which class your Ingress resources reference.\n\nYour BYO Nginx uses the nginx IngressClass and runs in the ingress-nginx namespace. The App Routing add-on uses the webapprouting.kubernetes.azure.com IngressClass and runs in the app-routing-system namespace. They operate completely independently, each with its own load balancer IP.\n\nThis means you can:\n\n1. Enable the add-on alongside your existing controller\n2. Create new Ingress resources targeting the add-on (or duplicate existing ones)\n3. Validate everything works via the add-on's IP\n4. Cut over DNS or backend pool configuration\n5. Remove the old Ingress resources once you're satisfied\n\nAt no point does your production traffic go offline.\n\n## Enabling the App Routing add-on\n\nStart by enabling the add-on on your existing cluster. This doesn't touch your BYO Nginx installation.\n\nbash\n\n``` az aks approuting enable \\ --resource-group <resource-group> \\ --name <cluster-name> </cluster-name></resource-group> ```\n\nWait for the add-on to deploy. You can verify it's running by checking the app-routing-system namespace:\n\n``` kubectl get pods -n app-routing-system kubectl get svc -n app-routing-system ```\n\nYou should see the Nginx controller pod running and a service called nginx with a load balancer IP. This IP is separate from your BYO controller's IP.\n\nbash\n\n```\n# Get both IPs for comparison\nBYO_IP=$(kubectl get svc ingress-nginx-controller -n ingress-nginx \\ -o jsonpath='{.status.loadBalancer.ingress[0].ip}') add-on_IP=$(kubectl get svc nginx -n app-routing-system \\ -o jsonpath='{.status.loadBalancer.ingress[0].ip}') echo \"BYO Nginx IP: $BYO_IP\" echo \"add-on IP: $add-on_IP\" ```\n\nBoth controllers are now running. Your existing applications continue to use the BYO controller because their Ingress resources still reference ingressClassName: nginx.\n\n## Migrating Applications: The Parallel Ingress Approach\n\nFor production workloads, create a second Ingress resource that targets the add-on. This lets you validate everything before cutting over traffic.\n\nHere's an example. Your existing Ingress might look like this:\n\n``` apiVersion: networking.k8s.io/v1 kind: Ingress metadata: name: myapp-ingress-byo namespace: myapp annotations: nginx.ingress.kubernetes.io/rewrite-target: / spec: ingressClassName: nginx # BYO controller rules:\n- host: myapp.example.com\nhttp: paths:\n- path: /\npathType: Prefix backend: service: name: myapp port: number: 80 ```\n\nCreate a new Ingress for the add-on:\n\n``` apiVersion: networking.k8s.io/v1 kind: Ingress metadata: name: myapp-ingress-add-on namespace: myapp annotations: nginx.ingress.kubernetes.io/rewrite-target: / spec: ingressClassName: webapprouting.kubernetes.azure.com # add-on controller rules:\n- host: myapp.example.com\nhttp: paths:\n- path: /\npathType: Prefix backend: service: name: myapp port: number: 80 ```\n\nApply this new Ingress resource. The add-on controller picks it up and configures routing, but your production traffic still flows through the BYO controller because DNS (or your backend pool) still points to the old IP.\n\n### Validating Before Cutover\n\nTest the new route via the add-on IP before touching anything else:\n\n```\n# For public ingress with DNS\ncurl -H \"Host: myapp.example.com\" http://$add-on_IP\n# For private ingress, test from a VM in the VNet\ncurl -H \"Host: myapp.example.com\" http://$add-on_IP ```\n\nRun your full validation suite against this IP. Check TLS certificates, path routing, authentication, rate limiting, custom headers, and anything else your application depends on. If you have monitoring or synthetic tests, point them at the add-on IP temporarily to gather confidence.\n\nIf something doesn't work, you can troubleshoot without affecting production. The BYO controller is still handling all real traffic.\n\n## Cutover To Routing Add-on\n\nIf your ingress has a public IP and you're using DNS to route traffic, the cutover is straightforward.\n\n- Lower your DNS TTL well in advance. Set it to 60 seconds at least an hour before you plan to cut over. This ensures changes propagate quickly and you can roll back fast if needed.\n- When you're ready, update your DNS A record to point to the add-on IP\n\nIf your ingress has a private IP and sits behind App Gateway, API Management, or Front Door, the cutover involves updating the backend pool instead of DNS.\n\n## In-Place Patching: The Faster But Riskier Option\n\nIf you're migrating a non-critical application or an internal service where some downtime is acceptable, you can patch the ingressClassName in place:\n\n``` kubectl patch ingress myapp-ingress-byo -n myapp \\ --type='json' \\ -p='[{\"op\":\"replace\",\"path\":\"/spec/ingressClassName\",\"value\":\"webapprouting.kubernetes.azure.com\"}]' ```\n\nThis is atomic from Kubernetes' perspective. The BYO controller immediately drops the route, and the add-on controller immediately picks it up. In practice, there's usually a few seconds gap while the add-on configures Nginx and reloads. Once this change is made, the Ingress will not work until you update your DNS or backend pool details to point to the new IP.\n\n## Decommissioning the BYO Nginx Controller\n\nOnce all your applications are migrated and you're confident everything works, you can remove the BYO controller.\n\nFirst, verify nothing is still using it:\n\n``` kubectl get ingress --all-namespaces \\ -o custom-columns='NAMESPACE:.metadata.namespace,NAME:.metadata.name,CLASS:.spec.ingressClassName' \\ | grep -v \"webapprouting\" ```\n\nIf that returns only the header row (or is empty), you're clear to proceed. If it shows any Ingress resources, you've still got work to do.\n\nRemove the BYO Nginx Helm release:\n\n``` helm uninstall ingress-nginx -n ingress-nginx kubectl delete namespace ingress-nginx ```\n\nThe Azure Load Balancer provisioned for the BYO controller will be deprovisioned automatically.\n\nVerify only the add-on IngressClass remains:\n\n``` kubectl get ingressclass ```\n\nYou should see only webapprouting.kubernetes.azure.com.\n\n## Key Differences Between BYO Nginx and the App Routing add-on\n\nThe add-on runs the same Nginx binary, so most of your configuration carries over. However, there are a few differences worth noting.\n\n**TLS Certificates**: The BYO setup typically uses cert-manager or manual Secrets for certificates. The add-on supports this, but it also integrates natively with Azure Key Vault. If you want to use Key Vault, you need to configure the add-on with the appropriate annotations. Otherwise, your existing cert-manager setup continues to work.\n\n**DNS Management**: If you're using external-dns with your BYO controller, it works with the add-on too. The add-on also has native integration with Azure DNS zones if you want to simplify your setup. This is optional.\n\n**Custom Nginx Configuration**: With BYO Nginx, you have full access to the ConfigMap and can customise the global Nginx configuration extensively. The add-on restricts this because it's managed by Azure. If you've done significant customisation (Lua scripts, custom modules, etc.), audit carefully to ensure the add-on supports what you need. Most standard configurations work fine.\n\n**Annotations**: The nginx.ingress.kubernetes.io/\\* annotations work the same way. The add-on adds some Azure-specific annotations for WAF integration and other features, but your existing annotations should carry over without changes.\n\n## What Comes Next\n\nThis migration gets you onto a supported platform, but it's temporary. November 2026 is not far away, and you'll need to plan your next move.\n\nMicrosoft is building a new App Routing add-on based on Istio. This is expected later in 2026 and will likely become the long-term supported option. Keep an eye on Azure updates for announcements about preview availability and migration paths.\n\nIf you need something production-ready sooner, App Gateway for Containers is worth evaluating. It's built on Envoy and supports the Kubernetes Gateway API, which is the future direction for ingress in Kubernetes. The Gateway API is more expressive than the Ingress API and is designed to be vendor-neutral.\n\nFor now, getting off the unsupported BYO Nginx controller is the priority. The App Routing add-on gives you the breathing room to make an informed decision about your long-term strategy rather than rushing into something because you're running out of time.\n\nUpdated Feb 20, 2026\n\nVersion 1.0\n\n[azure kubernetes service](/tag/azure%20kubernetes%20service?nodeId=board%3AAppsonAzureBlog)\n\n[containers](/tag/containers?nodeId=board%3AAppsonAzureBlog)\n\n[!\\[samcogan&#x27;s avatar\\](https://techcommunity.microsoft.com/t5/s/gxcuf89792/images/dS0yOTgxNTI4LVdSRVN4Rg?image-coordinates=64%2C0%2C1938%2C1873&amp;image-dimensions=50x50)](/users/samcogan/2981528) [samcogan](/users/samcogan/2981528) ![Icon for Microsoft rank](https://techcommunity.microsoft.com/t5/s/gxcuf89792/images/cmstNC05WEo0blc?image-dimensions=100x16&amp;constrain-image=true)Microsoft\n\nJoined April 03, 2025\n\n[View Profile](/users/samcogan/2981528)\n\n/category/azure/blog/appsonazureblog [Apps on Azure Blog](/category/azure/blog/appsonazureblog) Follow this blog board to get notified when there's new activity",
  "FeedLevelAuthor": "rss.livelink.threads-in-node",
  "Author": "samcogan",
  "Tags": []
}
