{
  "Tags": [],
  "Author": "dbandaru",
  "FeedUrl": "https://techcommunity.microsoft.com/t5/s/gxcuf89792/rss/Category?category.id=Azure",
  "Link": "https://techcommunity.microsoft.com/t5/apps-on-azure-blog/get-started-with-elasticsearch-mcp-server-in-azure-sre-agent/ba-p/4492896",
  "ProcessedDate": "2026-02-18 17:24:13",
  "PubDate": "2026-02-18T16:41:52+00:00",
  "OutputDir": "_community",
  "EnhancedContent": "## Overview\n\nThe Elasticsearch MCP server enables Azure SRE Agent to interact with your Elasticsearch clusters using natural language. Query your logs, analyze metrics, check cluster health, and troubleshoot issues conversationally.\n\nThis integration uses Elastic's **Agent Builder MCP endpoint**, the recommended approach for Elastic 9.2.0+ and Elasticsearch Serverless projects.\n\n### Key capabilities\n\n| Capability | Description | | --- | --- | | **Search** | Execute search queries using Elasticsearch Query DSL | | **ES|QL** | Run ES|QL queries for data exploration | | **Mappings** | Get field mappings for indices | | **Cluster health** | Check shard information and cluster status | | **Index management** | List available indices |\n\n## Prerequisites\n\n- Azure SRE Agent resource at [sre.azure.com](https://sre.azure.com)\n- Elasticsearch cluster (Elastic Cloud or self-hosted, version 9.2.0 or higher)\n- Kibana with Agent Builder enabled (Elastic 9.2.0+ or Serverless)\n- API key with appropriate permissions\n\n## Step 1: Get your Elasticsearch credentials\n\n1. Log in to Elastic Cloud or your self-hosted Kibana at `https://{your-kibana-url}`\n2. Navigate to **Management** &gt; **API Keys**\n3. Click **Create API key**\n4. Provide a name (e.g., `azure-sre-agent-mcp`\n)\n5. Set appropriate permissions (at minimum, read access to indices you want to query)\n6. Click **Create API key** and copy the encoded API key\n7. Note your Kibana URL (e.g., `https://my-deployment.kb.us-east-1.aws.elastic.cloud`\n)\n\n## Step 2: Add the MCP connector\n\n1. Navigate to your Azure SRE Agent at [sre.azure.com](https://sre.azure.com)\n2. Select your agent from the list\n3. In the left navigation, expand **Builder** &gt; **Connectors**\n4. Select **Add connector**\n5. In \"Choose a connector\", select **MCP server** (User provided connector)\n6. Click **Next** and configure:\n\n| Field | Value | | --- | --- | | **Name** | `elasticsearch-mcp` | | **Connection type** | Streamable-HTTP | | **URL** | `https://{KIBANA_URL}/api/agent_builder/mcp` | | **Authentication method** | Custom headers | | **Header name** | `Authorization` | | **Header value** | `ApiKey {your-api-key}` |\n\n7. Click **Next** to review, then **Add** to save\n\n### Equivalent mcp.json configuration\n\nFor reference, the equivalent mcp.json configuration:\n\n``` { \"mcpServers\": { \"elasticsearch-mcp\": { \"url\": \"https://{KIBANA_URL}/api/agent_builder/mcp\", \"transport\": \"streamable-http\", \"headers\": { \"Authorization\": \"ApiKey {your-api-key}\" } } } } ```\n\n## Step 3: Create a subagent and add tools\n\n1. In the left navigation, select **Builder** &gt; **Subagent builder**\n2. Click **+ Create**\n3. Switch to the **YAML** tab and paste this configuration:\n\n``` api_version: api_version: azuresre.ai/v1 kind: AgentConfiguration spec: name: Elasticsearch system_prompt: > Goal: Provide a single, reliable interface for Azure SREs to query and retrieve observability data (logs, metrics, traces) from a remote Elasticsearch deployment using ES|QL to diagnose incidents and answer operational questions. Role: Elasticsearch Observability Query Agent (for Azure SRE Operations). Handoff guidance (for other agents): Delegate to this agent when you need Elasticsearch observability data (logs/metrics/traces) retrieved or analyzed via ES|QL (including figuring out the right indices/data streams, fields, or writing/refining safe time-bounded queries). Do not delegate for remediation/changes outside querying/analysis. Capabilities:\n\n- Discoverability: list supported operations (connectivity/test, list indices/data streams,\nmappings/field discovery, sample documents).\n\n- Data access: identify relevant indices/data streams from incident context; request permission\nto enumerate when needed.\n\n- Query authoring: write ES|QL for time-bounded log/metric/trace retrieval, filtering,\naggregation, grouping, sorting, limits.\n\n- Query iteration: refine queries based on results/errors; explain changes.\nOperating guidelines:\n\n- Ask only for the minimum required context when missing: time range (UTC), environment/cluster,\nservice/app name, and any identifiers (host, pod, trace.id, correlation id). If unknown, propose sensible defaults and clearly label them as assumptions.\n\n- Prefer safe, bounded queries: always include explicit time filters and LIMIT; avoid unbounded\nscans.\n\n- If index/data stream is unknown, first propose likely patterns and/or request permission to\nenumerate indices/data streams.\n\n- If ES|QL is unsupported in the target, propose an equivalent query approach supported by the\ndeployment and state the assumption.\n\n- Do not fabricate index names, field names, mappings, or results. If you must assume, label it\nand ask the user to confirm. Constraints:\n\n- No destructive actions: never modify, delete, or reindex data.\n\n- Treat endpoints/credentials as sensitive: request only if necessary; never echo secrets.\nOutput format (default): 1) Intent (1–2 lines) 2) ES|QL query (fenced code block) 3) What to look for in results 4) Optional next-step query Interaction rule:\n\n- When you ask the user a question to proceed, stop and end your turn immediately after the\nquestion.\n\n- Do not repeat the same question in later turns; instead, acknowledge what was answered and ask\nonly what remains. Self-reflect: Before responding, confirm: (a) the goal is incident/ops diagnosis via Elasticsearch observability data, (b) the query is time-bounded and safe (explicit time filter + LIMIT), (c) unknowns are asked at most once, and if a question is asked this turn ends immediately after it. tools:\n- Elasticsearch_platform_core_execute_esql\n- Elasticsearch_platform_core_generate_esql\n- Elasticsearch_platform_core_get_document_by_id\n- Elasticsearch_platform_core_get_index_mapping\n- Elasticsearch_platform_core_index_explorer\n- Elasticsearch_platform_core_list_indices\n- Elasticsearch_platform_core_search\nhandoff_description: >- Delegate to this agent when you need Elasticsearch observability data (logs/metrics/traces) retrieved or analyzed via ES|QL (including figuring out the right indices/data streams, fields, or writing/refining safe time-bounded queries). Do not delegate for remediation/changes outside querying/analysis. agent_type: Autonomous enable_skills: false\n\n```\n\n4. Click **Create** to save the subagent\n\n> >\n> **CRITICAL: You must add tools to the subagent!** Without adding tools, the subagent has no access to the MCP server's capabilities and will not function.\n> >\n\n1. After creating the subagent, select it from the list to open the editor\n2. Navigate to the **Tools** tab\n3. Click **+ Add tools**\n4. In the tool picker, find the `elasticsearch-mcp`connector tools:\n- `list_indices`\n- `get_mappings`\n- `search`\n- `esql`\n- `get_shards`\n5. Select all the tools you want the subagent to use\n6. Click **Add** to attach the tools to the subagent\n7. Click **Save** to finalize the subagent configuration\n\n## Step 4: Test the integration\n\n1. Open a new chat session with your Azure SRE Agent\n2. Try these example prompts:\n\n| Prompt | What it tests | | --- | --- | | \"List all indices in my Elasticsearch cluster\" | `list_indices`<br> tool | | \"What are the mappings for the logs-\\* index?\" | `get_mappings`<br> tool | | \"Search for errors in the last hour across all logs indices\" | `search`<br> tool | | \"Run an ES|QL query to find the top 10 error types\" | `esql`<br> tool | | \"Show me shard information for my cluster\" | `get_shards`<br> tool |\n\n## Available tools\n\n| Tool | Description | | --- | --- | | `list_indices` | List all available Elasticsearch indices | | `get_mappings` | Get field mappings for a specific Elasticsearch index | | `search` | Perform an Elasticsearch search with the provided Query DSL | | `esql` | Perform an ES|QL query | | `get_shards` | Get shard information for all or specific indices |\n\n## Troubleshooting\n\n| Issue | Solution | | --- | --- | | **Subagent doesn't have Elasticsearch tools** | You MUST add tools to the subagent after creating it! Go to subagent &gt; Tools tab &gt; Add tools &gt; select elasticsearch-mcp tools | | Connection refused | Verify Kibana URL is correct and accessible from Azure | | 401 Unauthorized | Check API key is valid and has proper permissions | | 403 Forbidden | Ensure Agent Builder is enabled in your Elastic deployment | | Tools not appearing | Wait a few seconds after adding connector, then refresh | | SSL/TLS errors | Ensure your Kibana URL uses HTTPS |\n\n##\n\n## Related content\n\n- [Elasticsearch MCP Server (GitHub)](https://github.com/elastic/mcp-server-elasticsearch)\n- [Elastic Agent Builder Documentation](https://ela.st/agent-builder-docs)\n- [Elastic Agent Builder MCP Endpoint](https://ela.st/agent-builder-mcp)\n- [MCP integration overview](https://learn.microsoft.com/azure/sre-agent/mcp-integration)\n\nUpdated Feb 18, 2026\n\nVersion 1.0\n\n[azure sre agent](/tag/azure%20sre%20agent?nodeId=board%3AAppsonAzureBlog)\n\n[!\\[dbandaru&#x27;s avatar\\](https://techcommunity.microsoft.com/t5/s/gxcuf89792/images/dS0xODc2Mjc5LTU4NDM2OWk2MjcxQjY2RTZCMEQzMDkw?image-dimensions=50x50)](/users/dbandaru/1876279) [dbandaru](/users/dbandaru/1876279) ![Icon for Microsoft rank](https://techcommunity.microsoft.com/t5/s/gxcuf89792/images/cmstNC05WEo0blc?image-dimensions=100x16&amp;constrain-image=true)Microsoft\n\nJoined May 24, 2023\n\n[View Profile](/users/dbandaru/1876279)\n\n/category/azure/blog/appsonazureblog [Apps on Azure Blog](/category/azure/blog/appsonazureblog) Follow this blog board to get notified when there's new activity",
  "Title": "Get started with Elasticsearch MCP server in Azure SRE Agent",
  "Description": "## Overview\n\nThe Elasticsearch MCP server enables Azure SRE Agent to interact with your Elasticsearch clusters using natural language. Query your logs, analyze metrics, check cluster health, and troubleshoot issues conversationally.\n\nThis integration uses Elastic's **Agent Builder MCP endpoint**, the recommended approach for Elastic 9.2.0+ and Elasticsearch Serverless projects.\n\n### Key capabilities\n\n| Capability | Description | | --- | --- | | **Search** | Execute search queries using Elasticsearch Query DSL | | **ES|QL** | Run ES|QL queries for data exploration | | **Mappings** | Get field mappings for indices | | **Cluster health** | Check shard information and cluster status | | **Index management** | List available indices |\n\n## Prerequisites\n\n- Azure SRE Agent resource at [sre.azure.com](https://sre.azure.com)\n- Elasticsearch cluster (Elastic Cloud or self-hosted, version 9.2.0 or higher)\n- Kibana with Agent Builder enabled (Elastic 9.2.0+ or Serverless)\n- API key with appropriate permissions\n\n## Step 1: Get your Elasticsearch credentials\n\n1. Log in to Elastic Cloud or your self-hosted Kibana at `https://{your-kibana-url}`\n2. Navigate to **Management** > **API Keys**\n3. Click **Create API key**\n4. Provide a name (e.g., `azure-sre-agent-mcp`\n)\n5. Set appropriate permissions (at minimum, read access to indices you want to query)\n6. Click **Create API key** and copy the encoded API key\n7. Note your Kibana URL (e.g., `https://my-deployment.kb.us-east-1.aws.elastic.cloud`\n)\n\n## Step 2: Add the MCP connector\n\n1. Navigate to your Azure SRE Agent at [sre.azure.com](https://sre.azure.com)\n2. Select your agent from the list\n3. In the left navigation, expand **Builder** > **Connectors**\n4. Select **Add connector**\n5. In \"Choose a connector\", select **MCP server** (User provided connector)\n6. Click **Next** and configure:\n\n| Field | Value | | --- | --- | | **Name** | `elasticsearch-mcp` | | **Connection type** | Streamable-HTTP | | **URL** | `https://{KIBANA_URL}/api/agent_builder/mcp` | | **Authentication method** | Custom headers | | **Header name** | `Authorization` | | **Header value** | `ApiKey {your-api-key}` |\n\n7. Click **Next** to review, then **Add** to save\n\n### Equivalent mcp.json configuration\n\nFor reference, the equivalent mcp.json configuration:\n\n``` { \"mcpServers\": { \"elasticsearch-mcp\": { \"url\": \"https://{KIBANA_URL}/api/agent_builder/mcp\", \"transport\": \"streamable-http\", \"headers\": { \"Authorization\": \"ApiKey {your-api-key}\" } } } } ```\n\n## Step 3: Create a subagent and add tools\n\n1. In the left navigation, select **Builder** > **Subagent builder**\n2. Click **+ Create**\n3. Switch to the **YAML** tab and paste this configuration:\n\n``` api_version: api_version: azuresre.ai/v1 kind: AgentConfiguration spec: name: Elasticsearch system_prompt: > Goal: Provide a single, reliable interface for Azure SREs to query and retrieve observability data (logs, metrics, traces) from a remote Elasticsearch deployment using ES|QL to diagnose incidents and answer operational questions. Role: Elasticsearch Observability Query Agent (for Azure SRE Operations). Handoff guidance (for other agents): Delegate to this agent when you need Elasticsearch observability data (logs/metrics/traces) retrieved or analyzed via ES|QL (including figuring out the right indices/data streams, fields, or writing/refining safe time-bounded queries). Do not delegate for remediation/changes outside querying/analysis. Capabilities:\n\n- Discoverability: list supported operations (connectivity/test, list indices/data streams,\nmappings/field discovery, sample documents).\n\n- Data access: identify relevant indices/data streams from incident context; request permission\nto enumerate when needed.\n\n- Query authoring: write ES|QL for time-bounded log/metric/trace retrieval, filtering,\naggregation, grouping, sorting, limits.\n\n- Query iteration: refine queries based on results/errors; explain changes.\nOperating guidelines:\n\n- Ask only for the minimum required context when missing: time range (UTC), environment/cluster,\nservice/app name, and any identifiers (host, pod, trace.id, correlation id). If unknown, propose sensible defaults and clearly label them as assumptions.\n\n- Prefer safe, bounded queries: always include explicit time filters and LIMIT; avoid unbounded\nscans.\n\n- If index/data stream is unknown, first propose likely patterns and/or request permission to\nenumerate indices/data streams.\n\n- If ES|QL is unsupported in the target, propose an equivalent query approach supported by the\ndeployment and state the assumption.\n\n- Do not fabricate index names, field names, mappings, or results. If you must assume, label it\nand ask the user to confirm. Constraints:\n\n- No destructive actions: never modify, delete, or reindex data.\n\n- Treat endpoints/credentials as sensitive: request only if necessary; never echo secrets.\nOutput format (default): 1) Intent (1–2 lines) 2) ES|QL query (fenced code block) 3) What to look for in results 4) Optional next-step query Interaction rule:\n\n- When you ask the user a question to proceed, stop and end your turn immediately after the\nquestion.\n\n- Do not repeat the same question in later turns; instead, acknowledge what was answered and ask\nonly what remains. Self-reflect: Before responding, confirm: (a) the goal is incident/ops diagnosis via Elasticsearch observability data, (b) the query is time-bounded and safe (explicit time filter + LIMIT), (c) unknowns are asked at most once, and if a question is asked this turn ends immediately after it. tools:\n- Elasticsearch_platform_core_execute_esql\n- Elasticsearch_platform_core_generate_esql\n- Elasticsearch_platform_core_get_document_by_id\n- Elasticsearch_platform_core_get_index_mapping\n- Elasticsearch_platform_core_index_explorer\n- Elasticsearch_platform_core_list_indices\n- Elasticsearch_platform_core_search\nhandoff_description: >- Delegate to this agent when you need Elasticsearch observability data (logs/metrics/traces) retrieved or analyzed via ES|QL (including figuring out the right indices/data streams, fields, or writing/refining safe time-bounded queries). Do not delegate for remediation/changes outside querying/analysis. agent_type: Autonomous enable_skills: false\n\n```\n\n4. Click **Create** to save the subagent\n\n> >\n> **CRITICAL: You must add tools to the subagent!** Without adding tools, the subagent has no access to the MCP server's capabilities and will not function.\n> >\n\n1. After creating the subagent, select it from the list to open the editor\n2. Navigate to the **Tools** tab\n3. Click **+ Add tools**\n4. In the tool picker, find the `elasticsearch-mcp`connector tools:\n- `list_indices`\n- `get_mappings`\n- `search`\n- `esql`\n- `get_shards`\n5. Select all the tools you want the subagent to use\n6. Click **Add** to attach the tools to the subagent\n7. Click **Save** to finalize the subagent configuration\n\n## Step 4: Test the integration\n\n1. Open a new chat session with your Azure SRE Agent\n2. Try these example prompts:\n\n| Prompt | What it tests | | --- | --- | | \"List all indices in my Elasticsearch cluster\" | `list_indices`<br> tool | | \"What are the mappings for the logs-\\* index?\" | `get_mappings`<br> tool | | \"Search for errors in the last hour across all logs indices\" | `search`<br> tool | | \"Run an ES|QL query to find the top 10 error types\" | `esql`<br> tool | | \"Show me shard information for my cluster\" | `get_shards`<br> tool |\n\n## Available tools\n\n| Tool | Description | | --- | --- | | `list_indices` | List all available Elasticsearch indices | | `get_mappings` | Get field mappings for a specific Elasticsearch index | | `search` | Perform an Elasticsearch search with the provided Query DSL | | `esql` | Perform an ES|QL query | | `get_shards` | Get shard information for all or specific indices |\n\n## Troubleshooting\n\n| Issue | Solution | | --- | --- | | **Subagent doesn't have Elasticsearch tools** | You MUST add tools to the subagent after creating it! Go to subagent > Tools tab > Add tools > select elasticsearch-mcp tools | | Connection refused | Verify Kibana URL is correct and accessible from Azure | | 401 Unauthorized | Check API key is valid and has proper permissions | | 403 Forbidden | Ensure Agent Builder is enabled in your Elastic deployment | | Tools not appearing | Wait a few seconds after adding connector, then refresh | | SSL/TLS errors | Ensure your Kibana URL uses HTTPS |\n\n##\n\n## Related content\n\n- [Elasticsearch MCP Server (GitHub)](https://github.com/elastic/mcp-server-elasticsearch)\n- [Elastic Agent Builder Documentation](https://ela.st/agent-builder-docs)\n- [Elastic Agent Builder MCP Endpoint](https://ela.st/agent-builder-mcp)\n- [MCP integration overview](https://learn.microsoft.com/azure/sre-agent/mcp-integration)",
  "FeedName": "Microsoft Tech Community",
  "FeedLevelAuthor": "rss.livelink.threads-in-node"
}
