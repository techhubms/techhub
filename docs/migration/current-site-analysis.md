# Current Site Analysis

> **AI AGENT CONTEXT**: This document analyzes the current Jekyll-based Tech Hub implementation to inform the .NET migration. All behavior documented here must be preserved in the new implementation.

## Overview

Tech Hub is a Jekyll-based static content hub with **7 sections**, **5 collections**, and a sophisticated filtering system. It's configured entirely through `_data/sections.json` with no hardcoded values.

## Page Types

### 1. Home Page (`/index.md`)

**URL**: `/`  
**Template**: `_layouts/home.html`  
**Purpose**: Site landing page showing all sections and recent roundups

**Content**:
- Grid of section cards (8 total: All, GitHub Copilot, AI, ML, Azure, .NET/Coding, DevOps, Security)
- Each card shows section title, description, and background image
- Latest roundups section (most recent weekly summaries)
- Navigation header with RSS link

**Data Sources**:
- `site.data.sections` - All section definitions
- `site.roundups` - Roundup collection for recent summaries

**Server-Side Rendering**:
- All section cards rendered by Jekyll during build
- No JavaScript required for initial display
- Section cards are clickable links to section index pages

### 2. Section Index Pages

**URLs**: `/all`, `/github-copilot`, `/ai`, `/ml`, `/azure`, `/dotnet`, `/devops`, `/security`  
**Template**: Generated by `_plugins/section_pages_generator.rb`  
**Purpose**: Show all collections within a section

**Content**:
- Section header with title, description, background image
- Sub-navigation tabs for each collection in the section
- Active collection's content list with filtering controls
- Date filter dropdown (Last 7 days, Last 30 days, Last 90 days, All Time)
- Tag filter chips (top 20 most used tags in this category)
- Text search input
- Content items list with pagination ("20 + same-day" rule)

**Data Sources**:
- `site.data.sections[section_key]` - Section configuration
- `site[collection_name]` - Collection items (e.g., `site.news`, `site.videos`)
- `site.data.category_tags` - Pre-calculated tag usage per category

**Filtering Logic**:
1. **Server-side**: Apply "20 + same-day" rule + 7-day recency filter during build
2. **Client-side**: Filter by date range, tags, and text search on pre-filtered set
3. **URL state**: Filter state preserved in URL parameters (`?tag=azure&date=30days`)

**Generated Pages**:
- Section index pages are NOT manual files
- Created automatically from sections.json by plugin
- DO NOT edit generated section pages directly

### 3. Collection Pages

**URLs**: `/{section}/{collection}.html` (e.g., `/github-copilot/videos.html`, `/ai/news.html`)  
**Template**: `_layouts/collection.html`  
**Purpose**: Show all items from a specific collection within a section

**Content**:
- Same structure as section index page
- Shows only one collection (not all collections in section)
- Same filtering controls (date, tags, text search)
- Content items specific to that collection

**Special Cases**:
- `/all/news.html` - All news across all sections (no category filter)
- `/all/videos.html` - All videos across all sections
- Section-specific: `/github-copilot/videos.html` - Videos tagged "GitHub Copilot"

### 4. Item Detail Pages

**URLs**: `/{yyyy-mm-dd-slug}.html` (e.g., `/2025-01-02-chat-in-ide.html`)  
**Template**: Varies by collection (`_layouts/post.html`, `_layouts/video.html`, etc.)  
**Purpose**: Display individual content item

**Content**:
- Full article content with markdown rendering
- Publication date and author (if available)
- Category tags (clickable, link to filtered section view)
- Related content suggestions
- Social sharing buttons
- Schema.org structured data (Article, BlogPosting, VideoObject)

**Special Features**:
- YouTube embed for videos (custom Liquid tag: `{% youtube VIDEO_ID %}`)
- Table of contents for long articles
- Code syntax highlighting (Rouge)
- Image lazy loading

**Multi-URL Access**:
- Same item accessible from multiple section contexts
- Example: `/ai/videos/vs-code-107.html` AND `/github-copilot/videos/vs-code-107.html`
- Canonical URL specified in frontmatter for SEO

### 5. Custom Pages

**GitHub Copilot Section**:
- `/github-copilot/features.html` - Feature showcase
- `/github-copilot/levels-of-enlightenment.html` - Learning path
- `/github-copilot/ai-to-z.html` - A-to-Z guide

**AI Section**:
- `/ai/ai-to-z.html` - A-to-Z guide

**About**:
- `/about.html` - Site information

## URL Structure Patterns

### Section URLs

| Pattern | Example | Description |
| --------- | --------- | ------------- |
| `/` | `/` | Home page |
| `/{section}` | `/github-copilot` | Section index |
| `/{section}/{collection}.html` | `/ai/news.html` | Collection within section |
| `/{yyyy-mm-dd-slug}.html` | `/2025-01-02-chat-in-ide.html` | Item detail (flat) |

### RSS Feed URLs

| Pattern | Example | Description |
| --------- | --------- | ------------- |
| `/feed.xml` | `/feed.xml` | All content |
| `/{section}/feed.xml` | `/github-copilot/feed.xml` | Section feed |
| `/roundups/feed.xml` | `/roundups/feed.xml` | Roundups only |

### Special URLs

| Pattern | Example | Description |
| --------- | --------- | ------------- |
| `/{section}/custom.html` | `/github-copilot/features.html` | Custom section page |
| `/404.html` | `/404.html` | Error page |
| `/about.html` | `/about.html` | About page |

## Filtering System Behavior

### Server-Side Filtering (Build Time)

**"20 + Same-Day" Rule**:
1. Sort collection by date (newest first)
2. Take first 20 items
3. Add all items from the same day as the 20th item
4. Apply 7-day recency filter (exclude items older than 7 days)

**Implementation**: `_plugins/date_filters.rb` â†’ `limit_with_same_day` filter

**Result**: Initial page load shows ~20-30 items (optimized for performance)

### Client-Side Filtering (Runtime)

Implemented in `assets/js/sections.js` and `assets/js/filter-*.js`:

**Date Filters**:
- Last 7 days (default for most sections)
- Last 30 days
- Last 90 days
- All Time

**Tag Filters**:
- Checkbox list of top 20 tags for the current category
- Multiple tags can be selected (OR logic)
- Tag normalization (lowercase, trimmed)

**Text Search**:
- Searches titles, descriptions, and tags
- Case-insensitive
- Debounced input (300ms delay)

**URL State Preservation**:
- Filter state stored in URL query parameters
- Examples: `?date=30days`, `?tag=azure&tag=ai`, `?search=copilot`
- Enables sharing of filtered views
- Browser back/forward navigation works

## RSS Feed Formats

All RSS feeds follow RSS 2.0 specification:

**Structure**:
```xml
<?xml version="1.0" encoding="UTF-8"?>
<rss version="2.0">
  <channel>
    <title>Section Title | Tech Hub</title>
    <link>https://tech.hub.ms/section/</link>
    <description>Section description</description>
    <item>
      <title>Item Title</title>
      <link>https://tech.hub.ms/2025-01-02-slug.html</link>
      <description>Item excerpt</description>
      <pubDate>Thu, 02 Jan 2025 00:00:00 +0100</pubDate>
      <guid>https://tech.hub.ms/2025-01-02-slug.html</guid>
      <category>GitHub Copilot</category>
    </item>
  </channel>
</rss>
```

**Feed Generation**:
- Liquid templates in `/rss/` directory
- `feed.xml` - All content across all sections
- `{section}/feed.xml` - Content for specific section (filtered by category)
- `/roundups/feed.xml` - Roundups collection only

## Mobile Responsiveness

**Breakpoints**:
- Mobile: < 768px
- Tablet: 768px - 1024px
- Desktop: > 1024px

**Mobile Optimizations**:
- Hamburger menu for navigation
- Stacked section cards (no grid)
- Collapsible filter controls
- Touch-friendly tap targets (44px minimum)
- Optimized images with lazy loading

**Touch Interactions**:
- Swipe navigation for collection tabs
- Pull-to-refresh support (browser native)
- Smooth scrolling

## Navigation Patterns

### Primary Navigation (Header)

- Home link (Tech Hub logo)
- Section dropdown menu
- RSS feed link
- About link
- Search toggle

### Section Sub-Navigation

- Horizontal tab list for collections
- Active collection highlighted
- Sticky header on scroll

### Breadcrumbs

Not currently implemented (future enhancement).

### Footer Navigation

- Section links (all 8 sections)
- Collection links within "Everything"
- About link
- RSS feed link
- Copyright notice

## Data File Structure

### `_data/sections.json`

**Purpose**: Single source of truth for all sections and collections

**Schema**:
```json
{
  "section-key": {
    "title": "Section Display Title",
    "description": "Section description for meta tags and cards",
    "url": "/section-url",
    "section": "section-key",
    "image": "/assets/section-backgrounds/image.jpg",
    "category": "Category Name",
    "collections": [
      {
        "title": "Collection Display Title",
        "url": "/section/collection.html",
        "collection": "collection-name",
        "description": "Collection description"
      }
    ]
  }
}
```

**Current Sections**:
1. `all` - Everything (category: "All")
2. `github-copilot` - GitHub Copilot (category: "GitHub Copilot")
3. `ai` - AI (category: "AI")
4. `ml` - ML (category: "ML")
5. `azure` - Azure (category: "Azure")
6. `dotnet` - .NET/Coding (category: "Coding")
7. `devops` - DevOps (category: "DevOps")
8. `security` - Security (category: "Security")

**Collections**:
- `news` - Official product updates
- `blogs` - Blogs
- `videos` - Video content and tutorials
- `community` - Microsoft Tech Community posts
- `roundups` - Weekly content summaries (only in "all" section)

## Content Frontmatter

### Common Fields (All Collections)

```yaml
---
title: "Item Title"
date: 2025-01-02
categories:
  - GitHub Copilot
  - AI
tags:
  - vscode
  - azure
  - machine-learning
author: Author Name (optional)
excerpt: "Brief summary (max 200 words)"
---
```

### Video-Specific Fields

```yaml
---
youtube_id: "abc123xyz"
duration: "10:45"
thumbnail: "/assets/images/video-thumbnail.jpg"
---
```

### Special Cases

**Alt-Collection** (e.g., `_videos/ghc-features/`):
```yaml
---
alt-collection: "features"
plans:
  - Individual
  - Business
  - Enterprise
ghes_support: true
---
```

## Timezone Handling

**Critical Principle**: ALL dates use `Europe/Brussels` timezone

**Implementation**:
- Configured in `_config.yml`: `timezone: Europe/Brussels`
- Plugin filters respect timezone: `date_to_epoch`, `now_epoch`
- Client-side JavaScript uses same timezone for date comparisons
- Epoch timestamps used internally for consistency

**Date Formats**:
- Input: `YYYY-MM-DD` or `YYYY-MM-DD HH:MM:SS +ZONE`
- Storage: Unix epoch timestamps (integers)
- Display: Generated at runtime from epoch

## Performance Characteristics

**Build Time**: ~60-90 seconds (for ~400 content items)

**Page Load Performance**:
- Initial HTML: < 500KB (compressed)
- JavaScript: ~50KB (compressed)
- CSS: ~30KB (compressed)
- Images: Lazy loaded, optimized

**Caching Strategy**:
- Static assets: 1 year cache
- HTML pages: No cache (always fresh)
- RSS feeds: 1 hour cache

**Rebuild Triggers**:
- Content changes: 2-5 seconds (specific items)
- Template changes: 60+ seconds (all pages)
- Plugin changes: Requires full restart
- Data file changes: 60+ seconds (all pages)

## Accessibility Features

**WCAG 2.1 Level AA Compliance**:
- Semantic HTML elements (`<article>`, `<nav>`, `<main>`, `<header>`, `<footer>`)
- ARIA labels for interactive elements
- Keyboard navigation support
- Color contrast ratios 4.5:1 minimum
- Focus indicators on all interactive elements
- Screen reader friendly

**Keyboard Navigation**:
- Tab through interactive elements
- Enter/Space to activate
- Escape to close modals/dropdowns
- Arrow keys for tab navigation

## SEO Features

**Meta Tags**:
- Title: `{Page Title} | Tech Hub`
- Description: Section/item description
- Keywords: Tags from content
- Open Graph tags for social sharing
- Twitter Card tags

**Structured Data** (Schema.org):
- Article type for news/blogs
- BlogPosting type for blogs
- VideoObject type for videos
- Organization markup
- BreadcrumbList (not yet implemented)

**Sitemap**: Auto-generated by `_plugins/sitemap_generator.rb`

**Robots.txt**: Allows all crawlers

## Current Limitations

1. No server-side search (only client-side filtering)
2. No user authentication or personalization
3. No comments or user-generated content
4. No analytics dashboard (only Google Analytics)
5. No A/B testing capabilities
6. No content preview for drafts
7. Limited related content suggestions
8. No content versioning or history

## Migration Priorities

Based on this analysis, prioritize:

1. **URL preservation** - Maintain exact URL structure for SEO
2. **Filtering system** - Core user experience depends on this
3. **RSS feeds** - External integrations rely on these
4. **Mobile responsiveness** - Majority of traffic is mobile
5. **Performance** - Sub-second loads are critical
6. **Semantic HTML** - Required for NLWeb compatibility

