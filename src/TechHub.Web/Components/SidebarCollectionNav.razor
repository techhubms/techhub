@* ============================================================================
   Sidebar Collection Navigation Component
   
   Renders navigation links for section collections and custom pages.
   Uses <nav> semantic HTML since it contains site navigation.
   
   Usage:
     <SidebarCollectionNav Section="@sectionData" SelectedCollection="all" />
   ============================================================================ *@

@using TechHub.Core.DTOs
@inject NavigationManager Navigation

<nav class="collection-nav" aria-label="Section collections and pages">
    @if (Section?.Collections != null && Section.Collections.Any())
    {
        <div class="sidebar-section">
            <h2 class="sidebar-h2">Collections</h2>
            <ul class="sidebar-list">
                <li>
                    <a href="/@(Section.Name)/all"
                        class="sidebar-link-button @(SelectedCollection == "all" ? "active" : "")">
                        All
                    </a>
                </li>
                @foreach (var collection in RegularCollections)
                {
                    var collectionName = collection.Name;
                    <li>
                        <a href="/@(Section.Name)/@collectionName"
                            class="sidebar-link-button @(SelectedCollection == collectionName ? "active" : "")">
                            @collection.Title
                        </a>
                    </li>
                }
            </ul>
        </div>
    }

    @if (CustomPages.Any())
    {
        <div class="sidebar-section">
            <h2 class="sidebar-h2">Pages</h2>
            <ul class="sidebar-list">
                @foreach (var customPage in CustomPages)
                {
                    <li>
                        <a href="@customPage.Url" class="sidebar-link-button">
                            @customPage.Title
                        </a>
                    </li>
                }
            </ul>
        </div>
    }
</nav>

@code {
    [Parameter, EditorRequired]
    public required SectionDto Section { get; set; }

    [Parameter]
    public string SelectedCollection { get; set; } = "all";

    private IEnumerable<CollectionReferenceDto> RegularCollections =>
    Section?.Collections.Where(c => !c.IsCustom) ?? Enumerable.Empty<CollectionReferenceDto>();

    private IEnumerable<CollectionReferenceDto> CustomPages =>
    Section?.Collections.Where(c => c.IsCustom) ?? Enumerable.Empty<CollectionReferenceDto>();
}