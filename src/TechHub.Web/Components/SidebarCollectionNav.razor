@using TechHub.Core.DTOs
@inject NavigationManager Navigation

<nav class="collection-nav">
    <div class="sidebar-section">
        <h2>Collections</h2>
        
        @if (Section?.Collections != null && Section.Collections.Any())
        {
            <ul>
            <li>
                <a href="/@(Section.Name)/all" 
                   class="@(SelectedCollection == "all" ? "active" : "")">
                    All
                </a>
            </li>
            @foreach (var collection in RegularCollections)
            {
                var collectionName = collection.Name;
                <li>
                    <a href="/@(Section.Name)/@collectionName" 
                       class="@(SelectedCollection == collectionName ? "active" : "")">
                        @collection.Title
                    </a>
                </li>
            }
        </ul>
        
        @if (CustomPages.Any())
        {
            <h3>Pages</h3>
            <ul>
                @foreach (var customPage in CustomPages)
                {
                    <li>
                        <a href="@customPage.Url">
                            @customPage.Title
                        </a>
                    </li>
                }
            </ul>
        }
    }
    </div>
    
    <div class="sidebar-section">
        <h2>Subscribe</h2>
        <ul class="sidebar-links">
            <li>
                <a href="@($"{Section!.Url}/feed.xml")" target="_blank" rel="noopener noreferrer">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true">
                        <path d="M6.18 15.64a2.18 2.18 0 0 1 2.18 2.18C8.36 19 7.38 20 6.18 20C5 20 4 19 4 17.82a2.18 2.18 0 0 1 2.18-2.18M4 4.44A15.56 15.56 0 0 1 19.56 20h-2.83A12.73 12.73 0 0 0 4 7.27V4.44m0 5.66a9.9 9.9 0 0 1 9.9 9.9h-2.83A7.07 7.07 0 0 0 4 12.93V10.1z"/>
                    </svg>
                    RSS Feed
                </a>
            </li>
        </ul>
    </div>
</nav>

@code {
    [Parameter, EditorRequired]
    public required SectionDto Section { get; set; }

    [Parameter]
    public string SelectedCollection { get; set; } = "all";
    
    private IEnumerable<CollectionReferenceDto> RegularCollections => 
        Section?.Collections.Where(c => !c.IsCustom) ?? Enumerable.Empty<CollectionReferenceDto>();
    
    private IEnumerable<CollectionReferenceDto> CustomPages => 
        Section?.Collections.Where(c => c.IsCustom) ?? Enumerable.Empty<CollectionReferenceDto>();
}
