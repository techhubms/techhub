@inherits LayoutComponentBase
@inject IJSRuntime JS

@Body

<footer class="site-footer">
    <div class="footer-content">
        <p>
            <a href="/about">Created with ❤️ by Reinier van Maanen, Rob Bos & Fokko Veegens</a>
        </p>
    </div>
</footer>

<div id="blazor-error-ui" role="alert" aria-live="assertive" data-nosnippet>
    <div class="error-content">
        <svg class="error-icon" xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24"
            fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
            aria-hidden="true">
            <circle cx="12" cy="12" r="10"></circle>
            <line x1="12" y1="8" x2="12" y2="12"></line>
            <line x1="12" y1="16" x2="12.01" y2="16"></line>
        </svg>
        <div class="error-message">
            <span>An unexpected error occurred. Please reload the page to continue.</span>
        </div>
    </div>
    <div class="error-actions">
        <a href="." class="reload-button">Reload Page</a>
        <button class="dismiss-button" aria-label="Dismiss error message">Close</button>
    </div>
</div>

@code {
    protected override async Task OnAfterRenderAsync(bool firstRender)
    {
        if (firstRender)
        {
            // Load page scripts (mermaid, highlight.js, custom-pages, etc.) after Blazor
            // has finished DOM reconciliation. This ensures scripts operate on the final
            // interactive DOM, not the prerendered HTML that Blazor may replace.
            // Subsequent navigations are handled by the pushState/popstate watcher
            // in TechHub.Web.lib.module.js.
            await JS.InvokeVoidAsync("loadScriptsForPage");
        }
    }
}