@page "/"
@using TechHub.Core.DTOs
@using TechHub.Web.Services
@inject TechHubApiClient ApiClient

<PageTitle>Tech Hub - Microsoft Technology News & Resources</PageTitle>

<HeadContent>
    <link rel="alternate" type="application/rss+xml" 
          title="Tech Hub - All Content - RSS Feed" 
          href="/api/rss/all" />
</HeadContent>

<header class="section-header home-banner">
    <div class="section-header-content">
        <h1 tabindex="-1">Tech Hub</h1>
        <p class="section-description">Your source for Microsoft technology news, tutorials, and community content</p>
    </div>
</header>

<div class="home-container">
    @if (errorMessage != null)
    {
        <div class="error">
            <h2>Error Loading Content</h2>
            <p>@errorMessage</p>
        </div>
    }
    else if (sections != null && sections.Any())
    {
        <div class="sections-grid">
            <h2 class="section-grid-title">Browse by section</h2>
            <div class="grid">
                @foreach (var item in sections)
                {
                    <SectionCard Section="@item" />
                }
            </div>
        </div>
    }
    else
    {
        <div class="no-content">
            <p>No sections available.</p>
        </div>
    }
</div>

@code {
    private IEnumerable<SectionDto>? sections;
    private string? errorMessage;

    protected override async Task OnInitializedAsync()
    {
        try
        {
            sections = await ApiClient.GetAllSectionsAsync();
        }
        catch (Exception ex)
        {
            errorMessage = $"Failed to load sections: {ex.Message}";
        }
    }
}

