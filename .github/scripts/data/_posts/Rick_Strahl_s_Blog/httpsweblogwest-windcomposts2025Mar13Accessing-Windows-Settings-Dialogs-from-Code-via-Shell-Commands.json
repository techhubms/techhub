{
  "Tags": [
    ".NET",
    "Windows"
  ],
  "OutputDir": "_posts",
  "FeedLevelAuthor": "Rick Strahl's Web Log",
  "ProcessedDate": "2025-08-05 14:25:42",
  "FeedUrl": "https://feeds.feedburner.com/rickstrahl",
  "Title": "Accessing Windows Settings Dialogs from Code via Shell Commands",
  "Description": "Windows has support for an `ms-setting:` Protocol Handler/Uri Scheme that allows you to directly open most Windows settings dialogs directly via simple Url based shell commands.",
  "Link": "https://weblog.west-wind.com/posts/2025/Mar/13/Accessing-Windows-Settings-Dialogs-from-Code-via-Shell-Commands",
  "FeedName": "Rick Strahl's Blog",
  "Author": "Rick Strahl",
  "EnhancedContent": "![](/images/HeroImages/RickHero7.jpg) ![](/images/rick175x175.jpg)\n\nhttps://twitter.com/rickstrahl https://feeds.feedburner.com/rickstrahl\n\n[Contact](https://west-wind.com/contact/)   • [Articles](https://west-wind.com/articles.aspx)   • [Products](https://store.west-wind.com)   • [Support](https://support.west-wind.com)   • [Advertise](https://weblog.west-wind.com/advertise)\n\nSponsored by:\n\n[!\\[\\](https://websurge.west-wind.com/images/WebSurgeLogo.png) **West Wind WebSurge**](https://websurge.west-wind.com?utm_campaign=westwind-weblog-sponsored)\n- Rest Client and Http Load Testing for Windows\nhttps://websurge.west-wind.com?utm_campaign=westwind-weblog-sponsored\n\n[advertise here](/advertise)\n\nShare on:\n\nhttps://twitter.com/intent/tweet?url=https://weblog.west-wind.com/posts/2025/Mar/13/Accessing-Windows-Settings-Dialogs-from-Code-via-Shell-Commands&amp;text=Accessing%20Windows%20Settings%20Dialogs%20from%20Code%20via%20Shell%20Commands&amp;via=RickStrahl https://www.facebook.com/sharer/sharer.php?u=https://weblog.west-wind.com/posts/2025/Mar/13/Accessing-Windows-Settings-Dialogs-from-Code-via-Shell-Commands&amp;t=Accessing%20Windows%20Settings%20Dialogs%20from%20Code%20via%20Shell%20Commands http://www.reddit.com/submit?url=https://weblog.west-wind.com/posts/2025/Mar/13/Accessing-Windows-Settings-Dialogs-from-Code-via-Shell-Commands&amp;title=Accessing%20Windows%20Settings%20Dialogs%20from%20Code%20via%20Shell%20Commands\n\nMarch 13, 2025 • from Maui, Hawaii\n\n:P\n\nOn this page:\n\n![Ms Settings Shell Commands](https://weblog.west-wind.com/images/2025/Accessing-Windows-Settings-Dialogs-from-Code-via-Shell-Commands/MsSettingsShellCommands.png)\n\nI was unaware of this: You can access Windows configuration dialogs via an `ms-settings:` shell command via command Uri that works with:\n\n- Shell Commands in your applications (`ShellExecute()`\nor `Process.Start()` )\n- `start`\n(command) and `start-process` (powershell) from a terminal\n- From within a browser\n\nCommands look like this:\n\n![Windows Settings Through Shell Commands](https://weblog.west-wind.com/images/2025/Accessing-Windows-Settings-Dialogs-from-Code-via-Shell-Commands/WindowsSettingsThroughShellCommands.png)\n\n**Figure 1** - You can directly access specific Windows Settings commands through `ms-settings:` shell commands\n\nWhat's nice is they pop up directly on the appropriate configuration setting. This is especially useful for application that require that certain feature or system functions are enabled.\n\n[!\\[\\](/images/sponsors/banner-example.png?v=1.2)](https://markdownmonster.west-wind.com?ut=weblog)\n\nFor example, here I'm prompting to allow for Microphone access, so the Speech Recognition features in Markdown Monster can be used to dictate text. If the app tries to start the audio system and it fails to load, I can then pop up the dialog to get the user to try and fix the permissions.\n\n```csharp try { await EnsureCompiledAsync(); _ = _recognizer.ContinuousRecognitionSession.StartAsync(); _isDictating = true; } catch (Exception ex) when (ex.Message.Contains(\"privacy\")) { ```` // Open the settings page for speech recognition Westwind.Utilities.ShellUtils.ShellExecute(\"ms-settings:privacy-speech\"); }\n\n```\n\nThere are a number of ways you can activate these handlers.\n\n## Terminal Activation\n\nFrom a PowerShell Terminal prompt:\n\n```ps\n# DOS tool (executable)\nstart \"ms-settings:privacy-speech\"\n\n# Powershell command\nstart-process \"ms-settings:privacy-speech\"\n\n```\n\nFrom Windows WSL terminal you can use:\n\n```bash explorer.exe ms-settings:privacy-speech\n\n```\n\n## Code Activation\n\nIn code you can use anything that supports shell commands which includes `ShellExecute()` and `Process.Start()` :\n\n```cs Process.Start(\"ms-settings:privacy-speech\");\n\nShellUtils.ShellExecute(\"ms-settings:privacy-speech\"); ShellUtils.GoUrl(\"ms-settings:privacy-speech\");\n\n```\n\nAll of these use the Windows `ShellExecute()` API which is the underlying tooling that runs these commands.\n\nYou can jump to most of the available Windows configuration settings directly and there's a list of the available links here:\n\n- [ms-settings Command Reference](https://learn.microsoft.com/en-us/windows/apps/develop/launch/launch-settings-app#ms-settings-uri-scheme-reference)\n\nIf you follow the links in that MS Article it also takes you to some other interesting Uri Scheme handlers that are built into windows and allow accessing many Windows features without having to explicitly launch executables.\n\n## Protocol Handler/Uri Scheme Shell Activation\n\nThe `ms-settings:` moniker is what's known as a **Protocol Handler** (Web lingo) or **Uri Scheme** (Windows lingo), which is a globally registered 'command handler' that is registered machine wide and triggered by the URL prefix through a shell command or a Url in the browser. The trigger prompts opening of the associated application - in this case it's the Windows Setting app, with the key taking you to the specific feature. You've seen this for other apps like Zoom or Teams, or even in custom applications like Markdown Monster which allow opening the editor from within a Web Browser.\n\nTo give you an idea how you can utilize this in your own application take a look at [how the Markdown Monster Desktop application integrates a Protocol Handler](https://markdownmonster.west-wind.com/docs/Recipes/Open-from-Browser-with-markdownmonster-Protocol-Handler.html) to open and interact with documents from a Web browser.\n\n[!\\[\\](/images/Sponsors/BearsBeer-Display.jpg)](https://goldenbeartshirts.com)\n\n## Summary\n\nThis is obviously not something that you use everyday, but it's pretty nice to have a simple solution to quickly jump to various system settings. Security in applications affects so many different aspects of applications and it's really useful to directly send your users to the exact configuration settings that need to be set.\n\n## Resources\n\n- [ms-settings Command Reference](https://learn.microsoft.com/en-us/windows/apps/develop/launch/launch-settings-app#ms-settings-uri-scheme-reference)\n\n### Other Posts you might also like\n\n- [Adding minimal OWIN Identity Authentication to an Existing ASP.NET MVC Application](https://weblog.west-wind.com/posts/2015/Apr/29/Adding-minimal-OWIN-Identity-Authentication-to-an-Existing-ASPNET-MVC-Application)\n- [Keeping Content Out of the Publish Folder for WebDeploy](https://weblog.west-wind.com/posts/2022/Aug/24/Keeping-Content-Out-of-the-Publish-Folder-for-WebDeploy)\n- [Using SQL Server on Windows ARM](https://weblog.west-wind.com/posts/2024/Oct/24/Using-Sql-Server-on-Windows-ARM)\n- [Map Physical Paths with an HttpContext.MapPath() Extension Method in ASP.NET](https://weblog.west-wind.com/posts/2023/Aug/15/Map-Physical-Paths-with-an-HttpContextMapPath-Extension-Method-in-ASPNET)\n\nShare on:\n\nhttps://twitter.com/intent/tweet?url=https://weblog.west-wind.com/posts/2025/Mar/13/Accessing-Windows-Settings-Dialogs-from-Code-via-Shell-Commands&amp;text=Accessing%20Windows%20Settings%20Dialogs%20from%20Code%20via%20Shell%20Commands&amp;via=RickStrahl\n\nhttps://www.facebook.com/sharer/sharer.php?u=https://weblog.west-wind.com/posts/2025/Mar/13/Accessing-Windows-Settings-Dialogs-from-Code-via-Shell-Commands&amp;t=Accessing%20Windows%20Settings%20Dialogs%20from%20Code%20via%20Shell%20Commands http://www.reddit.com/submit?url=https://weblog.west-wind.com/posts/2025/Mar/13/Accessing-Windows-Settings-Dialogs-from-Code-via-Shell-Commands&amp;title=Accessing%20Windows%20Settings%20Dialogs%20from%20Code%20via%20Shell%20Commands\n\n![Make Donation](/images/donation.png \"Find this content useful? Consider making a small donation.\")\n\nIs this content useful to you? **Consider making a small donation** to show your support.\n\nPosted in **[.NET](/ShowPosts.aspx?Category=.NET)  [Windows](/ShowPosts.aspx?Category=Windows)**",
  "PubDate": "2025-03-13T22:40:22+00:00"
}
