{
  "Tags": [
    "dotnet"
  ],
  "FeedUrl": "https://feeds.feedburner.com/rickstrahl",
  "EnhancedContent": "![](/images/HeroImages/RickHero2.jpg) ![](/images/rick175x175.jpg)\n\nhttps://twitter.com/rickstrahl https://feeds.feedburner.com/rickstrahl\n\n[Contact](https://west-wind.com/contact/) Â  â€¢ [Articles](https://west-wind.com/articles.aspx) Â  â€¢ [Products](https://store.west-wind.com) Â  â€¢ [Support](https://support.west-wind.com) Â  â€¢ [Advertise](https://weblog.west-wind.com/advertise)\n\nSponsored by:\n\n[!\\[\\](https://websurge.west-wind.com/images/WebSurgeLogo.png) **West Wind WebSurge**](https://websurge.west-wind.com?utm_campaign=westwind-weblog-sponsored)\n- Rest Client and Http Load Testing for Windows\nhttps://websurge.west-wind.com?utm_campaign=westwind-weblog-sponsored\n\n[advertise here](/advertise)\n\nShare on:\n\nhttps://twitter.com/intent/tweet?url=https://weblog.west-wind.com/posts/2025/Dec/08/What-the-heck-is-a-nul-path-and-why-is-it-breaking-my-Directory-Files-Lookup&amp;text=What%20the%20heck%20is%20a https://www.facebook.com/sharer/sharer.php?u=https://weblog.west-wind.com/posts/2025/Dec/08/What-the-heck-is-a-nul-path-and-why-is-it-breaking-my-Directory-Files-Lookup&amp;t=What%20the%20heck%20is%20a http://www.reddit.com/submit?url=https://weblog.west-wind.com/posts/2025/Dec/08/What-the-heck-is-a-nul-path-and-why-is-it-breaking-my-Directory-Files-Lookup&amp;title=What%20the%20heck%20is%20a\n\nToday @ 1:15pm â€¢ from Hood River, Oregon\n\n:P\n\nOn this page:\n\n![Null Device Banner](https://weblog.west-wind.com/images/2025/What-the-heck-is-a-nul-path-and-why-is-it-breaking-my-Directory-Files-Lookup/NullDeviceBanner.jpg)\n\nIn the last few months my [Markdown Monster](https://markdownmonster.west-wind.com) Application Insights log has been inundated with a hard failure for lookups of a `\\\\.\\nul` device error. In my logs this shows up as an error like this:\n\n![Null Device Error In Directory Listing](https://weblog.west-wind.com/images/2025/What-the-heck-is-a-nul-path-and-why-is-it-breaking-my-Directory-Files-Lookup/NullDeviceErrorInDirectoryListing.png)\n\n**Figure 1** - Null device errors in the Application Insight logs\n\nThis error started creeping up in my logs a few months ago, and since then has gotten more frequent. The error always occurs in the same location in the code and it's related to the File and Folder Browser in MM that displays the files available on the file system.\n\n![File And Folder Browser In Markdown Monster](https://weblog.west-wind.com/images/2025/What-the-heck-is-a-nul-path-and-why-is-it-breaking-my-Directory-Files-Lookup/FileAndFolderBrowserInMarkdownMonster.png)\n\n**Figure 2** - The File and Folder Browser in Markdown Monster that is the target of the error\n\nThis is a generic file browser, so it's very susceptible to all sorts of oddball user configurations and mis-configurations and this particular error likely is of the latter kind. However, after doing a bit of research this is not an uncommon error - there are a number of references to this although the cause of it doesn't appear to be very clear and can be related to various different things.\n\nIn my use case, the error itself is triggered by doing a `fileInfo.GetAttributes()` call on a file name that was returned by the `Directory.GetFiles()` lookup originally. The file is not a 'regular' file but rather a 'device' and so `GetAttributes()` throws an exception. And yeah that's **very unexpected**.\n\n[!\\[\\](/images/sponsors/banner-example.png?v=1.2)](https://markdownmonster.west-wind.com?ut=weblog)\n\nSpecifically the failure occurs here:\n\n```csharp // System.IO Exception: Incorrect Parameter \\\\.\\nul if (fileInfo.Attributes.HasFlag(FileAttributes.Hidden)) item.IsCut = true;\n\n```\n\nThis code sits inside of a loop that does a directory lookup then loops through all the files and adds them to the display tree model that eventually displays in the UI shown in **Figure 1**. The key is that the Attribute look up fails on this mystery 'null device' file.\n\nThis is doubly frustrating in that `Attributes` is an enumeration that apparently is dynamically evaluated **so the only way to detect the invalid state is to fail with an exception**. Bah ðŸ’©!\n\n## What the heck is `\\\\.\\nul`\n?\n\nMy first reaction to this error was, yeah some user is doing something very unusual - ignore it. And yes, the error is rare, but there appear to be a number of different users running into this issue (oddly all are Eurozone users - so might be some specific software or AV).\n\nI started looking into it more doing some LLM research.\n\nThe first response is what I pretty much got as a standard explanation of a null device:\n\n![Null Device Explanation](https://weblog.west-wind.com/images/2025/What-the-heck-is-a-nul-path-and-why-is-it-breaking-my-Directory-Files-Lookup/NullDeviceExplanation.png)\n\n**Figure 3** - Basic LLM definition of a null device in file context\n\nTurns out `nul` refers to a the Windows `nul` device, which as the name suggests is a device sink that doesn't do anything. Apparently, it's meant to be used to pipe or stream STDIN/OUT to oblivion. I'm not sure how that would ever end up in a directory listing unless it's mapped through some weird symlink redirection. While symlink mis-configuration is not hard to do in Windows, it's odd that several users would end up with the same nul device error misconfiguration.\n\nFurthermore it seems that Windows itself forbids creation of files or folders with the name of `nul` :\n\n![Nul Files Not Allowed In Windows](https://weblog.west-wind.com/images/2025/What-the-heck-is-a-nul-path-and-why-is-it-breaking-my-Directory-Files-Lookup/NulFilesNotAllowedInWindows.png)\n\n**Figure 4** - `nul` files and folders can't be created in Explorer or the Shell\n\nSo - it's still a mystery to me how a `\\\\.\\nul` entry can sneak into a directory file or folder listing.\n\nThe second prompt tries to unravel the file listing mystery, but the answer (similar for various other LLMs) is not very satisfying:\n\n![Null Files In Directory Listings](https://weblog.west-wind.com/images/2025/What-the-heck-is-a-nul-path-and-why-is-it-breaking-my-Directory-Files-Lookup/NullFilesInDirectoryListings.png)\n\n**Figure 5** -\n\nThe first point is unlikely since we've already seen that it's rather difficult or impossible to create file or folder with the name of `nul` .\n\nThe latter is more interesting: Some sort of mis-configured symlink reference. However, I couldn't find a scenario where a symlink would do this. Doing directory listings on folders that have symlinked embedded folders (like Dropbox, OneDrive etc.) seems to work fine and returns those linked folders the same as normal folders and you can get attributes on those (although they are often empty).\n\nBut I suppose it's possible that a symlink could have an invalid reference to a `nul` file name. I didn't try this as surely I would mess something up irreversibly (as I always seem to do when manually messing with symlinks on Windows).\n\n[!\\[\\](/images/sponsors/AmazonPrimeVisa-Display.jpg)](https://www.amazon.com/dp/BT00LN946S?externalReferenceId=fdeaac92-deca-4ea5-92c1-442cdc15a646)\n\n## Working around\n\nIn the end I was unable to troubleshoot the exact cause of the problem, but given what we know there are workarounds at least.\n\nSo far since implementing the first of the two solutions I haven't seen the errors pop up any more in newer versions. However, I still see the older version errors which suggest that the users having these issues haven't gotten updated to newer code yet.\n\nSo here are the two workarounds I've used for this:\n\n### Bobbing for Apples - eh Errors\n\nThis falls into the simplest thing possible bucket:\n\nMy original solution before I completely understood the problem was to simply check for failure on the code that was failing and defaulting the value. This is a pretty obvious band-aid solution and it works. I haven't seen this error crop up in versions since this simple fix was originally made.\n\n```csharp try { if (item.FileInfo.Attributes.HasFlag(FileAttributes.Hidden)) item.IsCut = true; } catch { // if we can't get attributes it's some device or map we shouldn't show item.IsCut = true; }\n\n```\n\nThe idea here is that if attributes cannot be retrieved the file cannot be a 'normal' file that should be displayed and we can safely omit rendering it.\n\nAlthough this works it's always a little unsatisfying to fix things in this band-aid manner. Specifically because it might crop up elsewhere again - completely forgotten then. ðŸ˜„\n\n### Filtered Directory Listings\n\nThe source of the problem really seems to be that the directory listing is retrieving device data in the first place.\n\nIt turns out the default `Directory.GetFiles()` filter mode is rather liberal in what it retrieves using the default `EnumerationOptions` instance:\n\n![File Info Get Attributes Default Enumeration Mode](https://weblog.west-wind.com/images/2025/What-the-heck-is-a-nul-path-and-why-is-it-breaking-my-Directory-Files-Lookup/FileInfoGetAttributesDefaultEnumerationMode.png)\n\n**Figure 6** - Default enumeration mode doesn't skip Devices\n\nIt only skips over hidden and system files, but allows everything else.\n\nThe `\\\\.\\nul` error is caused by a **Device** map of some sort so skipping over devices might be useful.\n\nSo, rather than using the default directory listing, we can use explicit `EnumerationOptions` and skip over devices, like this:\n\n```csharp string[] files = []; try { var opts = new EnumerationOptions { AttributesToSkip = FileAttributes.Hidden | FileAttributes.Directory | FileAttributes.Device | FileAttributes.ReparsePoint | FileAttributes.Temporary}; if (config.ShowAllFiles) opts.AttributesToSkip = FileAttributes.Directory | FileAttributes.Device | FileAttributes.ReparsePoint; files = Directory.Files(baseFolder, \"*.*\", opts); } catch { /* ignore */ }\n\nforeach(var file in files) { ... }\n\n```\n\nKeep in mind that this is for a widely used generic implementation so there's a extra safety built in here with the `try/catch` to protect against invalid user provided folder names etc. from throwing out of the app. In that scenario there's no file list returned.\n\nThe code above should prevent devices and reparse points - which are likely the cause of the `\\\\.\\nul` device errors I'm seeing in the log - to stop occurring as they are not being returned by the directory listing.\n\n[!\\[\\](/images/sponsors/BrokenMoney-Display.jpg)](https://amzn.to/3EaiBqi)\n\n## Summary\n\nSince implementing this fix the logs have been clean of the errors. Since I never had a repro scenario I can only go off my logs though so I can't be 100% certain that the problem is solved, but using both the directory skip filter plus the exception handling around the Attributes retrieval most definitely should fix this issue.\n\nTo be clear this is a huge edge case for a very generic file browser solution that's going to get all sorts of weird shit thrown at it from many different types of users from power users to your grandma's file systems. In more controlled situations you probably don't have to worry about edge cases like this.\n\nHowever, it's important to remember that there can be funky behaviors with filesystem behavior related to symlinks and remapped folders (like DropBox). For example, I just ran into an issue where `FileInfo.Exists` reports the Dropbox folder as non-existing where `Directory.GetDirectory()` does. IOW, symlinked files and folders can have odd behaviors and in those scenarios where you're dealing with symlinked file artifacts it might be a good idea to **explicitly** specify the file attributes to avoid unexpected failures that can't be easily handled with predictable logic.\n\n### Other Posts you might also like\n\n- [Runtime C# Code Compilation Revisited for Roslyn](https://weblog.west-wind.com/posts/2022/Jun/07/Runtime-C-Code-Compilation-Revisited-for-Roslyn)\n- [Discovering new C# String Pattern Matching Features](https://weblog.west-wind.com/posts/2021/Nov/04/Discovering-new-C-String-Pattern-Matching-Features)\n- [Async/Await Calls Gotcha with the CSharp ? Null Propagator](https://weblog.west-wind.com/posts/2021/May/15/AsyncAwait-Calls-Gotcha-with-the-CSharp-Null-Propagator)\n\nShare on:\n\nhttps://twitter.com/intent/tweet?url=https://weblog.west-wind.com/posts/2025/Dec/08/What-the-heck-is-a-nul-path-and-why-is-it-breaking-my-Directory-Files-Lookup&amp;text=What%20the%20heck%20is%20a\n\nhttps://www.facebook.com/sharer/sharer.php?u=https://weblog.west-wind.com/posts/2025/Dec/08/What-the-heck-is-a-nul-path-and-why-is-it-breaking-my-Directory-Files-Lookup&amp;t=What%20the%20heck%20is%20a http://www.reddit.com/submit?url=https://weblog.west-wind.com/posts/2025/Dec/08/What-the-heck-is-a-nul-path-and-why-is-it-breaking-my-Directory-Files-Lookup&amp;title=What%20the%20heck%20is%20a\n\n![Make Donation](/images/donation.png \"Find this content useful? Consider making a small donation.\")\n\nIs this content useful to you? **Consider making a small donation** to show your support.\n\nPosted in **[dotnet](/ShowPosts.aspx?Category=dotnet)**",
  "OutputDir": "_posts",
  "FeedName": "Rick Strahl's Blog",
  "Link": "https://weblog.west-wind.com/posts/2025/Dec/08/What-the-heck-is-a-nul-path-and-why-is-it-breaking-my-Directory-Files-Lookup",
  "PubDate": "2025-12-08T23:15:18+00:00",
  "FeedLevelAuthor": "Rick Strahl's Web Log",
  "Description": "![Null Device Banner](https://weblog.west-wind.com/images/2025/What-the-heck-is-a-nul-path-and-why-is-it-breaking-my-Directory-Files-Lookup/NullDeviceBanner.jpg)\n\nIn the last few months my [Markdown Monster](https://markdownmonster.west-wind.com) Application Insights log has been inundated with a hard failure for lookups of a `\\\\.\\nul` device error. In my logs this shows up as an error like this:\n\n![Null Device Error In Directory Listing](https://weblog.west-wind.com/images/2025/What-the-heck-is-a-nul-path-and-why-is-it-breaking-my-Directory-Files-Lookup/NullDeviceErrorInDirectoryListing.png)\n\n**Figure 1** - Null device errors in the Application Insight logs\n\nThis error started creeping up in my logs a few months ago, and since then has gotten more frequent. The error always occurs in the same location in the code and it's related to the File and Folder Browser in MM that displays the files available on the file system.\n\n![File And Folder Browser In Markdown Monster](https://weblog.west-wind.com/images/2025/What-the-heck-is-a-nul-path-and-why-is-it-breaking-my-Directory-Files-Lookup/FileAndFolderBrowserInMarkdownMonster.png)\n\n**Figure 2** - The File and Folder Browser in Markdown Monster that is the target of the error\n\nThis is a generic file browser, so it's very susceptible to all sorts of oddball user configurations and mis-configurations and this particular error likely is of the latter kind. However, after doing a bit of research this is not an uncommon error - there are a number of references to this although the cause of it doesn't appear to be very clear and can be related to various different things.\n\nIn my use case, the error itself is triggered by doing a `fileInfo.GetAttributes()` call on a file name that was returned by the `Directory.GetFiles()` lookup originally. The file is not a 'regular' file but rather a 'device' and so `GetAttributes()` throws an exception. And yeah that's **very unexpected**.\n\n[!\\[\\](/images/sponsors/banner-example.png?v=1.2)](https://markdownmonster.west-wind.com?ut=weblog)\n\nSpecifically the failure occurs here:\n\n```csharp // System.IO Exception: Incorrect Parameter \\\\.\\nul if (fileInfo.Attributes.HasFlag(FileAttributes.Hidden)) item.IsCut = true;\n\n```\n\nThis code sits inside of a loop that does a directory lookup then loops through all the files and adds them to the display tree model that eventually displays in the UI shown in **Figure 1**. The key is that the Attribute look up fails on this mystery 'null device' file.\n\nThis is doubly frustrating in that `Attributes` is an enumeration that apparently is dynamically evaluated **so the only way to detect the invalid state is to fail with an exception**. Bah ðŸ’©!\n\n## What the heck is `\\\\.\\nul`\n?\n\nMy first reaction to this error was, yeah some user is doing something very unusual - ignore it. And yes, the error is rare, but there appear to be a number of different users running into this issue (oddly all are Eurozone users - so might be some specific software or AV).\n\nI started looking into it more doing some LLM research.\n\nThe first response is what I pretty much got as a standard explanation of a null device:\n\n![Null Device Explanation](https://weblog.west-wind.com/images/2025/What-the-heck-is-a-nul-path-and-why-is-it-breaking-my-Directory-Files-Lookup/NullDeviceExplanation.png)\n\n**Figure 3** - Basic LLM definition of a null device in file context\n\nTurns out `nul` refers to a the Windows `nul` device, which as the name suggests is a device sink that doesn't do anything. Apparently, it's meant to be used to pipe or stream STDIN/OUT to oblivion. I'm not sure how that would ever end up in a directory listing unless it's mapped through some weird symlink redirection. While symlink mis-configuration is not hard to do in Windows, it's odd that several users would end up with the same nul device error misconfiguration.\n\nFurthermore it seems that Windows itself forbids creation of files or folders with the name of `nul` :\n\n![Nul Files Not Allowed In Windows](https://weblog.west-wind.com/images/2025/What-the-heck-is-a-nul-path-and-why-is-it-breaking-my-Directory-Files-Lookup/NulFilesNotAllowedInWindows.png)\n\n**Figure 4** - `nul` files and folders can't be created in Explorer or the Shell\n\nSo - it's still a mystery to me how a `\\\\.\\nul` entry can sneak into a directory file or folder listing.\n\nThe second prompt tries to unravel the file listing mystery, but the answer (similar for various other LLMs) is not very satisfying:\n\n![Null Files In Directory Listings](https://weblog.west-wind.com/images/2025/What-the-heck-is-a-nul-path-and-why-is-it-breaking-my-Directory-Files-Lookup/NullFilesInDirectoryListings.png)\n\n**Figure 5** -\n\nThe first point is unlikely since we've already seen that it's rather difficult or impossible to create file or folder with the name of `nul` .\n\nThe latter is more interesting: Some sort of mis-configured symlink reference. However, I couldn't find a scenario where a symlink would do this. Doing directory listings on folders that have symlinked embedded folders (like Dropbox, OneDrive etc.) seems to work fine and returns those linked folders the same as normal folders and you can get attributes on those (although they are often empty).\n\nBut I suppose it's possible that a symlink could have an invalid reference to a `nul` file name. I didn't try this as surely I would mess something up irreversibly (as I always seem to do when manually messing with symlinks on Windows).\n\n## Working around\n\nIn the end I was unable to troubleshoot the exact cause of the problem, but given what we know there are workarounds at least.\n\nSo far since implementing the first of the two solutions I haven't seen the errors pop up any more in newer versions. However, I still see the older version errors which suggest that the users having these issues haven't gotten updated to newer code yet.\n\nSo here are the two workarounds I've used for this:\n\n### Bobbing for Apples - eh Errors\n\nThis falls into the simplest thing possible bucket:\n\nMy original solution before I completely understood the problem was to simply check for failure on the code that was failing and defaulting the value. This is a pretty obvious band-aid solution and it works. I haven't seen this error crop up in versions since this simple fix was originally made.\n\n```csharp try { if (item.FileInfo.Attributes.HasFlag(FileAttributes.Hidden)) item.IsCut = true; } catch { // if we can't get attributes it's some device or map we shouldn't show item.IsCut = true; }\n\n```\n\nThe idea here is that if attributes cannot be retrieved the file cannot be a 'normal' file that should be displayed and we can safely omit rendering it.\n\nAlthough this works it's always a little unsatisfying to fix things in this band-aid manner. Specifically because it might crop up elsewhere again - completely forgotten then. ðŸ˜„\n\n### Filtered Directory Listings\n\nThe source of the problem really seems to be that the directory listing is retrieving device data in the first place.\n\nIt turns out the default `Directory.GetFiles()` filter mode is rather liberal in what it retrieves using the default `EnumerationOptions` instance:\n\n![File Info Get Attributes Default Enumeration Mode](https://weblog.west-wind.com/images/2025/What-the-heck-is-a-nul-path-and-why-is-it-breaking-my-Directory-Files-Lookup/FileInfoGetAttributesDefaultEnumerationMode.png)\n\n**Figure 6** - Default enumeration mode doesn't skip Devices\n\nIt only skips over hidden and system files, but allows everything else.\n\nThe `\\\\.\\nul` error is caused by a **Device** map of some sort so skipping over devices might be useful.\n\nSo, rather than using the default directory listing, we can use explicit `EnumerationOptions` and skip over devices, like this:\n\n```csharp string[] files = []; try { var opts = new EnumerationOptions { AttributesToSkip = FileAttributes.Hidden | FileAttributes.Directory | FileAttributes.Device | FileAttributes.ReparsePoint | FileAttributes.Temporary}; if (config.ShowAllFiles) opts.AttributesToSkip = FileAttributes.Directory | FileAttributes.Device | FileAttributes.ReparsePoint; files = Directory.Files(baseFolder, \"*.*\", opts); } catch { /* ignore */ }\n\nforeach(var file in files) { ... }\n\n```\n\nKeep in mind that this is for a widely used generic implementation so there's a extra safety built in here with the `try/catch` to protect against invalid user provided folder names etc. from throwing out of the app. In that scenario there's no file list returned.\n\nThe code above should prevent devices and reparse points - which are likely the cause of the `\\\\.\\nul` device errors I'm seeing in the log - to stop occurring as they are not being returned by the directory listing.\n\n## Summary\n\nSince implementing this fix the logs have been clean of the errors. Since I never had a repro scenario I can only go off my logs though so I can't be 100% certain that the problem is solved, but using both the directory skip filter plus the exception handling around the Attributes retrieval most definitely should fix this issue.\n\nTo be clear this is a huge edge case for a very generic file browser solution that's going to get all sorts of weird shit thrown at it from many different types of users from power users to your grandma's file systems. In more controlled situations you probably don't have to worry about edge cases like this.\n\nHowever, it's important to remember that there can be funky behaviors with filesystem behavior related to symlinks and remapped folders (like DropBox). For example, I just ran into an issue where `FileInfo.Exists` reports the Dropbox folder as non-existing where `Directory.GetDirectory()` does. IOW, symlinked files and folders can have odd behaviors and in those scenarios where you're dealing with symlinked file artifacts it might be a good idea to **explicitly** specify the file attributes to avoid unexpected failures that can't be easily handled with predictable logic.\n\nÂ© Rick Strahl, West Wind Technologies, 2005-2025\n\nPosted in **[dotnet](/ShowPosts.aspx?Category=dotnet)**",
  "Title": "What the heck is a `\\\\.\\nul` path and why is it breaking my Directory Files Lookup?",
  "ProcessedDate": "2025-12-09 01:32:50",
  "Author": "Rick Strahl"
}
