{
  "Title": "Improved Git Workflow Custom Prompt & Upcoming VS Code change warning",
  "FeedName": "Reinier van Maanen's blog",
  "OutputDir": "_posts",
  "Tags": [
    "AI",
    "Automation",
    "Configuration",
    "Custom Prompts",
    "Developer Tools",
    "Git",
    "GitHub Copilot",
    "Terminal",
    "Updates",
    "Version Control",
    "Visual Studio Code",
    "Workflow"
  ],
  "ProcessedDate": "2025-08-05 17:16:16",
  "Description": "Updates to my Git workflow custom prompt and important changes coming to VS Code terminal auto-approval",
  "Author": "Reinier van Maanen",
  "Link": "https://r-vm.com/improved-git-workflow-custom-prompt-upcoming-vscode-change-warning.html",
  "PubDate": "2025-07-25T00:00:00+00:00",
  "EnhancedContent": "Following up on [my previous post](/automating-my-git-workflow-vscode-copilot-chat-terminal-auto-approval.html) about automating Git workflows with VS Code and GitHub Copilot Chat, I’ve made some improvements to my custom prompt and discovered an important upcoming change in VS Code that affects the terminal auto-approval feature.\n\n## Index\n\n- What’s Changed\n- Improved Custom Prompt\n- Upcoming VS Code Changes\n- What You Need to Do\n- References\n\n## What’s Changed\n\nSince my last post about automating Git workflows, two important developments have occurred:\n\n1. **Custom Prompt Improvements:** I’ve refined my `/pushall`\nprompt based on real-world usage, adding better error handling, smarter commit message generation by AI, enhanced safety checks, new terminal UI and switched to PowerShell for the scripts.\n2. **Breaking VS Code Changes:** Microsoft has made significant changes to the terminal auto-approval configuration that will require updating your settings. These changes are already merged and will likely be part of VS Code v1.103 ([July 2025 release](https://github.com/microsoft/vscode/milestone/319), shipped in August 2025).\n\nThe good news is that the changes from Microsoft improve the functionality by consolidating the configuration and adding regex flag support. However, you’ll need to update your settings to avoid any disruption to your workflow.\n\n## Improved Custom Prompt\n\nAfter using the `/pushall` command for a while, I learned what worked and what didn’t. So I rewrote it. The original was 175 lines, the new one is 226 lines. Not exactly a revolution, but it handles real-world scenarios much better.\n\n### Better Terminal Experience\n\nBecause I had the most fun creating this, let me start off by how the new terminal output looks like. Btw, it’s fully responsive if you resize :)\n\n![Enhanced terminal UI with progress bars and responsive layout. Wide view.](/assets/pushall/wide-terminal.png)\n\nThe PowerShell scripts look nicer and handle window resizing properly.\n\n![Enhanced terminal UI with progress bars and responsive layout. Small view.](/assets/pushall/small-terminal.png)\n\nThe same terminal but then resized.\n\n### Actual files\n\nThis rest of this post provides a high-level overview of the improvements. The complete updated files are available for download:\n\n- [pushall.prompt.txt (rename to md)](/assets/pushall/pushall.prompt.txt) - The main workflow prompt\n- [pushall-delay.ps1](/assets/pushall/pushall-delay.ps1) - Enhanced user confirmation script\n- [get-git-changes.ps1](/assets/pushall/get-git-changes.ps1) - Git analysis script\n\nIf you want to use this, make sure you at least have the GitHub MCP server configured. Also, I haven’t tested this outside my own environment, so please mention any bugs to me and I’ll try to fix them for everyone!\n\n### Tips\n\nFirst off, a small tip. If you know what you want to do, you can just still use the prompt and just give some additional instructions:\n\n``` /pushall skip the approval steps, make a new branch, move my changes there, create a PR and assign to Copilot\n\n```\n\nResults in:\n\n``` I'll follow the pushall workflow instructions and skip the approval steps as requested. Let me start by checking the current branch and changes.\n\n```\n\nThis just very quickly performs this entire workflow without any interruptions.\n\n### Comparison Table\n\n| What | Before | After | | --- | --- | --- | | **Branch Handling** | Any branch (risky) | Main branch protection | | **Change Analysis** | Simple `git --no-pager diff` | PowerShell script with JSON output and structured metadata | | **Pull Request Integration** | No PR functionality | PR creation, updates, and Copilot reviews | | **User Experience** | Single 10-second delay with basic output | Multiple confirmation points with enhanced UI | | **Automation** | Required manual intervention | Intelligent defaults for unattended operation | | **Terminal UI** | Simple text-based output | Responsive, colored design with progress bars | | **Script Architecture** | Single Python script | Two specialized PowerShell scripts working together | | **Workflow Complexity** | 4 simple steps | 14 detailed steps | | **Conflict Resolution** | Basic instructions | Enhanced guidance |\n\n### Details\n\n#### 1. **Branch Protection**\n\n- **Old:** Worked on any branch (dangerous on main)\n- **New:** Automatically detects main branch and shows 10-second delay asking to create feature branch with suggested name, or lets user abort to choose different approach\n\n#### 2. **Improved Change Analysis**\n\n- **Old:** Basic `git --no-pager diff`\noutput analyzed by AI\n- **New:** Dedicated PowerShell script creates comprehensive analysis in `.tmp/git-changes-analysis/`\nwith JSON metadata file containing status summary, branch info, unpushed commits, remote changes detection, and individual `.diff` files for each changed file with exact file paths\n\n#### 3. **Pull Request Integration**\n\n- **Old:** No PR functionality\n- **New:** Full GitHub MCP integration with dedicated tools for creating PRs, updating existing ones, checking reviews, and requesting Copilot code reviews through structured API calls\n\n#### 4. **Better User Experience**\n\n- **Old:** Single 10-second delay with basic terminal output\n- **New:** Multiple confirmation points using enhanced PowerShell script with responsive UI, colored output, progress bars, and interactive controls (SPACE to abort, ENTER to continue immediately)\n\n#### 5. **Intelligent Defaults for Unattended Operation**\n\n- **Old:** Required manual confirmation at every step, blocking automation\n- **New:** Smart defaults allow completely unattended operation - automatically creates feature branches from main, proceeds with commits when on correct branch, handles remote changes detection, all without user intervention when confident about changes\n\n#### 6. **Enhanced Terminal UI**\n\n- **Old:** Simple text-based output with basic messaging\n- **New:** Responsive terminal design with dynamic window resizing, colored headers, bordered message boxes, progress bars with percentages, and real-time countdown timers that adapt to terminal width\n\n#### 7. **Better Script Architecture**\n\n- **Old:** Single Python delay script (`pushall.10-second-delay.py`\n)\n- **New:** Two specialized PowerShell scripts: `get-git-changes.ps1`\nfor comprehensive git analysis with structured JSON output, and `pushall-delay.ps1` for flexible user confirmations with message files and customizable delays\n\n#### 8. **Enhanced Workflow Complexity**\n\n- **Old:** Simple 4-step workflow with basic instructions\n- **New:** Comprehensive 14-step workflow with CRITICAL instruction blocks, explicit command usage guidelines separating Git/PowerShell from GitHub MCP operations, structured commit message generation from JSON analysis, and built-in error handling\n\n#### 9. **Improved Conflict Resolution**\n\n- **Old:** Basic instructions for handling conflicts\n- **New:** Enhanced guidance with automatic remote changes detection during fetch operations, structured conflict resolution steps, and clear separation between local Git operations and GitHub API calls\n\n### VS Code Terminal Allow List\n\nThe following should be enough in your allowList to automatically have the prompt perform anything it needs to do. Except authorize the MCP actions, but you can do things like ‘Always allow in this workspace’ for that if you want.\n\n``` \"github.copilot.chat.agent.terminal.allowList\": { \"git\": true, \"pwsh\": true }\n\n```\n\n### To be clear, the usage has not changed\n\nYou still just call /pushall and things (should) work:\n\n![Custom Prompts in VS Code](/assets/auto-approve-terminal-commands/slashcommand.png)\n\nStarting with /pushall command\n\n## Upcoming VS Code Changes\n\n⚠️ **Important Breaking Change Alert!** ⚠️\n\nMicrosoft has merged and planned three significant changes to the terminal auto-approval feature that will affect your current configuration.\n\n### Configuration Consolidation\n\nThe biggest change is that the separate `allowList` and `denyList` settings have been **merged into a single `autoApprove` setting**. This means your current configuration will need to be updated.\n\n**Before (current configuration):**\n\n``` \"github.copilot.chat.agent.terminal.allowList\": { \"git\": true, \"echo\": true, \"ls\": true }, \"github.copilot.chat.agent.terminal.denyList\": { \"rm\": true, \"curl\": true, \"wget\": true }\n\n```\n\n**After (new configuration):**\n\n``` \"github.copilot.chat.agent.terminal.autoApprove\": { \"git\": true, \"echo\": true, \"ls\": true, \"rm\": false, \"curl\": false, \"wget\": false }\n\n```\n\n### Configuration name change\n\nIn addition to consolidating the settings, Microsoft is also planning to change the setting names entirely, according to [VS Code issue #253314](https://github.com/microsoft/vscode/issues/253314). This means the final configuration names will likely be: `chat.agent.terminal.autoApprove` :\n\n``` \"chat.agent.terminal.autoApprove\": { \"git\": true, \"echo\": true, \"ls\": true, \"rm\": false, \"curl\": false, \"wget\": false }\n\n```\n\nThese changes are part of a larger effort tracked in [issue #252650](https://github.com/microsoft/vscode/issues/252650) to move the entire terminal auto-approval functionality from the GitHub Copilot extension into VS Code core. This means you might need to update your configuration again when this migration is complete.\n\n### Enhanced Regex Support\n\nThe third improvement adds support for **regex flags and case-insensitive matching**:\n\n- **Regex flags:** You can now use JavaScript regex flags like `i`\n(case-insensitive), `m` (multiline), `s` (dotall), etc.\n- **Case-insensitive matching:** Perfect for PowerShell commands that might have different casing\n- **Better PowerShell support:** Default configuration now includes `/^Remove-Item\\\\b/i`\ninstead of just `Remove-Item`\n\n**Examples of new regex capabilities:**\n\n``` \"chat.agent.terminal.autoApprove\": { \"/^git\\\\s+/i\": true, // Case-insensitive git commands \"/^Get-ChildItem\\\\b/i\": true, // Case-insensitive PowerShell \"/^echo.*/s\": true, // Dotall flag for multiline \"rm\": false, // Simple string matching \"/dangerous/i\": false // Case-insensitive deny pattern }\n\n```\n\n## What You Need to Do\n\n### 1. Update Your Settings Configuration\n\nIf you’re using my previous Git workflow setup, you’ll need to migrate your settings before the next VS Code update, which should be as easy as merging the lists, changing the configuration entry name and setting false for the commands that should not be automatically approved.\n\n### 2. Take Advantage of New Features\n\nWith the enhanced regex support, you can now:\n\n- **Use case-insensitive patterns** for PowerShell commands: `/^Get-ChildItem\\\\b/i`\n- **Create more flexible git patterns**: `/^git\\\\s+(status|log|show|diff)\\\\b/i`\n- **Handle command variations**: `/^(echo|print|printf)\\\\b/i`\n\nUse this to simplify the configuration.\n\n### 3. Timeline\n\nThese changes are already merged and will likely be included in the **July 2025 release** of VS Code (v1.103), which will be shipped in **August 2025**. Only when you update to this version will the old configuration stop working.\n\n## References\n\n- [Previous post: Automating my Git workflow in VS Code](/automating-my-git-workflow-vscode-copilot-chat-terminal-auto-approval.html)\n- [VS Code Issue #252650: Move terminal auto approval from Copilot extension to core](https://github.com/microsoft/vscode/issues/252650)\n- [VS Code Issue #253314: Change github.copilot.chat.agent.terminal.allowList to chat.agent.terminal.allowList](https://github.com/microsoft/vscode/issues/253314)\n- [VS Code Issue #253472: Terminal auto approval - merge allow and deny list](https://github.com/microsoft/vscode/issues/253472)\n- [VS Code Issue #256742: Terminal auto approval - support regex flags and case insensitive remove-item](https://github.com/microsoft/vscode/issues/256742)\n- [VS Code PR #256725: Merge allow and deny lists into autoApprove](https://github.com/microsoft/vscode/pull/256725)\n- [VS Code PR #256754: Support regex flags and case insensitive remove-item](https://github.com/microsoft/vscode/pull/256754)\n- [VS Code v1.102 Release Notes](https://code.visualstudio.com/updates/v1_102#_terminal-auto-approval-experimental)\n- [VS Code July 2025 Milestone](https://github.com/microsoft/vscode/milestone/319)\n- [Customize Copilot with Instructions and Prompts](https://code.visualstudio.com/docs/copilot/copilot-customization)\n\n*This article was co-written with GitHub Copilot Chat*\n\n/improved-git-workflow-custom-prompt-upcoming-vscode-change-warning.html",
  "FeedLevelAuthor": "Reinier van Maanen",
  "FeedUrl": "https://r-vm.com/feed.xml"
}
