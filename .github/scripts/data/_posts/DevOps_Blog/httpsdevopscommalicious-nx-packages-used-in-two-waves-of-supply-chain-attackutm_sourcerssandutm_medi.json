{
  "Title": "Malicious Nx Packages Used in Two Waves of Supply Chain Attack",
  "Description": "![supply chain, security,](https://devops.com/wp-content/uploads/2015/04/supplychain.jpg)\n\n![supply chain, security,](https://devops.com/wp-content/uploads/2015/04/supplychain-150x150.jpg)The Nx build system was hit by a supply chain attack dubbed “s1ngularity,” leaking thousands of secrets and exploiting AI tools for data theft.",
  "OutputDir": "_posts",
  "FeedLevelAuthor": "DevOps.com",
  "Link": "https://devops.com/malicious-nx-packages-used-in-two-waves-of-supply-chain-attack/?utm_source=rss&utm_medium=rss&utm_campaign=malicious-nx-packages-used-in-two-waves-of-supply-chain-attack",
  "FeedName": "DevOps Blog",
  "FeedUrl": "https://devops.com/feed/",
  "Author": "Jeff Burt",
  "EnhancedContent": "[![](https://devops.com/wp-content/uploads/2025/02/cropped-devops-logo.png)](https://devops.com/)\n\n# Sign up for our newsletter! Stay informed on the latest DevOps news\n\nMalicious Nx Packages Used in Two Waves of Supply Chain Attack\n\nAt least one bad actor is targeted the Nx build system package in a [supply chain attack](https://securityboulevard.com/2025/03/why-supply-chain-attacks-are-the-biggest-threat-to-businesses-2/) this week, in which they stole a Nx NPM token that allowed them to publish malicious versions of the package to the registry and steal credentials and other data.\n\nThe maintainers of the Nx this week [alerted users to the attack](https://github.com/nrwl/nx/security/advisories/GHSA-cxm3-wv7p-598c), writing that “malicious versions of the [Nx package](https://www.npmjs.com/package/nx), as well as some supporting plugin packages, were published to npm, containing code that scans the file system, collects credentials, and posts them to GitHub as a repo under user’s accounts.”\n\nAt the center of the attack – which was named “s1ngularity” – was the introduction of a vulnerable workflow on August 21, according to the alert. The workflow enabled an attacker to inject executable code. They said the vulnerability was reverted to the master branch almost immediately after it was determined to be malicious, but the move wasn’t enough. The bad actor was able to make a pull request that targeted an outdated branch that included the vulnerable workflow. It was through that branch that the attack was launched.\n\nA day after the vulnerable workflow was introduced, the Nx team saw a post on X (formerly Twitter) that noted the workflow contained an injection exploit, and they reverted it. However, the flaw was still exploited on August 24, and moves were made over two days to fix the issues and shore up protections.\n\n## A Second Wave of Attack\n\nHowever, security researchers with cybersecurity firms Wiz and StepSecurity – pointing to alerts from security researchers Brian Kohan and Adnan Khan – wrote on August 28 about a [second wave of attack](https://www.stepsecurity.io/blog/supply-chain-security-alert-popular-nx-build-system-package-compromised-with-data-stealing-malware) from Nx leaked credentials. In an [update to a blog](https://www.wiz.io/blog/s1ngularity-supply-chain-attack), the Wiz researchers wrote that an attacker – whether the same or another one – “appears to be using the previously compromised GitHub tokens to turn private repositories public and rename them to the pattern s1ngularity-repository-#5letters#.”\n\nNx is an open source and technology-agnostic build platform that developers use to manage codebases at scale. It’s a popular package in NPM, with more than 3.5 million downloads every week.\n\n[![Techstrong Gang Youtube](https://securityboulevard.com/wp-content/uploads/2024/12/Techstrong-Gang-Youtube-PodcastV2-770.png)](https://youtu.be/Fojn5NFwaw8)\n\n[![Techstrong Gang Youtube](https://devops.com/wp-content/uploads/2025/03/770X330-DevOps-AppDev-Mar2025D.jpg)](https://info.futurumgroup.com/devops_appdev?utm_source=referral&utm_medium=in-article&utm_campaign=DevOps-Application-Report)\n\n[![Techstrong Gang Youtube](https://devops.com/wp-content/uploads/2025/03/770X330-DevOps-AppDev-Mar2025-2D.jpg)](https://info.futurumgroup.com/devops_appdev?utm_source=referral&utm_medium=in-article&utm_campaign=DevOps-Application-Report)\n\n## An Outdated Branch\n\nAccording to the Nx maintainers, the day after the vulnerable workflow was reverted, they saw that a pull request (PR) was made on a fork of the *nrwl/nx* repository targeting the outdated branch and stealing a GITHUB\\_TOKEN with read/write repository permissions.\n\n“Retroactively (we were not aware of this event until later), from our Github audit logs, we saw a PR was created from a fork to the *nrwl/nx* repo with the malicious commit which triggers the PR validation workflow with a PR title which injects and executes malicious code,” they wrote on GitHub, adding that the pull request has been deleted.\n\nAlso from their GitHub audit logs, they saw a different workflow – *publish.yml* – believing “this *publish.yml* workflow was triggered by the PR validation workflow stemming from the PR creation.”\n\nThey called *publish.yml* their “most permissive pipeline. It is responsible for publishing the Nx packages and therefore has access to the npm token via a GitHub Secret.” They ensured that within the pipeline, only their team could use it. However, with the elevated permissions from the pull request validation workflow, the *publish.yml* workflow was used to run on the *nrwl/nx* repository.\n\nEight malicious Nx packages, August 26 and later, with all of the NPM tokens that had permissions to publish being revoked. Soon after, all NPM packages under Nx were set to require two-factor authentication and could no longer be published with NPM tokens, with the maintainers adding that “all NPM packages have also been changed to use the new Trusted Publisher mechanism, which does not utilize NPM tokens.”\n\n## Attack Methods are Evolving\n\nGitGuardian researchers wrote that “this supply chain attack combines credential theft, environmental sabotage, and novel attack vectors, offering a glimpse into future threats. The malicious Nx packages systematically scanned infected systems for valuable credentials, including GitHub tokens, npm authentication keys, SSH private keys, environment variable API keys, and cryptocurrency wallet files.”\n\nThe scanning function searched common file locations and environment variables, showing what they called a “comprehensive approach to credential harvesting” used to enable lateral movement. The stolen credentials were then posted to public GitHub repositories with the “s1ngularity-repository” name. They used a double-base64 encoding process that the researchers wrote suggested an effort to evade detection.\n\n“One particularly novel element was the attempt to leverage LLM (Large Language Model) clients as vectors for enumerating secrets on victims’ machines,” they wrote. “The attackers specifically targeted configuration files and authentication tokens related to popular AI CLI tools like Claude, Gemini, and Q, recognizing that these tools often require elevated permissions and access to sensitive development environments.”\n\n## Thousands of Secrets Leaked\n\nGitGuardian said they detected 1,346 repositories in the s1ngularity attack and 2,349 secrets were leaked, with the bulk being GitHub OAuth keys and personal access tokens. Others included Google AI, Amazon Web Services, OpenAI, and Anthropic’s Claude.\n\nWiz researchers said 90% of the more than 1,000 GitHub tokens that were leaked are still valid.\n\nThey noted that in the second wave – which appears to be suspended, they wrote today – more than 400 users and organizations were and more than 5,500 repositories were published.\n\n“In a second phase, an attacker used the leaked GitHub tokens from phase one to make victim’s private repositories public,” they wrote. “These changes appeared to be driven by a single-threaded automation, running between August 28 and 29.”\n\n## A Sophisticated Supply Chain Attack\n\nResearchers with StepSecurity echoed GitGuardian’s statements about the changing nature of supply-chain attacks represented by the s1ngularity incident.\n\n“Given the popularity of the Nx ecosystem, and the novelty of AI tool abuse, this incident highlights the evolving sophistication of supply chain attacks,” they wrote. “The malware did more than just steal SSH keys, npm tokens, and .gitconfig files – it weaponized AI CLI tools (including Claude, Gemini, and q) to aid in reconnaissance and data exfiltration. This marks the first known case where attackers have turned developer AI assistants into tools for supply chain exploitation.”\n\nhttps://www.addtoany.com/add_to/x?linkurl=https%3A%2F%2Fdevops.com%2Fmalicious-nx-packages-used-in-two-waves-of-supply-chain-attack%2F&amp;linkname=Malicious%20Nx%20Packages%20Used%20in%20Two%20Waves%20of%20Supply%20Chain%20Attackhttps://www.addtoany.com/add_to/linkedin?linkurl=https%3A%2F%2Fdevops.com%2Fmalicious-nx-packages-used-in-two-waves-of-supply-chain-attack%2F&amp;linkname=Malicious%20Nx%20Packages%20Used%20in%20Two%20Waves%20of%20Supply%20Chain%20Attackhttps://www.addtoany.com/add_to/facebook?linkurl=https%3A%2F%2Fdevops.com%2Fmalicious-nx-packages-used-in-two-waves-of-supply-chain-attack%2F&amp;linkname=Malicious%20Nx%20Packages%20Used%20in%20Two%20Waves%20of%20Supply%20Chain%20Attackhttps://www.addtoany.com/add_to/reddit?linkurl=https%3A%2F%2Fdevops.com%2Fmalicious-nx-packages-used-in-two-waves-of-supply-chain-attack%2F&amp;linkname=Malicious%20Nx%20Packages%20Used%20in%20Two%20Waves%20of%20Supply%20Chain%20Attackhttps://www.addtoany.com/add_to/email?linkurl=https%3A%2F%2Fdevops.com%2Fmalicious-nx-packages-used-in-two-waves-of-supply-chain-attack%2F&amp;linkname=Malicious%20Nx%20Packages%20Used%20in%20Two%20Waves%20of%20Supply%20Chain%20Attackhttps://www.addtoany.com/share\n\nhttps://www.addtoany.com/add_to/x?linkurl=https%3A%2F%2Fdevops.com%2Fmalicious-nx-packages-used-in-two-waves-of-supply-chain-attack%2F%3Futm_source%3Drss%26utm_medium%3Drss%26utm_campaign%3Dmalicious-nx-packages-used-in-two-waves-of-supply-chain-attack&amp;linkname=Malicious%20Nx%20Packages%20Used%20in%20Two%20Waves%20of%20Supply%20Chain%20Attack%20-%20DevOps.comhttps://www.addtoany.com/add_to/linkedin?linkurl=https%3A%2F%2Fdevops.com%2Fmalicious-nx-packages-used-in-two-waves-of-supply-chain-attack%2F%3Futm_source%3Drss%26utm_medium%3Drss%26utm_campaign%3Dmalicious-nx-packages-used-in-two-waves-of-supply-chain-attack&amp;linkname=Malicious%20Nx%20Packages%20Used%20in%20Two%20Waves%20of%20Supply%20Chain%20Attack%20-%20DevOps.comhttps://www.addtoany.com/add_to/facebook?linkurl=https%3A%2F%2Fdevops.com%2Fmalicious-nx-packages-used-in-two-waves-of-supply-chain-attack%2F%3Futm_source%3Drss%26utm_medium%3Drss%26utm_campaign%3Dmalicious-nx-packages-used-in-two-waves-of-supply-chain-attack&amp;linkname=Malicious%20Nx%20Packages%20Used%20in%20Two%20Waves%20of%20Supply%20Chain%20Attack%20-%20DevOps.comhttps://www.addtoany.com/add_to/reddit?linkurl=https%3A%2F%2Fdevops.com%2Fmalicious-nx-packages-used-in-two-waves-of-supply-chain-attack%2F%3Futm_source%3Drss%26utm_medium%3Drss%26utm_campaign%3Dmalicious-nx-packages-used-in-two-waves-of-supply-chain-attack&amp;linkname=Malicious%20Nx%20Packages%20Used%20in%20Two%20Waves%20of%20Supply%20Chain%20Attack%20-%20DevOps.comhttps://www.addtoany.com/add_to/email?linkurl=https%3A%2F%2Fdevops.com%2Fmalicious-nx-packages-used-in-two-waves-of-supply-chain-attack%2F%3Futm_source%3Drss%26utm_medium%3Drss%26utm_campaign%3Dmalicious-nx-packages-used-in-two-waves-of-supply-chain-attack&amp;linkname=Malicious%20Nx%20Packages%20Used%20in%20Two%20Waves%20of%20Supply%20Chain%20Attack%20-%20DevOps.comhttps://www.addtoany.com/share\n\n[« Bringing Order to Chaotic Software Engineering Workflows](https://devops.com/bringing-order-to-chaotic-software-engineering-workflows/)\n\n[![](https://devops.com/wp-content/uploads/2024/11/Copy-of-DO-Banners-1540x660-1.png)](https://webinars.devops.com/in-article-newsletter-popup)\n\n×",
  "ProcessedDate": "2025-08-29 18:15:51",
  "PubDate": "2025-08-29T17:15:10+00:00",
  "Tags": [
    "AI",
    "DevOps and Open Technologies",
    "github",
    "News",
    "npm registry",
    "Social - Facebook",
    "Social - LinkedIn",
    "Social - X",
    "supply chain attacks"
  ]
}
