{
  "OutputDir": "_community",
  "Link": "https://techcommunity.microsoft.com/t5/excel/additional-help-needed-with-existing-formula-using-lamda-excel/m-p/4444247#M254093",
  "Title": "Additional help needed with existing formula using LAMDA- Excel 365",
  "ProcessedDate": "2025-08-15 17:13:29",
  "FeedLevelAuthor": "rss.livelink.threads-in-node",
  "FeedUrl": "https://techcommunity.microsoft.com/t5/s/gxcuf89792/rss/Community",
  "PubDate": "2025-08-15T16:05:37+00:00",
  "Description": "Good day! I received assistance here with this formula. It's supposed to use the scores of various evaluation categories displayed in E5:E12 to only display for printing the records for the ones on which the goal is either \"Not Met\" or \"Exceed\". The review categories that are blank (no items reviewed) and/or those indicated as \"Met\", should not be spilled.\n\nCurrently, the formula included below only excludes the category and records of the one where there are no values (no items reviewed). So, I'm trying to figure out how to adjust the formula to also exclude the records of the review categories marked as \"Met\" in the range E5:E12 on the spilled report tab.\n\n=LET(filterBy, RESULTS!A2:C2,\n\nresultTable, RESULTS!A5:E12,\n\ncolumnCounts, {5,6,5,5,5,7,6,7},\n\nreport, LAMBDA(result\\_filter,result\\_row,table\\_all, LET(table\\_data, DROP(table\\_all,1),\n\ntable\\_matches, (CHOOSECOLS(table\\_data,3)=INDEX(result\\_filter,1))\\*\n\n(CHOOSECOLS(table\\_data,2)>=INDEX(result\\_filter,2))\\*\n\n(CHOOSECOLS(table\\_data,2)\n\nIF(N(INDEX(result\\_row,2)),\n\nVSTACK(\"\\*\\*\\* \"&INDEX(result\\_row,1)&\" \\*\\*\\*\",\n\nTAKE(table\\_all,1),\n\nFILTER(table\\_data, table\\_matches, \"\")),\n\n\"\"))),\n\ntotal, REDUCE(\"\",SEQUENCE(ROWS(resultTable)),LAMBDA(p,q,VSTACK(p,\n\nLET(tbl, INDIRECT(\"tbl\"&TEXTJOIN(,,TEXTSPLIT(INDEX(resultTable,q,1),{\" \",\"-\"}))&\"[#ALL]\"),\n\nreport(filterBy, CHOOSEROWS(resultTable,q), CHOOSECOLS(tbl,SEQUENCE(,INDEX(columnCounts,q)),SEQUENCE(,2,COLUMNS(tbl)-1))))\n\n))),\n\nIFNA(IF(total=0, \"\", total),\"\"))\n\nAny assistance with this is greatly appreciated!",
  "FeedName": "Microsoft Tech Community",
  "Author": "Marcus_Booth",
  "Tags": [],
  "EnhancedContent": "Good day! I received assistance here with this formula. It's supposed to use the scores of various evaluation categories displayed in E5:E12 to only display for printing the records for the ones on which the goal is either \"Not Met\" or \"Exceed\". The review categories that are blank (no items reviewed) and/or those indicated as \"Met\", should not be spilled.\n\nCurrently, the formula included below only excludes the category and records of the one where there are no values (no items reviewed). So, I'm trying to figure out how to adjust the formula to also exclude the records of the review categories marked as \"Met\" in the range E5:E12 on the spilled report tab.\n\n=LET(filterBy, RESULTS!A2:C2,\n\nresultTable, RESULTS!A5:E12,\n\ncolumnCounts, {5,6,5,5,5,7,6,7},\n\nreport, LAMBDA(result\\_filter,result\\_row,table\\_all, LET(table\\_data, DROP(table\\_all,1),\n\ntable\\_matches, (CHOOSECOLS(table\\_data,3)=INDEX(result\\_filter,1))\\*\n\n(CHOOSECOLS(table\\_data,2)&gt;=INDEX(result\\_filter,2))\\*\n\n(CHOOSECOLS(table\\_data,2)&lt;=INDEX(result\\_filter,3)),\n\nIF(N(INDEX(result\\_row,2)),\n\nVSTACK(\"\\*\\*\\* \"&INDEX(result\\_row,1)&\" \\*\\*\\*\",\n\nTAKE(table\\_all,1),\n\nFILTER(table\\_data, table\\_matches, \"\")),\n\n\"\"))),\n\ntotal, REDUCE(\"\",SEQUENCE(ROWS(resultTable)),LAMBDA(p,q,VSTACK(p,\n\nLET(tbl, INDIRECT(\"tbl\"&TEXTJOIN(,,TEXTSPLIT(INDEX(resultTable,q,1),{\" \",\"-\"}))&\"[#ALL]\"),\n\nreport(filterBy, CHOOSEROWS(resultTable,q), CHOOSECOLS(tbl,SEQUENCE(,INDEX(columnCounts,q)),SEQUENCE(,2,COLUMNS(tbl)-1))))\n\n))),\n\nIFNA(IF(total=0, \"\", total),\"\"))\n\nAny assistance with this is greatly appreciated!"
}
