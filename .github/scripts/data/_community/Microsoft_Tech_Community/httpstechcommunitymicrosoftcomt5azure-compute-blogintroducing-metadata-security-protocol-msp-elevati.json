{
  "Link": "https://techcommunity.microsoft.com/t5/azure-compute-blog/introducing-metadata-security-protocol-msp-elevating-platform/ba-p/4471204",
  "Author": "Amjad_Shaik",
  "Description": "We are excited to announce the **General Availability (GA)** of [Metadata Security Protocol (MSP),](https://learn.microsoft.com/en-us/azure/virtual-machines/metadata-security-protocol/overview) an industry-first innovation designed to mitigate vulnerabilities at the platform layer. Azure becomes the first major cloud provider to integrate strong authentication and authorization (AuthN and AuthZ) for metadata service endpoints inside virtual machines. MSP introduces a default-closed security model for the Instance Metadata Service (IMDS) and WireServer, ensuring only trusted processes can access sensitive data over it, eliminating a subset of attack classes, reducing another subset of attack surfaces and aligning with zero-trust security principles.\n\n### What is MSP and Why Does It Matter?\n\nThe [Instance Metadata Service (IMDS)](https://learn.microsoft.com/en-us/azure/virtual-machines/instance-metadata-service?tabs=windows) provides critical information to virtual machines, including instance details, managed identity tokens, and platform configuration data. Historically, IMDS endpoints across the industry cloud providers including Azure, were accessible security boundary of protection being the Guest Virtual machine. With the advent of containerization and nested virtualization, the new MSP protocol invests in a strong authentication layer, which enables sub-VM security boundary protection for hosted cloud services infrastructure. And this additionally, helps eliminate several security anti-patterns and attack subclasses related to:\n\n1. Server-Side Request Forgery (SSRF) over IMDS endpoints – curtailing exploitation of unauthenticated metadata APIs to gain access to sensitive tokens or configuration data.\n2. Hosted-on-Behalf-of (HoBo) nested tenancy bypasses – eliminating attack scenarios bypasses for nested virtualization setup for multi-tenancy or misconfigured trust boundaries allowed indirect access to metadata.\n3. Implicit trust within the VM – adding strong application layer defense in depth beyond network isolation for sub-VM boundaries.\n\n##### MSP addresses this by introducing industry-first protections:\n\n- Authentication for IMDS calls – uses a trusted delegate and HMAC to ensure only verified processes can access metadata. Every [IMDS](https://learn.microsoft.com/en-us/azure/virtual-machines/instance-metadata-service?tabs=windows) and [WireServer](https://learn.microsoft.com/en-us/azure/virtual-network/what-is-ip-address-168-63-129-16?tabs=windows) request is authenticated and validated using trusted delegates and HMAC signatures, ensuring only verified processes can access metadata.\n\n- Improved isolation – MSP offers enhanced protection against risks from container network misconfiguration.\n\n- Default-Closed Model – IMDS access is locked down by default, requiring strict allowlisting of approved in-guest software and users, aligning with zero-trust principles.\n\n- Guest Proxy Agent (GPA) – [GPA](https://github.com/Azure/GuestProxyAgent) leverages eBPF to verify the source of every metadata request and enforce Role-Based Access Control (RBAC) at the process level.\n\n- Fine-grained access control – allowing you to restrict IMDS access to specific users or processes with [advanced configuration](https://learn.microsoft.com/en-us/azure/virtual-machines/metadata-security-protocol/advanced-configuration), reducing the attack surface significantly.\n\nWith MSP, you can limit IMDS access to approved applications, reducing your attack surface and improving your security posture.\n\n### Benefits of MSP\n\nBy adopting MSP, you gain:\n\n- Defense-in-depth against metadata-related attacks: MSP adds an extra security layer to protect sensitive metadata and identity tokens, reducing exposure from misconfigurations or compromised processes.\n\n- Granular control over IMDS access within your VMs: With fine-grained RBAC and allowlisting, you decide which applications and users can access metadata, ensuring only trusted components interact with critical services.\n\n- Peace of mind with industry-leading protections: MSP introduces a default-closed model and per-request authentication, aligning with zero-trust principles and making Azure the first major cloud to deliver this level of in-guest security.\n\n### How to Get Started?****\n\nThe goal of onboarding is to configure your VMs so that only approved applications can access the WireServer/IMDS endpoints. Here’s the recommended approach:\n\n1. Enable MSP in Audit Mode: Start by enabling MSP in audit mode to monitor which processes are accessing IMDS.\n2. Create an Allowlist: Use audit logs to identify legitimate applications and build an allowlist.\n3. Enable MSP Enforcement: Once the allowlist is finalized, switch MSP to enforcement mode to restrict access.\n\nStart today by enabling MSP in audit mode and take the first step toward securing your Azure environment against evolving threats. For detailed instructions, visit the [MSP Microsoft Learn page](https://learn.microsoft.com/en-us/azure/virtual-machines/metadata-security-protocol/overview).",
  "FeedUrl": "https://techcommunity.microsoft.com/t5/s/gxcuf89792/rss/Category?category.id=Azure",
  "FeedLevelAuthor": "rss.livelink.threads-in-node",
  "Title": "Introducing Metadata Security Protocol (MSP): Elevating Platform Security for Azure VMs",
  "ProcessedDate": "2025-11-19 20:05:09",
  "Tags": [],
  "OutputDir": "_community",
  "PubDate": "2025-11-19T19:36:55+00:00",
  "EnhancedContent": "We are excited to announce the **General Availability (GA)** of [Metadata Security Protocol (MSP),](https://learn.microsoft.com/en-us/azure/virtual-machines/metadata-security-protocol/overview) an industry-first innovation designed to mitigate vulnerabilities at the platform layer. Azure becomes the first major cloud provider to integrate strong authentication and authorization (AuthN and AuthZ) for metadata service endpoints inside virtual machines. MSP introduces a default-closed security model for the Instance Metadata Service (IMDS) and WireServer, ensuring only trusted processes can access sensitive data over it, eliminating a subset of attack classes, reducing another subset of attack surfaces and aligning with zero-trust security principles.\n\n### What is MSP and Why Does It Matter?\n\nThe [Instance Metadata Service (IMDS)](https://learn.microsoft.com/en-us/azure/virtual-machines/instance-metadata-service?tabs=windows) provides critical information to virtual machines, including instance details, managed identity tokens, and platform configuration data. Historically, IMDS endpoints across the industry cloud providers including Azure, were accessible security boundary of protection being the Guest Virtual machine. With the advent of containerization and nested virtualization, the new MSP protocol invests in a strong authentication layer, which enables sub-VM security boundary protection for hosted cloud services infrastructure.  And this additionally, helps eliminate several security anti-patterns and attack subclasses related to:\n\n1. Server-Side Request Forgery (SSRF) over IMDS endpoints – curtailing exploitation of unauthenticated metadata APIs to gain access to sensitive tokens or configuration data.\n2. Hosted-on-Behalf-of (HoBo) nested tenancy bypasses – eliminating attack scenarios bypasses for nested virtualization setup for multi-tenancy or misconfigured trust boundaries allowed indirect access to metadata.\n3. Implicit trust within the VM – adding strong application layer defense in depth beyond network isolation for sub-VM boundaries.\n\n#####  MSP addresses this by introducing industry-first protections:\n\n- Authentication for IMDS calls – uses a trusted delegate and HMAC to ensure only verified processes can access metadata. Every [IMDS](https://learn.microsoft.com/en-us/azure/virtual-machines/instance-metadata-service?tabs=windows) and [WireServer](https://learn.microsoft.com/en-us/azure/virtual-network/what-is-ip-address-168-63-129-16?tabs=windows) request is authenticated and validated using trusted delegates and HMAC signatures, ensuring only verified processes can access metadata.\n\n- Improved isolation – MSP offers enhanced protection against risks from container network misconfiguration.\n\n- Default-Closed Model – IMDS access is locked down by default, requiring strict allowlisting of approved in-guest software and users, aligning with zero-trust principles.\n\n- Guest Proxy Agent (GPA) – [GPA](https://github.com/Azure/GuestProxyAgent) leverages eBPF to verify the source of every metadata request and enforce Role-Based Access Control (RBAC) at the process level.\n\n- Fine-grained access control – allowing you to restrict IMDS access to specific users or processes with [advanced configuration](https://learn.microsoft.com/en-us/azure/virtual-machines/metadata-security-protocol/advanced-configuration), reducing the attack surface significantly.\n\nWith MSP, you can limit IMDS access to approved applications, reducing your attack surface and improving your security posture.\n\n### Benefits of MSP\n\nBy adopting MSP, you gain:\n\n- Defense-in-depth against metadata-related attacks: MSP adds an extra security layer to protect sensitive metadata and identity tokens, reducing exposure from misconfigurations or compromised processes.\n\n- Granular control over IMDS access within your VMs: With fine-grained RBAC and allowlisting, you decide which applications and users can access metadata, ensuring only trusted components interact with critical services.\n\n- Peace of mind with industry-leading protections: MSP introduces a default-closed model and per-request authentication, aligning with zero-trust principles and making Azure the first major cloud to deliver this level of in-guest security.\n\n### How to Get Started?****\n\nThe goal of onboarding is to configure your VMs so that only approved applications can access the WireServer/IMDS endpoints. Here’s the recommended approach:\n\n1. Enable MSP in Audit Mode: Start by enabling MSP in audit mode to monitor which processes are accessing IMDS.\n2. Create an Allowlist: Use audit logs to identify legitimate applications and build an allowlist.\n3. Enable MSP Enforcement: Once the allowlist is finalized, switch MSP to enforcement mode to restrict access.\n\nStart today by enabling MSP in audit mode and take the first step toward securing your Azure environment against evolving threats. For detailed instructions, visit the [MSP Microsoft Learn page](https://learn.microsoft.com/en-us/azure/virtual-machines/metadata-security-protocol/overview).\n\nUpdated Nov 19, 2025\n\nVersion 1.0\n\n[!\\[Amjad_Shaik&#x27;s avatar\\](https://techcommunity.microsoft.com/t5/s/gxcuf89792/images/dS0zMjEzMzc4LWVVYU9wYQ?image-coordinates=0%2C0%2C240%2C240&amp;image-dimensions=50x50)](/users/amjad_shaik/3213378) [Amjad_Shaik](/users/amjad_shaik/3213378) ![Icon for Microsoft rank](https://techcommunity.microsoft.com/t5/s/gxcuf89792/images/cmstNC05WEo0blc?image-dimensions=100x16&amp;constrain-image=true)Microsoft\n\nJoined October 01, 2025\n\n[View Profile](/users/amjad_shaik/3213378)\n\n/category/azure/blog/azurecompute [Azure Compute Blog](/category/azure/blog/azurecompute) Follow this blog board to get notified when there's new activity",
  "FeedName": "Microsoft Tech Community"
}
