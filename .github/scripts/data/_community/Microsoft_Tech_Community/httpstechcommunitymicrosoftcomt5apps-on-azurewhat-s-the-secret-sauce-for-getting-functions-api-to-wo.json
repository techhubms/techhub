{
  "FeedName": "Microsoft Tech Community",
  "Tags": [],
  "OutputDir": "_community",
  "Author": "fcc_archivist",
  "PubDate": "2025-08-26T21:18:41+00:00",
  "Description": "I'm brand new, got my first Azure static web site up and running so that's good! Now I need to create some images in code and that's fighting me tooth and nail.\n\nThe code to generate the image looks like this:\n\n- using Microsoft.Azure.Functions.Worker;\nusing Microsoft.Azure.Functions.Worker.Http; using Microsoft.Extensions.Logging; using SkiaSharp; using System.Diagnostics; using System.IO; using System.Net;\n\nnamespace Api { public class GenerateImage { private readonly ILogger \\_logger;\n\npublic GenerateImage(ILoggerFactory loggerFactory) { Debug.WriteLine($\"GenerateImage.GenerateImage()\");\n\n\\_logger = loggerFactory.CreateLogger(); }\n\n// http://localhost:7071/api/image/124 works [Function(\"GenerateImage\")] public HttpResponseData Run( [HttpTrigger(AuthorizationLevel.Anonymous, \"get\", Route = \"image/{id}\")] HttpRequestData req, string id) { int width = 200, height = 100;\n\nDebug.WriteLine($\"GenerateImage.Run() [id={id}]\");\n\nusing var bitmap = new SKBitmap(width, height); using var canvas = new SKCanvas(bitmap); canvas.Clear(SKColors.LightBlue);\n\nvar paint = new SKPaint { Color = SKColors.Black, TextSize = 24, IsAntialias = true };\n\ncanvas.DrawText($\"ID: {id}\", 10, 50, paint);\n\nusing var ms = new MemoryStream(); bitmap.Encode(ms, SKEncodedImageFormat.Png, 100); ms.Position = 0;\n\nvar response = req.CreateResponse(HttpStatusCode.OK); response.Headers.Add(\"Content-Type\", \"image/png\"); response.Headers.Add(\"Cache-Control\", \"public, max-age=86400\"); // 1 day // response.Body = ms; ms.CopyTo(response.Body);\n\nreturn response; } } } and if I navigate to [http://localhost:7071/api/image/124](http://localhost:7071/api/image/124) (for example) it happily generates an image with the number 124 in it.\n\nBut if I add the HTML tag\n- ![Generated Image](/api/image/123)\nto one of my other web pages, it says there's no such page. Apparently this is because my web pages are coming from my web site and it's at [https://localhost:7154](https://localhost:7154) and it doesn't know how to contact the Functions API.\n\nMy staticwebapp.config.json looks like this:\n- {\n\"routes\": [ { \"route\": \"/api/\\*\", \"allowedRoles\": [ \"anonymous\" ] } ], \"navigationFallback\": { \"rewrite\": \"/index.html\", \"exclude\": [ \"/api/\\*\" ] } } What am I missing?",
  "Link": "https://techcommunity.microsoft.com/t5/apps-on-azure/what-s-the-secret-sauce-for-getting-functions-api-to-work-with/m-p/4448430#M1359",
  "Title": "What's the secret sauce for getting Functions API to work with static web site?",
  "ProcessedDate": "2025-08-27 23:11:29",
  "FeedLevelAuthor": "rss.livelink.threads-in-node",
  "EnhancedContent": "I'm brand new, got my first Azure static web site up and running so that's good!  Now I need to create some images in code and that's fighting me tooth and nail.\n\nThe code to generate the image looks like this:\n\n``` using Microsoft.Azure.Functions.Worker; using Microsoft.Azure.Functions.Worker.Http; using Microsoft.Extensions.Logging; using SkiaSharp; using System.Diagnostics; using System.IO; using System.Net;\n\nnamespace Api { public class GenerateImage { private readonly ILogger _logger;\n\npublic GenerateImage(ILoggerFactory loggerFactory) { Debug.WriteLine($\"GenerateImage.GenerateImage()\");\n\n_logger = loggerFactory.CreateLogger<GenerateImage>(); }\n\n// http://localhost:7071/api/image/124 works [Function(\"GenerateImage\")] public HttpResponseData Run( [HttpTrigger(AuthorizationLevel.Anonymous, \"get\", Route = \"image/{id}\")] HttpRequestData req, string id) { int width = 200, height = 100;\n\nDebug.WriteLine($\"GenerateImage.Run() [id={id}]\");\n\nusing var bitmap = new SKBitmap(width, height); using var canvas = new SKCanvas(bitmap); canvas.Clear(SKColors.LightBlue);\n\nvar paint = new SKPaint { Color = SKColors.Black, TextSize = 24, IsAntialias = true };\n\ncanvas.DrawText($\"ID: {id}\", 10, 50, paint);\n\nusing var ms = new MemoryStream(); bitmap.Encode(ms, SKEncodedImageFormat.Png, 100); ms.Position = 0;\n\nvar response = req.CreateResponse(HttpStatusCode.OK); response.Headers.Add(\"Content-Type\", \"image/png\"); response.Headers.Add(\"Cache-Control\", \"public, max-age=86400\"); // 1 day // response.Body = ms; ms.CopyTo(response.Body);\n\nreturn response; } } } ```\n\nand if I navigate to http://localhost:7071/api/image/124 (for example) it happily generates an image with the number 124 in it.\n\nBut if I add the HTML tag\n\n``` <img src=\"/api/image/123\" alt=\"Generated Image\"> ```\n\nto one of my other web pages, it says there's no such page.  Apparently this is because my web pages are coming from my web site and it's at https://localhost:7154 and it doesn't know how to contact the Functions API.\n\nMy staticwebapp.config.json looks like this:\n\n``` { \"routes\": [ { \"route\": \"/api/*\", \"allowedRoles\": [ \"anonymous\" ] } ], \"navigationFallback\": { \"rewrite\": \"/index.html\", \"exclude\": [ \"/api/*\" ] } } ```\n\nWhat am I missing?",
  "FeedUrl": "https://techcommunity.microsoft.com/t5/s/gxcuf89792/rss/Category?category.id=Azure"
}
