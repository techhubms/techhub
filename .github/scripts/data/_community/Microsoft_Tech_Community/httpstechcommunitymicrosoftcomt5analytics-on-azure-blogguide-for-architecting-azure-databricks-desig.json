{
  "FeedLevelAuthor": "rss.livelink.threads-in-node",
  "EnhancedContent": "***Author's:** Chris Walk* [cwalk​](javascript:void%280%29)*, Dan Johnson* [danjohn1234​](javascript:void%280%29)*, Eduardo dos Santos* [eduardomdossantos​](javascript:void%280%29)*, Ted Kim* [tekim​](javascript:void%280%29)*, Eric Kwashie [ekwashie​](javascript:void%280%29), Chris Hayes*[Chris_Haynes​](javascript:void%280%29)*, Tayo Akigbogun [takigbogun​](javascript:void%280%29) and Rafia Aqil [Rafia_Aqil​](javascript:void%280%29)*\n\n*Peer Reviewed: Mohamed Sharaf [mohamedsharaf​](javascript:void%280%29)*\n\n**Note****:** This article does not cover the Serverless Workspace option, which is currently in [Private Preview](https://learn.microsoft.com/en-us/azure/databricks/admin/workspace/serverless-workspaces). We plan to update this article once Serverless Workspaces are Generally Available. Also, while Terraform is the recommended method for production deployments due to its automation and repeatability, for simplicity in this article we will demonstrate deployment through the Azure portal.\n\n## **DESIGN: Architecting a Secure Azure Databricks Environment**\n\n#### **Step 1: Plan Workspace, Subscription Organization, Analytics Architecture and Compute**\n\nPlanning your Azure Databricks environment can follow various arrangements depending on your organization’s structure, governance model, and workload requirements. The following guidance outlines key considerations to help you design a well-architected foundation.\n\n##### **1.1 Align Workspaces with Business Units**\n\nA recommended best practice is to align each Azure Databricks workspace with a specific business unit. This approach—often referred to as the “Business Unit Subscription” design pattern—offers several operational and governance advantages.\n\n- - Streamlined Access Control: Each unit manages its own workspace, simplifying permissions and reducing cross-team access risks. For example, Sales can securely access only their data and notebooks.\n\n- - Cost Transparency: Mapping workspaces to business units enables accurate cost attribution and supports internal chargeback models. Each workspace can be tagged to a cost center for visibility and accountability. Even within the same workspace, [costs can be controlled using system tables](https://learn.microsoft.com/en-us/azure/databricks/admin/usage/?utm_source=chatgpt.com) that provide detailed usage metrics and resource consumption insights.\n\nChallenges to keep-in-mind: While per-BU workspaces have high impact, be mindful of workspace sprawl. If every small team spins up its own workspace, you might end up with dozens or hundreds of workspaces, which introduces management overhead. Databricks recommends a reasonable upper limit (on Azure, roughly 20–50 workspaces per account/subscription) because managing “collaboration, access, and security across hundreds of workspaces can become extremely difficult, even with good automation” [\\[1\\]](https://www.databricks.com/blog/2022/03/10/functional-workspace-organization-on-databricks.html). Each workspace will need governance (user provisioning, monitoring, compliance checks), so there is a balance to strike.\n\n##### **[1.2 Workspace Alignment and Shared Metastore Strategy](https://learn.microsoft.com/en-us/azure/databricks/data-governance/unity-catalog/best-practices)**\n\nAs you align workspaces with business units, it's essential to understand how Unity Catalog and the metastore fit into your architecture. [Unity Catalog is Databricks’](https://learn.microsoft.com/en-us/azure/databricks/data-governance/unity-catalog/#metastore) unified governance layer that centralizes access control, auditing, and data lineage across workspaces. Each Unity Catalog is backed by a metastore, which acts as the central metadata repository for tables, views, volumes, and other data assets. In Azure Databricks, you can have one metastore per region, and all workspaces within that region share it. This enables consistent governance and simplifies data sharing across teams. If your organization spans multiple regions, you’ll need to plan for [cross-region sharing](https://learn.microsoft.com/en-us/azure/databricks/data-governance/unity-catalog/best-practices#x-region), which Unity Catalog supports through [Delta Sharing](https://learn.microsoft.com/en-us/azure/databricks/delta-sharing/). By aligning workspaces with business units and connecting them to a shared metastore, you ensure that governance policies are enforced uniformly, while still allowing each team to manage its own data assets securely and independently.\n\n##### **[1.3 Distribute Workspaces Across Subscriptions](https://github.com/Azure/AzureDatabricksBestPractices/blob/master/toc.md#deploy-workspaces-in-multiple-subscriptions-to-honor-azure-capacity-limits)**\n\nWhen scaling Azure Databricks, consider not just the number of workspaces, but also how to distribute them across Azure subscriptions. Using multiple Azure subscriptions can serve both organizational needs and technical requirements:\n\n- - Environment Segmentation (Dev/Test/Prod): A common pattern is to put production workspaces in a separate Azure subscription from development or test workspaces. This provides an extra layer of isolation.  Microsoft highly recommends separating workspaces into prod and dev, in separate subscriptions. This way, you can apply stricter Azure policies or network rules to the prod subscription and keep the dev subscription a bit more open for experimentation without risking prod resources.\n\n- - Honor [Azure Resource Limits](https://learn.microsoft.com/en-us/azure/azure-resource-manager/management/azure-subscription-service-limits): Azure subscriptions come with certain capacity limits and [Azure Databricks workspaces](https://learn.microsoft.com/en-us/azure/databricks/resources/limits) have their own limits (since it’s a multi-tenant PaaS). If you put all workspaces in one subscription, or all teams in one workspace, you might hit those limits.\n\nMost enterprises naturally end up with multiple subscriptions as they grow – planning this early avoids later migration headaches. If you currently have everything in one subscription, evaluate usage and consider splitting off heavy workloads or prod workloads into a new one to adhere to best practices.\n\n##### **[1.4 Consider Completing Azure Landing Zone Assessment](https://learn.microsoft.com/en-us/assessments/21765fea-dfe6-4bc4-8bb7-db9df5a6f6c0/)**\n\nWhen evaluating and planning your next deployment, it’s essential to ensure that your current landing zone aligns with Microsoft best practices. This helps establish a robust Databricks architecture and minimizes the risk of avoidable issues. Additionally, customers who are early in their cloud journey can benefit from Cloud Assessments—such as an Azure Landing Zone Review and a review of the [“Prepare for Cloud Adoption” documentation](https://learn.microsoft.com/en-us/azure/cloud-adoption-framework/ready/)—to build a strong foundation.\n\n##### **1.5 Planning Your Azure Databricks Workspace Architecture**\n\nYour workspace architecture should reflect the operational model of your organization and support the workloads you intend to run, from exploratory notebooks to production-grade ETL pipelines. To support your planning, Microsoft provides several reference architectures that illustrate well-architected patterns for Databricks deployments. These solution ideas can serve as starting points for designing maintainable environments: Simplified Architecture: [Modern Data Platform Architecture,](https://learn.microsoft.com/en-us/azure/architecture/solution-ideas/articles/small-medium-modern-data-platform) ETL-Intensive Workload Reference Architecture: [Building ETL Intensive Architecture](https://learn.microsoft.com/en-us/azure/architecture/solution-ideas/articles/ingest-etl-stream-with-adb), End-to-End Analytics Architecture: [Create a Modern Analytics Architecture.](https://learn.microsoft.com/en-us/azure/architecture/solution-ideas/articles/azure-databricks-modern-analytics-architecture)\n\n##### **1.6 Planning for that “Right” Compute**\n\nChoosing the right compute setup in Azure Databricks is crucial for optimizing performance and controlling costs, as [billing is based on Databricks Units (DBUs)](https://azure.microsoft.com/en-us/pricing/details/databricks/) using a per-second pricing model.\n\n- - **Classic Compute:** [You can fine-tune your own compute](https://learn.microsoft.com/en-us/azure/databricks/compute/cluster-config-best-practices) by enabling auto-termination and autoscaling, using Photon acceleration, leveraging spot instances, selecting the right VM type and node count for your workload, and choosing SSDs for performance or HDDs for archival storage.\n\n- - - Preferred by mature internal teams and developers who need advanced control over clusters—such as custom VM selection, tuning, and specialized configurations.\n\n- - **Serverless Compute:** Alternatively, [managed services](https://learn.microsoft.com/en-us/azure/databricks/compute/serverless/best-practices) can simplify operations with built-in optimizations.\n\n- - - Removes infrastructure management and offers instant scaling without cluster warm-up, making it ideal for agility and simplicity.\n\n#### **Step 2: Plan the “Right” CIDR Range (Classic Compute)**\n\n**Note**: You can skip this step if you plan to use serverless compute for all your resources, as CIDR range planning is not required in serverless deployments.\n\nWhen planning CIDR ranges for your Azure Databricks workspace, it's important to ensure your virtual network has enough IP address capacity to support cluster scaling. Why this matters: If you choose a small VNet address space and your analytics workloads grow, you might hit a ceiling where you simply cannot launch more clusters or scale-out because there are no free IPs in the subnet. The subnet sizes—and by extension, the VNet CIDR—determine how many nodes you can. Databricks recommends using a CIDR block between /16 and /24 for the VNet, and up to /26 for the two required subnets: the container subnet and the host subnet.  Here’s a [reference Microsoft provides](https://learn.microsoft.com/en-us/azure/databricks/security/network/classic/vnet-inject#address-space-and-maximum-cluster-nodes).\n\nIf your current workspace’s VNet lacks sufficient IP space for active cluster nodes, you can request a CIDR range update through your Azure Databricks account team as noted in the [Microsoft documentation](https://learn.microsoft.com/en-us/azure/databricks/security/network/classic/vnet-inject#address-space-and-maximum-cluster-nodes:~:text=/26.-,Important,-You%20can%27t%20replace).\n\n##### **2.1 Considerations for CIDR Range**\n\n- - Workload Type & Concurrency: Consider what kinds of workloads will run (ETL Pipelines, Machine Learning Notebooks, BI Dashboards, etc.) and how many jobs or clusters may need to run in parallel. High concurrency (e.g. multiple ETL jobs or many interactive clusters) means more nodes running at the same time, requiring a larger pool of IP addresses.\n\n- - Data Volume (Historical vs. Incremental): Are you doing a one-time historical data load or only processing new incremental data? A large backfill of terabytes of data may require spinning up a very large cluster (hundreds of nodes) to process in a reasonable time. Ongoing smaller loads might get by with fewer nodes. Estimate how much data needs processing.\n\n- - Transformation Complexity: The complexity of data transformations or machine learning workloads matters. Heavy transformations (joins, aggregations on big data) or complex model training can benefit more workers. If your use cases include these, you may need larger clusters (more nodes) to meet performance SLAs, which in turn demands more IP addresses available in the subnet.\n\n- - Data Sources and Integration: Consider how your Databricks environment will connect to data. If you have multiple data sources or sinks (e.g. ingest from many event hubs, databases, or IoT streams), you might design multiple dedicated clusters or workflows, potentially all active at once. Also, if using separate job clusters per job (Databricks Jobs), multiple clusters might launch concurrently. All these scenarios increase concurrent node count.\n\n##### **[2.2 Configuring a Dedicated Network (VNet) per Workspace with Egress Control](https://learn.microsoft.com/en-us/azure/databricks/security/network/classic/vnet-inject)**\n\nBy default, Azure Databricks deploys its classic compute resources into a Microsoft-managed virtual network (VNet) within your Azure subscription. While this simplifies setup, it limits control over network configuration. For enhanced security and flexibility, it's recommended to use [VNet Injection](https://learn.microsoft.com/en-us/azure/databricks/security/network/classic/vnet-inject), which allows you to deploy the compute plane into your own customer-managed VNet. This approach enables secure integration with other Azure services using service endpoints or private endpoints, supports user-defined routes for accessing on-premises data sources, allows traffic inspection via network virtual appliances or firewalls, and provides the ability to configure custom DNS and enforce egress restrictions through network security group (NSG) rules.\n\nWithin this VNet (which must reside in the same region and subscription as the Azure Databricks workspace), two subnets are required for Azure Databricks: a container subnet (referred to as private subnet) and a host subnet (referred to as public subnet). To implement front-end Private Link, back-end Private Link, or both, your workspace VNet needs a third subnet that will contain the private endpoint (PrivateLink subnet). It is recommended to also deploy an Azure Firewall for egress control.\n\n#### **Step 3: Plan Network Architecture for Securing Azure-Databricks**\n\n##### **[3.1 Secure Cluster Connectivity](https://learn.microsoft.com/en-us/azure/databricks/security/network/classic/secure-cluster-connectivity#secure-cluster-connectivity-overview)**\n\nSecure Cluster Connectivity, also known as No Public IP (NPIP), is a foundational security feature for Azure Databricks deployments. When enabled, it ensures that compute resources within the customer-managed virtual network (VNet) do not have public IP addresses, and no inbound ports are exposed. Instead, each cluster initiates a secure outbound connection to the Databricks control plane using port 443 (HTTPS), through a dedicated relay. This tunnel is used exclusively for administrative tasks, separate from the web application and REST API traffic, significantly reducing the attack surface. For the most secure deployment, Microsoft and Databricks strongly recommend enabling Secure Cluster Connectivity, especially in environments with strict compliance or regulatory requirements. When Secure Cluster Connectivity is enabled, both workspace subnets become private, as cluster nodes don’t have public IP addresses.\n\n##### **3.2 Egress with VNet Injection (NVA)**\n\nFor Databricks traffic, you’ll need to assign a UDR to the Databricks-managed VNet with a next hop type of Network Virtual Appliance (NVA)—this could be an Azure Firewall, NAT Gateway, or another routing device. For control plane traffic, Databricks recommends using Azure service tags, which are logical groupings of IP addresses for Azure services and should be routed with the next hop type of internet. This is important because Azure IP ranges can change frequently as new resources are provisioned, and manually maintaining IP lists is not practical. Using service tags ensures that your routing rules automatically stay up to date.\n\n##### **[3.3 Front-End Connectivity with Azure Private Link (Standard Deployment)](https://learn.microsoft.com/en-us/azure/databricks/security/network/classic/private-link-standard#introduction-to-front-end-connections-in-a-standard-deployment)**\n\nTo further enhance security, Azure Databricks supports Private Link for front-end connections. In a standard deployment, Private Link enables users to access the Databricks web application, REST API, and JDBC/ODBC endpoints over a private VNet interface, bypassing the public internet.\n\nFor organizations with no public internet access from user networks, a browser authentication private endpoint is required. This endpoint supports SSO login callbacks from Microsoft Entra ID and is shared across all workspaces in a region using the same private DNS zone. It is typically hosted in a transit VNet that bridges on-premises networks and Azure. Note: There are two deployment types: [standard](https://learn.microsoft.com/en-us/azure/databricks/security/network/classic/private-link-standard#introduction-to-front-end-connections-in-a-standard-deployment) and [simplified](https://learn.microsoft.com/en-us/azure/databricks/security/network/classic/private-link-simplified#diagrams). To compare these deployment types, see [Choose standard or simplified deployment](https://learn.microsoft.com/en-us/azure/databricks/security/network/classic/private-link#deployment-type).\n\n##### **[3.4 Serverless Compute Networking](https://learn.microsoft.com/en-us/azure/databricks/security/network/serverless-network-security/)**\n\nAzure Databricks offers serverless compute options that simplify infrastructure management and accelerate workload execution. These resources run in a Databricks-managed serverless compute plane, isolated from the public internet and connected to the control plane via the Microsoft backbone network.\n\nTo secure outbound traffic from serverless workloads, administrators can configure Serverless Egress Control using network policies that restrict connections by location, FQDN, or Azure resource type. Additionally, Network Connectivity Configurations (NCCs) allow centralized management of private endpoints and firewall rules. NCCs can be attached to multiple workspaces and are essential for enabling secure access to Azure services like Data Lake Storage from serverless SQL warehouses.\n\n## **DEPLOYMENT: Step-to-Step Implementation using Azure Portal**\n\n##### **Step 1: Create an Azure Resource Group**\n\nFor each new workspace, create a dedicated Resource Group (to contain the Databricks workspace resource and associated resources). Ensure that all resources are deployed in the same Region and Resource Group (i.e. workspace, subnets...) to optimize data movement performance and enhance security.\n\n##### **Step 2: Deploy Workspace Specific Virtual Network (VNET)**\n\n- From your Resource Group, create a Virtual Network.\n\n- Under the Security section, enable Azure Firewall.\n- Deploying an Azure Firewall is recommended for egress control, ensuring that outbound traffic from your Databricks environment is securely managed.\n\n- Define address spaces for your Virtual Network (Review Step 2 from Design).\n\n- [As documented,](https://learn.microsoft.com/en-us/azure/databricks/security/network/classic/private-link-standard#create-vnet) you could create a VNet with these values:\n\n- - IP range: First remove the default IP range, and then add IP range 10.28.0.0/23.\n\n- - Create subnet public-subnet with range 10.28.0.0/25.\n\n- - Create subnet private-subnet with range 10.28.0.128/25.\n\n- - Create subnet private-link with range 10.28.1.0/27.\n\n**Please note:** your IP values can be different depending on your IPAM and available scopes.\n\n- Review + Create your Virtual Network.\n\n##### **Step 3: Deploy Azure-Databricks Workspace:**\n\nNow that networking is in place, create the Databricks workspace. Below are detailed steps your organization should review while creating workspace creation:\n\n- In Azure Portal, search for Azure Databricks and click Create.\n\n- Choose the Subscription, RG, Region, select Premium, enter in “Managed Resource Group name” and click Next.\n\n- Managed Resource Group- will be created after your Databrick workspace is deployed and contains infrastructure resources for the workspace i.e. VNets, DBFS.\n\n- Required: Enable “Secure Cluster Connectivity” (No Public IP for clusters), to ensure that Databricks clusters are deployed without public IP addresses (Review Section 3.1).\n\n- Required: Enable the option to deploy into your Virtual Network (VNet Injection), also known as “Bring Your Own VNet” (Review Section 3.2).\n- Select the Virtual Network created in Step 2.\n\n- Enter Private, Public Subnet Names.\n\n- Enable or Disable “Deploying Nat Gateway”, according to your workspace requirement.\n\n- Disable “Allow Public Network Access”.\n- Select “No Azure Databricks Rules” for Required NSG Rules.\n\n- Select “Click on add to create a private endpoint”, this will open a panel for private endpoint setup.\n\n- Click “Add” to enter your Private Link details created in Step 2.\n- Also, ensure that Private DNS zone integration is set to “Yes” and that a new Private DNS Zone is created, indicated by (New)privatelink.azuredatabricks.net. Unless an existing DNS zone for this purpose already exists.\n\n- (Optional) Under Encryption Tab, [Enable Infrastructure Encryption,](https://learn.microsoft.com/en-us/azure/databricks/security/keys/double-encryption?WT.mc_id=Portal-Microsoft_Azure_Databricks) if you have requirement for FIPS 140-2. It comes at a cost, it takes time to encrypt and decrypt. By default your data is already encrypted. If you have a standard regulatory requirement (ex. HIPAA).\n\n- (Optional) [Compliance security profile](https://learn.microsoft.com/en-us/azure/databricks/security/privacy/security-profile)- for HIPAA.\n\n- (Optional) Automatic cluster updates, First Sunday of every Month.\n\n- Review + Create the workspace and wait for it to deploy.\n\n##### **Step 4: Create a private endpoint to support SSO for web browser access:**\n\n**Note**: This step is required when front-end Private Link is enabled, and client networks cannot access the public internet.\n\nAfter creating your Azure Databricks workspace, if you try to launch it without the proper Private Link configuration, you will see an error like the image below:\n\nThis happens because the workspace is configured to block public network access, and the necessary Private Endpoints (including the browser\\_authentication endpoint for SSO) are not yet in place.\n\n**Create Web-Auth Workspace**\n\n**Note**: Deploy a “dummy”: WEB\\_AUTH\\_DO\\_NOT\\_DELETE\\_&lt;region&gt; workspace in the same region as your production workspace. Purpose: Host the browser\\_authentication private endpoint (one required per region). Lock the workspace (Delete lock) to prevent accidental removal.\n\n- Follow step 2 to create Virtual Network (Vnet)\n\n- Follow step 3 and create a VNet injected “dummy” workspace.\n\n**Create Browser Authentication Private Endpoint**\n\n- In Azure Portal, Databricks workspace (dummy), Networking, Private endpoint connections, + Private endpoint.\n\n**Resource step:**\n\n- Target sub-resource: browser\\_authentication\n\n**Virtual Network step:**\n\n- **VNet**: Transit/Hub VNet (central network for Private Link)\n- **Subnet**: Private Endpoint subnet in that VNet (not Databricks host subnets)\n\n**DNS step:**\n\n- Integrate with Private DNS zone: Yes\n\n- Zone: privatelink.azuredatabricks.net\n- Ensure DNS zone is linked to the Transit VNet\n\n**After creation:**\n\n- A-records for \\*.pl-auth.azuredatabricks.net are auto-created in the DNS zone.\n\n1. **Workspace Connectivity Testing**\n\n- If you have VPN or ExpressRoute, Bastion is not required. However, for the purposes of this article we will be testing our workpace connectivity through Bastion.\n\n- If you don’t have private connectivity and need to test from inside the VNet, Azure Bastion is a convenient option.\n\n##### **Step 5: Create Storage Account**\n\nFrom your Resource Group, click Create and select Storage account.\n\n**On the configuration page:**\n\n- Select Preferred Storage type as: Azure Blob Storage or Azure Data Lake Storage Gen 2.\n\n- Choose Performance and Redundancy options based on your business requirements.\n\n- Click Next to proceed.\n\n**Under the Advanced tab:**\n\n- Enable Hierarchical namespace under Data Lake Storage Gen2.\n- This is critical for: Directory and file-level operations, Access Control Lists (ACLs).\n\n**Under the Networking tab:**\n\n- Set Public Network Access to Disabled.\n\n- Complete the creation process and then create container(s) inside the storage account.\n\n##### **Step 6: Create Private Endpoints for Workspace Storage Account**\n\n**Pre-requisite:**\n\nYou need to create [two private endpoints](https://learn.microsoft.com/en-us/azure/databricks/security/network/storage/firewall-support#create-private-endpoints-main) from the VNet used for VNet injection to your workspace storage account for the following Target sub-resources: dfs and blob.\n\n- Navigate to your Storage Account.\n- Go to Networking, Private Endpoints tab and click on to + Create Private Endpoint.\n\n**In the Create Private Endpoint wizard:**\n\n**Resource tab:**\n\n- Select your Storage Account.\n- Set Target sub-resource to dfs for the first endpoint.\n\n**Virtual Network tab:**\n\n- Choose the VNet you used for VNet injection.\n- Select the appropriate subnet.\n\n- Complete the creation process. The private endpoint will be auto approved and visible under Private Endpoints.\n\n- Repeat the process for the second private endpoint:\n\n- - This time set Target sub-resource to blob.\n\n##### **Step 7: Link Storage and Databricks Workspace:**\n\n**Create Access Connector**\n\n- In your Resource Group, create an Access Connector for Azure Databricks.\n- No additional configuration is required during creation.\n\n**Assign Role to Access Connector**\n\n- Navigate to your Storage Account, Access Control (IAM), Add role assignment.\n\n- Select:\n- Role: Storage Blob Data Contributor\n\n- - Assign access to: Managed Identity\n\n- Under Members:\n\n- - Click Select members.\n\n- - Find and select your newly created Access Connector for Azure Databricks.\n\n- - Save the role assignment.\n\n**Copy Resource ID**\n\n- Go to the Access Connector Overview page.\n\n- Copy the Resource ID for later use in Databricks configuration.\n\n##### **Step 8: [Link Storage and Databricks Workspace](https://learn.microsoft.com/en-us/azure/databricks/connect/unity-catalog/cloud-storage/external-locations#-option-1-create-an-external-location-using-catalog-explorer):**\n\n**Navigate to Unity Catalog**\n\n- In your Databricks Workspace, go to Unity Catalog, External Data and select “Create external Location” button.\n\n**Configure External Location**\n\n- Select ADLS as the storage type.\n\n- Enter the ADLS storage URL in the following format:\n\n- [abfss://&lt;container\\_name&gt;@&lt;storage\\_account\\_name&gt;.dfs.core.windows.net/](mailto:abfss://%3ccontainer_name%3e@%3cstorage_account_name%3e.dfs.core.windows.net/)\n\n- Update these two parameters: &lt;container\\_name&gt; and &lt;storage\\_name&gt;\n\n**Provide Access Connector**\n\n- Select “Create new storage credential” from Storage credential field.\n- Paste the Resource ID of the Access Connector for Azure Databricks (from Step 10) into the Access Connector ID field.\n\n**Validate Connection**\n\n- Click Submit.\n- You should see a “Successful” message confirming the connection.\n\n- Click submit and you should receive a “Successful” message, indicating your connection has succeeded.\n\n- You can now create Catalogs and link your secure storage.\n\n##### **[Step 9: Configuring Serverless Compute Networking:](https://learn.microsoft.com/en-us/azure/databricks/security/network/serverless-network-security/serverless-firewall#requirements)**\n\nIf your organization plans to use Serverless SQL Warehouses or Serverless Jobs Compute, you must configure Serverless Networking.\n\n**Add Network Connectivity Configuration (NCC)**\n\n- Go to the Databricks Account Console: [https://accounts.azuredatabricks.net/](https://accounts.azuredatabricks.net/)\n- Navigate to Cloud resources, click Add Network Connectivity Configuration.\n- Fill in the required fields and create a new NCC.\n\n**Associate NCC with Workspace**\n\n- In the Account Console, go to Workspaces.\n\n- Select your workspace, click Update Workspace.\n- From the Network Connectivity Configuration dropdown, select the NCC you just created.\n\n**Add Private Endpoint Rule**\n\n- In Cloud resources, select your NCC, select Private Endpoint Rules and click Add Private Endpoint Rule.\n\n- **Provide:**\n- Resource ID: Enter your Storage Account Resource ID.\n\n**Note**: this can be found from your storage account, click on “JSON View” top right.\n\n- Azure Subresource type: dfs & blob.\n\n**Approve Pending Connection**\n\n- Go to your Storage Account, Networking, Private Endpoints.\n\n- You will see a Pending connection from Databricks.\n\n- Approve the connection and you will see the Connection status in your Account Console as ESTABLISHED.\n\n#####\n\n##### **Step 10: Test Your Workspace:**\n\nLaunch a small test cluster and verify the following:\n\n- - It can start (which means it can talk to the control plane).\n\n- - It can read/write from the storage, following the following code to confirm read/write to storage: [Set Spark properties to configure Azure credentials to access Azure storage.](https://learn.microsoft.com/en-us/azure/databricks/connect/storage/azure-storage#set-spark-properties-to-configure-azure-credentials-to-access-azure-storage)\n\n- - Check Private DNS Record has been created.\n\n- - (Optional) If on-prem data is needed: try connecting to an on-prem database (using the ExpressRoute path): [Connect your Azure Databricks workspace to your on-premises network - Azure Databricks | Microsoft Learn.](https://learn.microsoft.com/en-us/azure/databricks/security/network/classic/on-prem-network)\n\n##### **[Step 11: Account Console, Planning Workspace Access Controls and Getting Started:](https://learn.microsoft.com/en-us/azure/databricks/getting-started/)**\n\nOnce your Azure Databricks workspace is deployed, it's essential to configure access controls and begin onboarding users with the right permissions. From your account console: [https://accounts.azuredatabricks.net/,](https://accounts.azuredatabricks.net/) you can centrally manage your environment: add users and groups, enable preview features, and view or configure all your workspaces.\n\nAzure Databricks supports fine-grained access management through Unity Catalog, cluster policies, and workspace-level roles. Start by defining who needs access to what—whether it's notebooks, tables, jobs, or clusters—[and apply least-privilege principles to minimize risk](https://learn.microsoft.com/en-us/azure/databricks/admin/users-groups/).\n\nDBFS Limitation: DBFS is automatically created upon Databricks Workspace creation. DBFS can be found in your Managed Resource Group. Databricks cannot secure DBFS (see reference image below). If there is a business need to avoid DBFS then you can disable DBFS access following instructions here: [Disable access to DBFS root and mounts in your existing Azure Databricks workspace.](https://learn.microsoft.com/en-us/azure/databricks/dbfs/disable-dbfs-root-mounts#disable-dbfs-root-and-mounts)\n\nUse Unity Catalog to manage data access across catalogs, schemas, and tables, and consider implementing cluster policies to standardize compute configurations across teams. To help your teams get started, [Microsoft provides a range of tutorials](https://learn.microsoft.com/en-us/azure/databricks/getting-started/) and best practice guides: [Best practice articles - Azure Databricks | Microsoft Learn.](https://learn.microsoft.com/en-us/azure/databricks/getting-started/best-practices)\n\n##### **[Step 12: Planning Data Migration:](https://techcommunity.microsoft.com/blog/azuremigrationblog/introducing-cloud-accelerate-factory-unlock-zero-cost-deployment-assistance-for-/4409779)**\n\nAs you prepare to move data into your Azure Databricks environment, it's important to assess your migration strategy early. This includes identifying source systems, estimating data volumes, and determining the appropriate ingestion methods—whether batch, streaming, or hybrid. For organizations with complex migration needs or legacy systems, Microsoft offers specialized support through its internal Azure Cloud Accelerated Factory program. Reach out to your Microsoft account team to explore nomination for Azure Cloud Accelerated Factory, which provides hands-on guidance, tooling, and best practices to accelerate and streamline your data migration journey.\n\n#### **Summary**\n\nRegular maintenance and governance are as important as the initial design. Continuously review the environment and update configurations as needed to address evolving requirements and threats. For example, tag all resources (workspaces, VNets, clusters, etc.) with clear identifiers (workspace name, environment, department) to track costs and ownership effectively. Additionally, enforce least privilege across the platform: ensure that only necessary users are given admin privileges, and use cluster-level access control to restrict who can create or start clusters. By following the above steps, an organization will have an Azure Databricks architecture that is securely isolated, well-governed, and scalable.\n\n##### **References:**\n\n- [1] [5 Best Practices for Databricks Workspaces](https://www.databricks.com/blog/2022/03/10/functional-workspace-organization-on-databricks.html)\n\n- [AzureDatabricksBestPractices/toc.md at master · Azure ... - GitHub](https://github.com/Azure/AzureDatabricksBestPractices/blob/master/toc.md)\n\n- [Deploy a workspace using the Azure Portal](https://learn.microsoft.com/en-us/azure/databricks/admin/workspace/create-workspace)\n\n##### **Additional Links:**\n\n- Quick Introduction to Databricks: [what is databricks | introduction - databricks for dummies](https://www.youtube.com/watch?v=GGqQqjLrJYI)\n\n- Connect Purview with Azure Databricks: [Integrating Microsoft Purview with Azure Databricks](https://techcommunity.microsoft.com/blog/microsoft-security-blog/step-by-step-guide-integrating-microsoft-purview-with-azure-databricks-and-micro/4459549)\n\n- Secure Databricks Delta Share between Workspaces: [Secure Databricks Delta Share for Serverless Compute](https://techcommunity.microsoft.com/blog/analyticsonazure/secure-delta-sharing-between-databricks-workspaces-using-ncc-and-private-endpoin/4462428)\n\n- Azure-Databricks Cost Optimization Guide: [Databricks Cost Optimization: A Practical Guide](https://techcommunity.microsoft.com/blog/analyticsonazure/azure-databricks-cost-optimization-a-practical-guide/4470235)\n\n- Integrate Azure Databricks with Microsoft Fabric: [Integrating Azure Databricks with Microsoft Fabric](https://techcommunity.microsoft.com/blog/analyticsonazure/approaches-to-integrating-azure-databricks-with-microsoft-fabric-the-better-toge/4453643)\n\n- [Databricks Solution Accelerators for Data & AI](https://www.databricks.com/solutions/accelerators)\n\n- [Azure updates](https://azure.microsoft.com/en-us/updates?id=default-outbound-access-for-vms-in-azure-will-be-retired-transition-to-a-new-method-of-internet-access)\n\n### **Appendix**\n\n##### **3.5 Understanding Data Transfer (Express Route vs. Public Internet)**\n\nFor data transfers, your organization must decide to use ExpressRoute or Internet Egress. There are several considerations that can help you determine your choice:\n\n**3.5.1. Connectivity Model**\n\n• ExpressRoute: Provides a private, dedicated connection between your on-premises infrastructure and Microsoft Azure. It bypasses the public internet entirely and connects through a network service provider. • Internet Egress: Refers to outbound data traffic from Azure to the public internet. This is the default path for most Azure services unless configured otherwise.\n\n##### **3.6 Planning for User-Defined Routes (UDRs)**\n\nWhen working with Databricks deployments—especially in VNet-injected workspaces—setting up User Defined Routes (UDRs) is a smart move. It’s a best practice that helps manage and secure network traffic more effectively. By using UDRs, teams can steer traffic between Databricks components and external services in a controlled way, which not only boosts security but also supports compliance efforts.\n\n**3.6.1 UDRs and Hub and Spoke Topology** If your Databricks workspace is deployed into your own virtual network (VNet), you’ll need to configure standard user-defined routes (UDRs) to manage traffic flow. In a typical hub-and-spoke architecture, UDRs are used to route all traffic from the spoke VNets to the hub VNet.\n\n**3.6.2 Hub and Spoke with VWANHUB** If your Databricks workspace is deployed into your own virtual network (VNet) and is peered to a Virtual WAN (VWAN) hub as the primary connectivity hub into Azure, a user-defined route (UDR) is not required—provided that a private traffic routing policy or internet traffic routing policy is configured in the VWAN hub.\n\n**3.6.3 Use of NVAs and Service Tags**\n\nFor Databricks traffic, you’ll need to assign a UDR to the Databricks-managed VNet with a next hop type of Network Virtual Appliance (NVA)—this could be an Azure Firewall, NAT Gateway, or another routing device. For control plane traffic, Databricks recommends using Azure service tags, which are logical groupings of IP addresses for Azure services and should be routed with the next hop type of internet. This is important because Azure IP ranges can change frequently as new resources are provisioned, and manually maintaining IP lists is not practical. Using service tags ensures that your routing rules automatically stay up to date.\n\n**3.6.4 Default Outbound Access Retirement (Non-Serverless Compute) Microsoft****is retiring******default outbound internet access for new deployments starting September 30,2025. Going forward, outbound connectivity will require an explicit configuration using an NVA, NAT Gateway, Load Balancer, or Public IP address. Also, note that using a Public IP Address in the deployment is discouraged for Security purposes, and it is recommended to deploy the workspace in a ‘Secure Cluster Connectivity ration.” Configure connectivity will require an explicit configuration using an NVA, NAT Gateway, Load Balancer, or Public IP address. Also, note that using a Public IP Address in the deployment is discouraged for Security purposes, and it is recommended to deploy the workspace in a ‘Secure Cluster Connectivity ration.”\n\nUpdated Nov 26, 2025\n\nVersion 1.0\n\n[analytics](/tag/analytics?nodeId=board%3AAnalyticsonAzure)\n\n[azure](/tag/azure?nodeId=board%3AAnalyticsonAzure)\n\n[azure databricks](/tag/azure%20databricks?nodeId=board%3AAnalyticsonAzure)\n\n[!\\[Rafia_Aqil&#x27;s avatar\\](https://techcommunity.microsoft.com/t5/s/gxcuf89792/images/dS0zMDcyNDQwLUZEQmYzMQ?image-coordinates=60%2C75%2C544%2C559&amp;image-dimensions=50x50)](/users/rafia_aqil/3072440) [Rafia_Aqil](/users/rafia_aqil/3072440) ![Icon for Microsoft rank](https://techcommunity.microsoft.com/t5/s/gxcuf89792/images/cmstNC05WEo0blc?image-dimensions=100x16&amp;constrain-image=true)Microsoft\n\nJoined June 13, 2025\n\n[View Profile](/users/rafia_aqil/3072440)\n\n/category/azure/blog/analyticsonazure [Analytics on Azure Blog](/category/azure/blog/analyticsonazure) Follow this blog board to get notified when there's new activity",
  "Title": "Guide for Architecting Azure-Databricks: Design to Deployment",
  "ProcessedDate": "2025-11-26 23:04:45",
  "Link": "https://techcommunity.microsoft.com/t5/analytics-on-azure-blog/guide-for-architecting-azure-databricks-design-to-deployment/ba-p/4473095",
  "FeedName": "Microsoft Tech Community",
  "Tags": [],
  "FeedUrl": "https://techcommunity.microsoft.com/t5/s/gxcuf89792/rss/Category?category.id=Azure",
  "PubDate": "2025-11-26T22:54:24+00:00",
  "OutputDir": "_community",
  "Description": "***Author's:** Chris Walk* [cwalk​](javascript:void%280%29)*, Dan Johnson* [danjohn1234​](javascript:void%280%29)*, Eduardo dos Santos* [eduardomdossantos​](javascript:void%280%29)*, Ted Kim* [tekim​](javascript:void%280%29)*, Eric Kwashie [ekwashie​](javascript:void%280%29), Chris Hayes* [Chris_Haynes​](javascript:void%280%29)*, Tayo Akigbogun [takigbogun​](javascript:void%280%29) and Rafia Aqil [Rafia_Aqil​](javascript:void%280%29)*\n\n*Peer Reviewed: Mohamed Sharaf [mohamedsharaf​](javascript:void%280%29)*\n\n**Note****:** This article does not cover the Serverless Workspace option, which is currently in [Private Preview](https://learn.microsoft.com/en-us/azure/databricks/admin/workspace/serverless-workspaces). We plan to update this article once Serverless Workspaces are Generally Available. Also, while Terraform is the recommended method for production deployments due to its automation and repeatability, for simplicity in this article we will demonstrate deployment through the Azure portal.\n\n## **DESIGN: Architecting a Secure Azure Databricks Environment**\n\n#### **Step 1: Plan Workspace, Subscription Organization, Analytics Architecture and Compute**\n\nPlanning your Azure Databricks environment can follow various arrangements depending on your organization’s structure, governance model, and workload requirements. The following guidance outlines key considerations to help you design a well-architected foundation.\n\n##### **1.1 Align Workspaces with Business Units**\n\nA recommended best practice is to align each Azure Databricks workspace with a specific business unit. This approach—often referred to as the “Business Unit Subscription” design pattern—offers several operational and governance advantages.\n\n- - Streamlined Access Control: Each unit manages its own workspace, simplifying permissions and reducing cross-team access risks. For example, Sales can securely access only their data and notebooks.\n\n- - Cost Transparency: Mapping workspaces to business units enables accurate cost attribution and supports internal chargeback models. Each workspace can be tagged to a cost center for visibility and accountability. Even within the same workspace, [costs can be controlled using system tables](https://learn.microsoft.com/en-us/azure/databricks/admin/usage/?utm_source=chatgpt.com) that provide detailed usage metrics and resource consumption insights.\n\nChallenges to keep-in-mind: While per-BU workspaces have high impact, be mindful of workspace sprawl. If every small team spins up its own workspace, you might end up with dozens or hundreds of workspaces, which introduces management overhead. Databricks recommends a reasonable upper limit (on Azure, roughly 20–50 workspaces per account/subscription) because managing “collaboration, access, and security across hundreds of workspaces can become extremely difficult, even with good automation” [\\[1\\]](https://www.databricks.com/blog/2022/03/10/functional-workspace-organization-on-databricks.html). Each workspace will need governance (user provisioning, monitoring, compliance checks), so there is a balance to strike.\n\n##### **[1.2 Workspace Alignment and Shared Metastore Strategy](https://learn.microsoft.com/en-us/azure/databricks/data-governance/unity-catalog/best-practices)**\n\nAs you align workspaces with business units, it's essential to understand how Unity Catalog and the metastore fit into your architecture. [Unity Catalog is Databricks’](https://learn.microsoft.com/en-us/azure/databricks/data-governance/unity-catalog/#metastore) unified governance layer that centralizes access control, auditing, and data lineage across workspaces. Each Unity Catalog is backed by a metastore, which acts as the central metadata repository for tables, views, volumes, and other data assets. In Azure Databricks, you can have one metastore per region, and all workspaces within that region share it. This enables consistent governance and simplifies data sharing across teams. If your organization spans multiple regions, you’ll need to plan for [cross-region sharing](https://learn.microsoft.com/en-us/azure/databricks/data-governance/unity-catalog/best-practices#x-region), which Unity Catalog supports through [Delta Sharing](https://learn.microsoft.com/en-us/azure/databricks/delta-sharing/). By aligning workspaces with business units and connecting them to a shared metastore, you ensure that governance policies are enforced uniformly, while still allowing each team to manage its own data assets securely and independently.\n\n##### **[1.3 Distribute Workspaces Across Subscriptions](https://github.com/Azure/AzureDatabricksBestPractices/blob/master/toc.md#deploy-workspaces-in-multiple-subscriptions-to-honor-azure-capacity-limits)**\n\nWhen scaling Azure Databricks, consider not just the number of workspaces, but also how to distribute them across Azure subscriptions. Using multiple Azure subscriptions can serve both organizational needs and technical requirements:\n\n- - Environment Segmentation (Dev/Test/Prod): A common pattern is to put production workspaces in a separate Azure subscription from development or test workspaces. This provides an extra layer of isolation. Microsoft highly recommends separating workspaces into prod and dev, in separate subscriptions. This way, you can apply stricter Azure policies or network rules to the prod subscription and keep the dev subscription a bit more open for experimentation without risking prod resources.\n\n- - Honor [Azure Resource Limits](https://learn.microsoft.com/en-us/azure/azure-resource-manager/management/azure-subscription-service-limits): Azure subscriptions come with certain capacity limits and [Azure Databricks workspaces](https://learn.microsoft.com/en-us/azure/databricks/resources/limits) have their own limits (since it’s a multi-tenant PaaS). If you put all workspaces in one subscription, or all teams in one workspace, you might hit those limits.\n\nMost enterprises naturally end up with multiple subscriptions as they grow – planning this early avoids later migration headaches. If you currently have everything in one subscription, evaluate usage and consider splitting off heavy workloads or prod workloads into a new one to adhere to best practices.\n\n##### **[1.4 Consider Completing Azure Landing Zone Assessment](https://learn.microsoft.com/en-us/assessments/21765fea-dfe6-4bc4-8bb7-db9df5a6f6c0/)**\n\nWhen evaluating and planning your next deployment, it’s essential to ensure that your current landing zone aligns with Microsoft best practices. This helps establish a robust Databricks architecture and minimizes the risk of avoidable issues. Additionally, customers who are early in their cloud journey can benefit from Cloud Assessments—such as an Azure Landing Zone Review and a review of the [“Prepare for Cloud Adoption” documentation](https://learn.microsoft.com/en-us/azure/cloud-adoption-framework/ready/)—to build a strong foundation.\n\n##### **1.5 Planning Your Azure Databricks Workspace Architecture**\n\nYour workspace architecture should reflect the operational model of your organization and support the workloads you intend to run, from exploratory notebooks to production-grade ETL pipelines. To support your planning, Microsoft provides several reference architectures that illustrate well-architected patterns for Databricks deployments. These solution ideas can serve as starting points for designing maintainable environments: Simplified Architecture: [Modern Data Platform Architecture,](https://learn.microsoft.com/en-us/azure/architecture/solution-ideas/articles/small-medium-modern-data-platform) ETL-Intensive Workload Reference Architecture: [Building ETL Intensive Architecture](https://learn.microsoft.com/en-us/azure/architecture/solution-ideas/articles/ingest-etl-stream-with-adb), End-to-End Analytics Architecture: [Create a Modern Analytics Architecture.](https://learn.microsoft.com/en-us/azure/architecture/solution-ideas/articles/azure-databricks-modern-analytics-architecture)\n\n##### **1.6 Planning for that “Right” Compute**\n\nChoosing the right compute setup in Azure Databricks is crucial for optimizing performance and controlling costs, as [billing is based on Databricks Units (DBUs)](https://azure.microsoft.com/en-us/pricing/details/databricks/) using a per-second pricing model.\n\n- - **Classic Compute:** [You can fine-tune your own compute](https://learn.microsoft.com/en-us/azure/databricks/compute/cluster-config-best-practices) by enabling auto-termination and autoscaling, using Photon acceleration, leveraging spot instances, selecting the right VM type and node count for your workload, and choosing SSDs for performance or HDDs for archival storage.\n\n- - - Preferred by mature internal teams and developers who need advanced control over clusters—such as custom VM selection, tuning, and specialized configurations.\n\n- - **Serverless Compute:** Alternatively, [managed services](https://learn.microsoft.com/en-us/azure/databricks/compute/serverless/best-practices) can simplify operations with built-in optimizations.\n\n- - - Removes infrastructure management and offers instant scaling without cluster warm-up, making it ideal for agility and simplicity.\n\n#### **Step 2: Plan the “Right” CIDR Range (Classic Compute)**\n\n**Note**: You can skip this step if you plan to use serverless compute for all your resources, as CIDR range planning is not required in serverless deployments.\n\nWhen planning CIDR ranges for your Azure Databricks workspace, it's important to ensure your virtual network has enough IP address capacity to support cluster scaling. Why this matters: If you choose a small VNet address space and your analytics workloads grow, you might hit a ceiling where you simply cannot launch more clusters or scale-out because there are no free IPs in the subnet. The subnet sizes—and by extension, the VNet CIDR—determine how many nodes you can. Databricks recommends using a CIDR block between /16 and /24 for the VNet, and up to /26 for the two required subnets: the container subnet and the host subnet. Here’s a [reference Microsoft provides](https://learn.microsoft.com/en-us/azure/databricks/security/network/classic/vnet-inject#address-space-and-maximum-cluster-nodes).\n\n![]()\n\nIf your current workspace’s VNet lacks sufficient IP space for active cluster nodes, you can request a CIDR range update through your Azure Databricks account team as noted in the [Microsoft documentation](https://learn.microsoft.com/en-us/azure/databricks/security/network/classic/vnet-inject#address-space-and-maximum-cluster-nodes:~:text=/26.-,Important,-You%20can%27t%20replace).\n\n##### **2.1 Considerations for CIDR Range**\n\n- - Workload Type & Concurrency: Consider what kinds of workloads will run (ETL Pipelines, Machine Learning Notebooks, BI Dashboards, etc.) and how many jobs or clusters may need to run in parallel. High concurrency (e.g. multiple ETL jobs or many interactive clusters) means more nodes running at the same time, requiring a larger pool of IP addresses.\n\n- - Data Volume (Historical vs. Incremental): Are you doing a one-time historical data load or only processing new incremental data? A large backfill of terabytes of data may require spinning up a very large cluster (hundreds of nodes) to process in a reasonable time. Ongoing smaller loads might get by with fewer nodes. Estimate how much data needs processing.\n\n- - Transformation Complexity: The complexity of data transformations or machine learning workloads matters. Heavy transformations (joins, aggregations on big data) or complex model training can benefit more workers. If your use cases include these, you may need larger clusters (more nodes) to meet performance SLAs, which in turn demands more IP addresses available in the subnet.\n\n- - Data Sources and Integration: Consider how your Databricks environment will connect to data. If you have multiple data sources or sinks (e.g. ingest from many event hubs, databases, or IoT streams), you might design multiple dedicated clusters or workflows, potentially all active at once. Also, if using separate job clusters per job (Databricks Jobs), multiple clusters might launch concurrently. All these scenarios increase concurrent node count.\n\n##### **[2.2 Configuring a Dedicated Network (VNet) per Workspace with Egress Control](https://learn.microsoft.com/en-us/azure/databricks/security/network/classic/vnet-inject)**\n\nBy default, Azure Databricks deploys its classic compute resources into a Microsoft-managed virtual network (VNet) within your Azure subscription. While this simplifies setup, it limits control over network configuration. For enhanced security and flexibility, it's recommended to use [VNet Injection](https://learn.microsoft.com/en-us/azure/databricks/security/network/classic/vnet-inject), which allows you to deploy the compute plane into your own customer-managed VNet. This approach enables secure integration with other Azure services using service endpoints or private endpoints, supports user-defined routes for accessing on-premises data sources, allows traffic inspection via network virtual appliances or firewalls, and provides the ability to configure custom DNS and enforce egress restrictions through network security group (NSG) rules.\n\nWithin this VNet (which must reside in the same region and subscription as the Azure Databricks workspace), two subnets are required for Azure Databricks: a container subnet (referred to as private subnet) and a host subnet (referred to as public subnet). To implement front-end Private Link, back-end Private Link, or both, your workspace VNet needs a third subnet that will contain the private endpoint (PrivateLink subnet). It is recommended to also deploy an Azure Firewall for egress control.\n\n#### **Step 3: Plan Network Architecture for Securing Azure-Databricks**\n\n##### **[3.1 Secure Cluster Connectivity](https://learn.microsoft.com/en-us/azure/databricks/security/network/classic/secure-cluster-connectivity#secure-cluster-connectivity-overview)**\n\nSecure Cluster Connectivity, also known as No Public IP (NPIP), is a foundational security feature for Azure Databricks deployments. When enabled, it ensures that compute resources within the customer-managed virtual network (VNet) do not have public IP addresses, and no inbound ports are exposed. Instead, each cluster initiates a secure outbound connection to the Databricks control plane using port 443 (HTTPS), through a dedicated relay. This tunnel is used exclusively for administrative tasks, separate from the web application and REST API traffic, significantly reducing the attack surface. For the most secure deployment, Microsoft and Databricks strongly recommend enabling Secure Cluster Connectivity, especially in environments with strict compliance or regulatory requirements. When Secure Cluster Connectivity is enabled, both workspace subnets become private, as cluster nodes don’t have public IP addresses.\n\n##### **3.2 Egress with VNet Injection (NVA)**\n\nFor Databricks traffic, you’ll need to assign a UDR to the Databricks-managed VNet with a next hop type of Network Virtual Appliance (NVA)—this could be an Azure Firewall, NAT Gateway, or another routing device. For control plane traffic, Databricks recommends using Azure service tags, which are logical groupings of IP addresses for Azure services and should be routed with the next hop type of internet. This is important because Azure IP ranges can change frequently as new resources are provisioned, and manually maintaining IP lists is not practical. Using service tags ensures that your routing rules automatically stay up to date.\n\n##### **[3.3 Front-End Connectivity with Azure Private Link (Standard Deployment)](https://learn.microsoft.com/en-us/azure/databricks/security/network/classic/private-link-standard#introduction-to-front-end-connections-in-a-standard-deployment)**\n\nTo further enhance security, Azure Databricks supports Private Link for front-end connections. In a standard deployment, Private Link enables users to access the Databricks web application, REST API, and JDBC/ODBC endpoints over a private VNet interface, bypassing the public internet.\n\nFor organizations with no public internet access from user networks, a browser authentication private endpoint is required. This endpoint supports SSO login callbacks from Microsoft Entra ID and is shared across all workspaces in a region using the same private DNS zone. It is typically hosted in a transit VNet that bridges on-premises networks and Azure. Note: There are two deployment types: [standard](https://learn.microsoft.com/en-us/azure/databricks/security/network/classic/private-link-standard#introduction-to-front-end-connections-in-a-standard-deployment) and [simplified](https://learn.microsoft.com/en-us/azure/databricks/security/network/classic/private-link-simplified#diagrams). To compare these deployment types, see [Choose standard or simplified deployment](https://learn.microsoft.com/en-us/azure/databricks/security/network/classic/private-link#deployment-type).\n\n##### **[3.4 Serverless Compute Networking](https://learn.microsoft.com/en-us/azure/databricks/security/network/serverless-network-security/)**\n\nAzure Databricks offers serverless compute options that simplify infrastructure management and accelerate workload execution. These resources run in a Databricks-managed serverless compute plane, isolated from the public internet and connected to the control plane via the Microsoft backbone network.\n\nTo secure outbound traffic from serverless workloads, administrators can configure Serverless Egress Control using network policies that restrict connections by location, FQDN, or Azure resource type. Additionally, Network Connectivity Configurations (NCCs) allow centralized management of private endpoints and firewall rules. NCCs can be attached to multiple workspaces and are essential for enabling secure access to Azure services like Data Lake Storage from serverless SQL warehouses.\n\n## **DEPLOYMENT: Step-to-Step Implementation using Azure Portal**\n\n##### **Step 1: Create an Azure Resource Group**\n\nFor each new workspace, create a dedicated Resource Group (to contain the Databricks workspace resource and associated resources). Ensure that all resources are deployed in the same Region and Resource Group (i.e. workspace, subnets...) to optimize data movement performance and enhance security.\n\n##### **Step 2: Deploy Workspace Specific Virtual Network (VNET)**\n\n- From your Resource Group, create a Virtual Network.\n\n- Under the Security section, enable Azure Firewall.\n- Deploying an Azure Firewall is recommended for egress control, ensuring that outbound traffic from your Databricks environment is securely managed.\n\n![]()\n- Define address spaces for your Virtual Network (Review Step 2 from Design).\n\n- [As documented,](https://learn.microsoft.com/en-us/azure/databricks/security/network/classic/private-link-standard#create-vnet) you could create a VNet with these values:\n\n- - IP range: First remove the default IP range, and then add IP range 10.28.0.0/23.\n\n- - Create subnet public-subnet with range 10.28.0.0/25.\n\n- - Create subnet private-subnet with range 10.28.0.128/25.\n\n- - Create subnet private-link with range 10.28.1.0/27.\n\n**Please note:** your IP values can be different depending on your IPAM and available scopes.\n\n![]()\n- Review + Create your Virtual Network.\n\n##### **Step 3: Deploy Azure-Databricks Workspace:**\n\nNow that networking is in place, create the Databricks workspace. Below are detailed steps your organization should review while creating workspace creation:\n\n- In Azure Portal, search for Azure Databricks and click Create.\n\n- Choose the Subscription, RG, Region, select Premium, enter in “Managed Resource Group name” and click Next.\n\n- Managed Resource Group- will be created after your Databrick workspace is deployed and contains infrastructure resources for the workspace i.e. VNets, DBFS.\n\n- Required: Enable “Secure Cluster Connectivity” (No Public IP for clusters), to ensure that Databricks clusters are deployed without public IP addresses (Review Section 3.1).\n\n- Required: Enable the option to deploy into your Virtual Network (VNet Injection), also known as “Bring Your Own VNet” (Review Section 3.2).\n- Select the Virtual Network created in Step 2.\n\n![]()\n- Enter Private, Public Subnet Names.\n\n![]()\n- Enable or Disable “Deploying Nat Gateway”, according to your workspace requirement.\n\n- Disable “Allow Public Network Access”.\n- Select “No Azure Databricks Rules” for Required NSG Rules.\n\n![]()\n- Select “Click on add to create a private endpoint”, this will open a panel for private endpoint setup.\n\n- Click “Add” to enter your Private Link details created in Step 2.\n- Also, ensure that Private DNS zone integration is set to “Yes” and that a new Private DNS Zone is created, indicated by (New)privatelink.azuredatabricks.net. Unless an existing DNS zone for this purpose already exists.\n\n![]()\n- (Optional) Under Encryption Tab, [Enable Infrastructure Encryption,](https://learn.microsoft.com/en-us/azure/databricks/security/keys/double-encryption?WT.mc_id=Portal-Microsoft_Azure_Databricks) if you have requirement for FIPS 140-2. It comes at a cost, it takes time to encrypt and decrypt. By default your data is already encrypted. If you have a standard regulatory requirement (ex. HIPAA).\n\n![]()\n- (Optional) [Compliance security profile](https://learn.microsoft.com/en-us/azure/databricks/security/privacy/security-profile)- for HIPAA.\n\n![]()\n- (Optional) Automatic cluster updates, First Sunday of every Month.\n\n![]()\n- Review + Create the workspace and wait for it to deploy.\n\n##### **Step 4: Create a private endpoint to support SSO for web browser access:**\n\n**Note**: This step is required when front-end Private Link is enabled, and client networks cannot access the public internet.\n\n![]()\n\nAfter creating your Azure Databricks workspace, if you try to launch it without the proper Private Link configuration, you will see an error like the image below:\n\n![]()\n\nThis happens because the workspace is configured to block public network access, and the necessary Private Endpoints (including the browser\\_authentication endpoint for SSO) are not yet in place.\n\n**Create Web-Auth Workspace**\n\n**Note**: Deploy a “dummy”: WEB\\_AUTH\\_DO\\_NOT\\_DELETE\\_ workspace in the same region as your production workspace. Purpose: Host the browser\\_authentication private endpoint (one required per region). Lock the workspace (Delete lock) to prevent accidental removal.\n\n- Follow step 2 to create Virtual Network (Vnet)\n\n![]()\n- Follow step 3 and create a VNet injected “dummy” workspace.\n\n![]()\n\n**Create Browser Authentication Private Endpoint**\n\n![]()\n- In Azure Portal, Databricks workspace (dummy), Networking, Private endpoint connections, + Private endpoint.\n\n![]()\n\n**Resource step:**\n\n- Target sub-resource: browser\\_authentication\n\n![]()\n\n**Virtual Network step:**\n\n- **VNet**: Transit/Hub VNet (central network for Private Link)\n- **Subnet**: Private Endpoint subnet in that VNet (not Databricks host subnets)\n\n![]()\n\n**DNS step:**\n\n- Integrate with Private DNS zone: Yes\n\n- Zone: privatelink.azuredatabricks.net\n- Ensure DNS zone is linked to the Transit VNet\n\n![]()\n\n**After creation:**\n\n- A-records for \\*.pl-auth.azuredatabricks.net are auto-created in the DNS zone.\n\n1. **Workspace Connectivity Testing**\n\n- If you have VPN or ExpressRoute, Bastion is not required. However, for the purposes of this article we will be testing our workpace connectivity through Bastion.\n\n- If you don’t have private connectivity and need to test from inside the VNet, Azure Bastion is a convenient option.\n\n##### **Step 5: Create Storage Account**\n\nFrom your Resource Group, click Create and select Storage account.\n\n**On the configuration page:**\n\n- Select Preferred Storage type as: Azure Blob Storage or Azure Data Lake Storage Gen 2.\n\n![]()\n- Choose Performance and Redundancy options based on your business requirements.\n\n- Click Next to proceed.\n\n**Under the Advanced tab:**\n\n- Enable Hierarchical namespace under Data Lake Storage Gen2.\n- This is critical for: Directory and file-level operations, Access Control Lists (ACLs).\n\n![]()\n\n**Under the Networking tab:**\n\n- Set Public Network Access to Disabled.\n\n![]()\n- Complete the creation process and then create container(s) inside the storage account.\n\n##### **Step 6: Create Private Endpoints for Workspace Storage Account**\n\n**Pre-requisite:**\n\nYou need to create [two private endpoints](https://learn.microsoft.com/en-us/azure/databricks/security/network/storage/firewall-support#create-private-endpoints-main) from the VNet used for VNet injection to your workspace storage account for the following Target sub-resources: dfs and blob.\n\n- Navigate to your Storage Account.\n- Go to Networking, Private Endpoints tab and click on to + Create Private Endpoint.\n\n![]()\n\n**In the Create Private Endpoint wizard:**\n\n**Resource tab:**\n\n- Select your Storage Account.\n- Set Target sub-resource to dfs for the first endpoint.\n\n![]()\n\n**Virtual Network tab:**\n\n- Choose the VNet you used for VNet injection.\n- Select the appropriate subnet.\n\n![]()\n- Complete the creation process. The private endpoint will be auto approved and visible under Private Endpoints.\n\n- Repeat the process for the second private endpoint:\n\n- - This time set Target sub-resource to blob.\n\n![]()\n\n##### **Step 7: Link Storage and Databricks Workspace:**\n\n**Create Access Connector**\n\n- In your Resource Group, create an Access Connector for Azure Databricks.\n- No additional configuration is required during creation.\n\n![]()\n\n**Assign Role to Access Connector**\n\n- Navigate to your Storage Account, Access Control (IAM), Add role assignment.\n\n- Select:\n- Role: Storage Blob Data Contributor\n\n![]()\n- - Assign access to: Managed Identity\n\n![]()\n- Under Members:\n\n- - Click Select members.\n\n- - Find and select your newly created Access Connector for Azure Databricks.\n\n- - Save the role assignment.\n\n![]()\n\n**Copy Resource ID**\n\n- Go to the Access Connector Overview page.\n\n- Copy the Resource ID for later use in Databricks configuration.\n![]()\n\n##### **Step 8: [Link Storage and Databricks Workspace](https://learn.microsoft.com/en-us/azure/databricks/connect/unity-catalog/cloud-storage/external-locations#-option-1-create-an-external-location-using-catalog-explorer):**\n\n**Navigate to Unity Catalog**\n\n- In your Databricks Workspace, go to Unity Catalog, External Data and select “Create external Location” button.\n\n![]()\n\n**Configure External Location**\n\n- Select ADLS as the storage type.\n\n- Enter the ADLS storage URL in the following format:\n\n- [abfss://@.dfs.core.windows.net/](mailto:abfss://%3ccontainer_name%3e@%3cstorage_account_name%3e.dfs.core.windows.net/)\n\n- Update these two parameters: and\n\n**Provide Access Connector**\n\n- Select “Create new storage credential” from Storage credential field.\n- Paste the Resource ID of the Access Connector for Azure Databricks (from Step 10) into the Access Connector ID field.\n\n![]()\n\n**Validate Connection**\n\n- Click Submit.\n- You should see a “Successful” message confirming the connection.\n\n![]()\n- Click submit and you should receive a “Successful” message, indicating your connection has succeeded.\n\n![]()\n- You can now create Catalogs and link your secure storage.\n\n![]()\n\n##### **[Step 9: Configuring Serverless Compute Networking:](https://learn.microsoft.com/en-us/azure/databricks/security/network/serverless-network-security/serverless-firewall#requirements)**\n\nIf your organization plans to use Serverless SQL Warehouses or Serverless Jobs Compute, you must configure Serverless Networking.\n\n**Add Network Connectivity Configuration (NCC)**\n\n- Go to the Databricks Account Console: [https://accounts.azuredatabricks.net/](https://accounts.azuredatabricks.net/)\n- Navigate to Cloud resources, click Add Network Connectivity Configuration.\n- Fill in the required fields and create a new NCC.\n\n![]()\n\n**Associate NCC with Workspace**\n\n- In the Account Console, go to Workspaces.\n\n![]()\n- Select your workspace, click Update Workspace.\n- From the Network Connectivity Configuration dropdown, select the NCC you just created.\n\n![]()\n\n**Add Private Endpoint Rule**\n\n- In Cloud resources, select your NCC, select Private Endpoint Rules and click Add Private Endpoint Rule.\n\n![]()\n- **Provide:**\n- Resource ID: Enter your Storage Account Resource ID.\n\n![]()\n\n**Note**: this can be found from your storage account, click on “JSON View” top right.\n\n- Azure Subresource type: dfs & blob.\n\n![]()\n\n**Approve Pending Connection**\n\n- Go to your Storage Account, Networking, Private Endpoints.\n\n![]()\n- You will see a Pending connection from Databricks.\n\n![]()\n- Approve the connection and you will see the Connection status in your Account Console as ESTABLISHED.\n\n![]()\n\n#####\n\n##### **Step 10: Test Your Workspace:**\n\nLaunch a small test cluster and verify the following:\n\n- - It can start (which means it can talk to the control plane).\n\n- - It can read/write from the storage, following the following code to confirm read/write to storage: [Set Spark properties to configure Azure credentials to access Azure storage.](https://learn.microsoft.com/en-us/azure/databricks/connect/storage/azure-storage#set-spark-properties-to-configure-azure-credentials-to-access-azure-storage)\n\n- - Check Private DNS Record has been created.\n\n- - (Optional) If on-prem data is needed: try connecting to an on-prem database (using the ExpressRoute path): [Connect your Azure Databricks workspace to your on-premises network - Azure Databricks | Microsoft Learn.](https://learn.microsoft.com/en-us/azure/databricks/security/network/classic/on-prem-network)\n\n##### **[Step 11: Account Console, Planning Workspace Access Controls and Getting Started:](https://learn.microsoft.com/en-us/azure/databricks/getting-started/)**\n\nOnce your Azure Databricks workspace is deployed, it's essential to configure access controls and begin onboarding users with the right permissions. From your account console: [https://accounts.azuredatabricks.net/,](https://accounts.azuredatabricks.net/) you can centrally manage your environment: add users and groups, enable preview features, and view or configure all your workspaces.\n\n![]()\n\nAzure Databricks supports fine-grained access management through Unity Catalog, cluster policies, and workspace-level roles. Start by defining who needs access to what—whether it's notebooks, tables, jobs, or clusters—[and apply least-privilege principles to minimize risk](https://learn.microsoft.com/en-us/azure/databricks/admin/users-groups/).\n\nDBFS Limitation: DBFS is automatically created upon Databricks Workspace creation. DBFS can be found in your Managed Resource Group. Databricks cannot secure DBFS (see reference image below). If there is a business need to avoid DBFS then you can disable DBFS access following instructions here: [Disable access to DBFS root and mounts in your existing Azure Databricks workspace.](https://learn.microsoft.com/en-us/azure/databricks/dbfs/disable-dbfs-root-mounts#disable-dbfs-root-and-mounts)\n\n![]()\n\nUse Unity Catalog to manage data access across catalogs, schemas, and tables, and consider implementing cluster policies to standardize compute configurations across teams. To help your teams get started, [Microsoft provides a range of tutorials](https://learn.microsoft.com/en-us/azure/databricks/getting-started/) and best practice guides: [Best practice articles - Azure Databricks | Microsoft Learn.](https://learn.microsoft.com/en-us/azure/databricks/getting-started/best-practices)\n\n##### **[Step 12: Planning Data Migration:](https://techcommunity.microsoft.com/blog/azuremigrationblog/introducing-cloud-accelerate-factory-unlock-zero-cost-deployment-assistance-for-/4409779)**\n\nAs you prepare to move data into your Azure Databricks environment, it's important to assess your migration strategy early. This includes identifying source systems, estimating data volumes, and determining the appropriate ingestion methods—whether batch, streaming, or hybrid. For organizations with complex migration needs or legacy systems, Microsoft offers specialized support through its internal Azure Cloud Accelerated Factory program. Reach out to your Microsoft account team to explore nomination for Azure Cloud Accelerated Factory, which provides hands-on guidance, tooling, and best practices to accelerate and streamline your data migration journey.\n\n#### **Summary**\n\nRegular maintenance and governance are as important as the initial design. Continuously review the environment and update configurations as needed to address evolving requirements and threats. For example, tag all resources (workspaces, VNets, clusters, etc.) with clear identifiers (workspace name, environment, department) to track costs and ownership effectively. Additionally, enforce least privilege across the platform: ensure that only necessary users are given admin privileges, and use cluster-level access control to restrict who can create or start clusters. By following the above steps, an organization will have an Azure Databricks architecture that is securely isolated, well-governed, and scalable.\n\n##### **References:**\n\n- [1] [5 Best Practices for Databricks Workspaces](https://www.databricks.com/blog/2022/03/10/functional-workspace-organization-on-databricks.html)\n\n- [AzureDatabricksBestPractices/toc.md at master · Azure ... - GitHub](https://github.com/Azure/AzureDatabricksBestPractices/blob/master/toc.md)\n\n- [Deploy a workspace using the Azure Portal](https://learn.microsoft.com/en-us/azure/databricks/admin/workspace/create-workspace)\n\n##### **Additional Links:**\n\n- Quick Introduction to Databricks: [what is databricks | introduction - databricks for dummies](https://www.youtube.com/watch?v=GGqQqjLrJYI)\n\n- Connect Purview with Azure Databricks: [Integrating Microsoft Purview with Azure Databricks](https://techcommunity.microsoft.com/blog/microsoft-security-blog/step-by-step-guide-integrating-microsoft-purview-with-azure-databricks-and-micro/4459549)\n\n- Secure Databricks Delta Share between Workspaces: [Secure Databricks Delta Share for Serverless Compute](https://techcommunity.microsoft.com/blog/analyticsonazure/secure-delta-sharing-between-databricks-workspaces-using-ncc-and-private-endpoin/4462428)\n\n- Azure-Databricks Cost Optimization Guide: [Databricks Cost Optimization: A Practical Guide](https://techcommunity.microsoft.com/blog/analyticsonazure/azure-databricks-cost-optimization-a-practical-guide/4470235)\n\n- Integrate Azure Databricks with Microsoft Fabric: [Integrating Azure Databricks with Microsoft Fabric](https://techcommunity.microsoft.com/blog/analyticsonazure/approaches-to-integrating-azure-databricks-with-microsoft-fabric-the-better-toge/4453643)\n\n- [Databricks Solution Accelerators for Data & AI](https://www.databricks.com/solutions/accelerators)\n\n- [Azure updates](https://azure.microsoft.com/en-us/updates?id=default-outbound-access-for-vms-in-azure-will-be-retired-transition-to-a-new-method-of-internet-access)\n\n### **Appendix**\n\n##### **3.5 Understanding Data Transfer (Express Route vs. Public Internet)**\n\nFor data transfers, your organization must decide to use ExpressRoute or Internet Egress. There are several considerations that can help you determine your choice:\n\n**3.5.1. Connectivity Model**\n\n• ExpressRoute: Provides a private, dedicated connection between your on-premises infrastructure and Microsoft Azure. It bypasses the public internet entirely and connects through a network service provider. • Internet Egress: Refers to outbound data traffic from Azure to the public internet. This is the default path for most Azure services unless configured otherwise.\n\n##### **3.6 Planning for User-Defined Routes (UDRs)**\n\nWhen working with Databricks deployments—especially in VNet-injected workspaces—setting up User Defined Routes (UDRs) is a smart move. It’s a best practice that helps manage and secure network traffic more effectively. By using UDRs, teams can steer traffic between Databricks components and external services in a controlled way, which not only boosts security but also supports compliance efforts.\n\n**3.6.1 UDRs and Hub and Spoke Topology** If your Databricks workspace is deployed into your own virtual network (VNet), you’ll need to configure standard user-defined routes (UDRs) to manage traffic flow. In a typical hub-and-spoke architecture, UDRs are used to route all traffic from the spoke VNets to the hub VNet.\n\n**3.6.2 Hub and Spoke with VWANHUB** If your Databricks workspace is deployed into your own virtual network (VNet) and is peered to a Virtual WAN (VWAN) hub as the primary connectivity hub into Azure, a user-defined route (UDR) is not required—provided that a private traffic routing policy or internet traffic routing policy is configured in the VWAN hub.\n\n**3.6.3 Use of NVAs and Service Tags**\n\nFor Databricks traffic, you’ll need to assign a UDR to the Databricks-managed VNet with a next hop type of Network Virtual Appliance (NVA)—this could be an Azure Firewall, NAT Gateway, or another routing device. For control plane traffic, Databricks recommends using Azure service tags, which are logical groupings of IP addresses for Azure services and should be routed with the next hop type of internet. This is important because Azure IP ranges can change frequently as new resources are provisioned, and manually maintaining IP lists is not practical. Using service tags ensures that your routing rules automatically stay up to date.\n\n**3.6.4 Default Outbound Access Retirement (Non-Serverless Compute) Microsoft** **is retiring** **** default outbound internet access for new deployments starting September 30,2025. Going forward, outbound connectivity will require an explicit configuration using an NVA, NAT Gateway, Load Balancer, or Public IP address. Also, note that using a Public IP Address in the deployment is discouraged for Security purposes, and it is recommended to deploy the workspace in a ‘Secure Cluster Connectivity ration.” Configure connectivity will require an explicit configuration using an NVA, NAT Gateway, Load Balancer, or Public IP address. Also, note that using a Public IP Address in the deployment is discouraged for Security purposes, and it is recommended to deploy the workspace in a ‘Secure Cluster Connectivity ration.”",
  "Author": "Rafia_Aqil"
}
