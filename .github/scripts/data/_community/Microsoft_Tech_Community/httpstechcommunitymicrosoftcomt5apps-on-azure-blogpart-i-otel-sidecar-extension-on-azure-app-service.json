{
  "Link": "https://techcommunity.microsoft.com/t5/apps-on-azure-blog/part-i-otel-sidecar-extension-on-azure-app-service-for-linux/ba-p/4469514",
  "PubDate": "2025-11-13T06:28:27+00:00",
  "Description": "**Sidecar extensions** let you attach a companion container to your App Service for Linux app to add capabilities—without changing your core app or container. If you’re new to sidecars on App Service, start here: [Sidecars in Azure App Service](https://learn.microsoft.com/en-us/azure/app-service/overview-sidecar)\n\n**OpenTelemetry (OTEL)** is the vendor-neutral standard for collecting **traces, metrics, and logs**, with auto/manual instrumentation across popular languages and backends. See the official docs for concepts and quick starts. ([OpenTelemetry](https://opentelemetry.io/docs/))\n\nIn this post, we’ll use the new sidecar extension—**OpenTelemetry - Azure Monitor** and show end-to-end setup for a PHP code-based apps (the same extension will also work for other language stacks and container-based apps).\n\n#### Walkthrough: add the OpenTelemetry – Azure Monitor sidecar to a PHP (code-based) app\n\nThis section shows the exact portal steps plus the code/config you need. Your PHP code is in [sidecar-samples/otel-sidecar/php/php-blessed-app at main · Azure-Samples/sidecar-samples](https://github.com/Azure-Samples/sidecar-samples/tree/main/otel-sidecar/php/php-blessed-app).\n\n**1) Create Application Insights and copy the Connection string**\n\nCreate (or reuse) an Application Insights resource and copy the **Connection string** from the Overview blade.\n\n![]()\n\n**2) Create the PHP Web App (Linux)**\n\nCreate an **Azure App Service (Linux)** app and choose any supported **PHP** version (e.g., PHP 8.4).\n\n**3) Set environment variables on the main app**\n\nIn **Environment variables → Application settings**, add:\n\n- OTEL\\_PHP\\_AUTOLOAD\\_ENABLED = true\n# (optional) SCM\\_DO\\_BUILD\\_DURING\\_DEPLOYMENT = true\n\nWhen you add the sidecar extension, these environment variables would be set by default\n- APPLICATIONINSIGHTS\\_CONNECTION\\_STRING =\nOTEL\\_EXPORTER = azuremonitor OTEL\\_EXPORTER\\_OTLP\\_ENDPOINT = http://127.0.0.1:4318 OTEL\\_SERVICE\\_NAME = php-blessed-otel # pick a meaningful name![]()\n\n**4) Get the app code**\n- git clone\ncd php-blessed-app\n\n**5) PHP dependencies (already in composer.json)**\n\nThe repo already includes the OpenTelemetry libraries and auto-instrumentation plugins:\n- {\n\"require\": { \"open-telemetry/sdk\": \"^1.7\", \"open-telemetry/exporter-otlp\": \"^1.3\", \"open-telemetry/opentelemetry-auto-slim\": \"^1.2\", \"open-telemetry/opentelemetry-auto-psr18\": \"^1.1\", \"monolog/monolog\": \"^3.0\", \"open-telemetry/opentelemetry-logger-monolog\": \"^1.0\", \"...\": \"...\" }, \"config\": { \"allow-plugins\": { \"open-telemetry/opentelemetry-auto-slim\": true, \"open-telemetry/opentelemetry-auto-psr18\": true } } }\n\n**6) Minimal bootstrap in index.php**\n- use OpenTelemetry\\API\\Globals;\n\nrequire \\_\\_DIR\\_\\_ . '/vendor/autoload.php';\n\n**7) Startup script (installs PECL extension if missing)**\n\nstartup.sh included in the repo:\n- #!/bin/bash\n# Install OpenTelemetry extension if needed\nif ! php -m | grep -q opentelemetry; then echo \"Installing OpenTelemetry extension...\" pecl install opentelemetry echo \"extension=opentelemetry.so\" > /usr/local/etc/php/conf.d/99-opentelemetry.ini echo \"OpenTelemetry extension installed successfully\" fi\n\n# Start PHP-FPM\necho \"Starting PHP-FPM...\" php-fpm\n\n**8) Deploy the app**\n\nUse your preferred method (GitHub Actions, ZIP deploy, local Git, etc.).\n\n**9) Add the sidecar extension on the Web App**\n\nGo to **Deployment Center → Containers (new) → Add → Sidecar Extension**, pick **Observability: OpenTelemetry – Azure Monitor**, and paste your **Connection string**.\n\n![]()\n\n**10) Map the autoload flag into the sidecar**\n\nOpen the created sidecar container (**Edit container**) and map the autoload flag from the main app:\n\n- **Name:** OTEL\\_PHP\\_AUTOLOAD\\_ENABLED\n- **Value:** OTEL\\_PHP\\_AUTOLOAD\\_ENABLED *(select from the drop-down to reference the app setting)*\n\n![]()\n\n**11) Set the Startup command for PHP**\n\nIn **Configuration (preview) → Stack settings**, set:\n- cp /home/site/wwwroot/default /etc/nginx/sites-enabled/default && nginx -s reload && bash /home/site/wwwroot/startup.sh![]()\n\n**12) Verify telemetry in Application Insights**\n\nAfter the app restarts, open your Application Insights resource and check **Application map**, **Live metrics**, or **Search** for spans with service.name = php-blessed-otel (or the value you set).\n\n![]()\n\n#### Part I — Conclusion\n\nSidecar extensions turn observability into an additive step - with just a few settings and a lightweight startup script. With OTEL wired for PHP, you now have portable traces, metrics, and logs you can query and dashboard.\n\n**Next:** In **Part II**, we’ll connect the same app to **Elastic APM** using the OpenTelemetry – Elastic APM sidecar, with the few settings changes you need.",
  "OutputDir": "_community",
  "EnhancedContent": "**Sidecar extensions** let you attach a companion container to your App Service for Linux app to add capabilities—without changing your core app or container. If you’re new to sidecars on App Service, start here: [Sidecars in Azure App Service](https://learn.microsoft.com/en-us/azure/app-service/overview-sidecar)\n\n**OpenTelemetry (OTEL)** is the vendor-neutral standard for collecting **traces, metrics, and logs**, with auto/manual instrumentation across popular languages and backends. See the official docs for concepts and quick starts. ([OpenTelemetry](https://opentelemetry.io/docs/))\n\nIn this post, we’ll use the new sidecar extension—**OpenTelemetry - Azure Monitor** and show end-to-end setup for a PHP code-based apps (the same extension will also work for other language stacks and container-based apps).\n\n#### Walkthrough: add the OpenTelemetry – Azure Monitor sidecar to a PHP (code-based) app\n\nThis section shows the exact portal steps plus the code/config you need. Your PHP code is in [sidecar-samples/otel-sidecar/php/php-blessed-app at main · Azure-Samples/sidecar-samples](https://github.com/Azure-Samples/sidecar-samples/tree/main/otel-sidecar/php/php-blessed-app).\n\n**1) Create Application Insights and copy the Connection string**\n\nCreate (or reuse) an Application Insights resource and copy the **Connection string** from the Overview blade.\n\n**2) Create the PHP Web App (Linux)**\n\nCreate an **Azure App Service (Linux)** app and choose any supported **PHP** version (e.g., PHP 8.4).\n\n**3) Set environment variables on the main app**\n\nIn **Environment variables → Application settings**, add:\n\n``` OTEL_PHP_AUTOLOAD_ENABLED = true\n# (optional) SCM_DO_BUILD_DURING_DEPLOYMENT = true\n```\n\nWhen you add the sidecar extension, these environment variables would be set by default\n\n``` APPLICATIONINSIGHTS_CONNECTION_STRING = <your-connection-string> OTEL_EXPORTER = azuremonitor OTEL_EXPORTER_OTLP_ENDPOINT = http://127.0.0.1:4318 OTEL_SERVICE_NAME = php-blessed-otel # pick a meaningful name ```\n\n**4) Get the app code**\n\n``` git clone <repo> cd php-blessed-app\n\n```\n\n**5) PHP dependencies (already in composer.json)**\n\nThe repo already includes the OpenTelemetry libraries and auto-instrumentation plugins:\n\n``` { \"require\": { \"open-telemetry/sdk\": \"^1.7\", \"open-telemetry/exporter-otlp\": \"^1.3\", \"open-telemetry/opentelemetry-auto-slim\": \"^1.2\", \"open-telemetry/opentelemetry-auto-psr18\": \"^1.1\", \"monolog/monolog\": \"^3.0\", \"open-telemetry/opentelemetry-logger-monolog\": \"^1.0\", \"...\": \"...\" }, \"config\": { \"allow-plugins\": { \"open-telemetry/opentelemetry-auto-slim\": true, \"open-telemetry/opentelemetry-auto-psr18\": true } } }\n\n```\n\n**6) Minimal bootstrap in index.php**\n\n``` use OpenTelemetry\\API\\Globals;\n\nrequire __DIR__ . '/vendor/autoload.php';\n\n```\n\n**7) Startup script (installs PECL extension if missing)**\n\nstartup.sh included in the repo:\n\n``` #!/bin/bash\n# Install OpenTelemetry extension if needed\nif ! php -m | grep -q opentelemetry; then echo \"Installing OpenTelemetry extension...\" pecl install opentelemetry echo \"extension=opentelemetry.so\" > /usr/local/etc/php/conf.d/99-opentelemetry.ini echo \"OpenTelemetry extension installed successfully\" fi\n\n# Start PHP-FPM\necho \"Starting PHP-FPM...\" php-fpm\n\n```\n\n**8) Deploy the app**\n\nUse your preferred method (GitHub Actions, ZIP deploy, local Git, etc.).\n\n**9) Add the sidecar extension on the Web App**\n\nGo to **Deployment Center → Containers (new) → Add → Sidecar Extension**, pick **Observability: OpenTelemetry – Azure Monitor**, and paste your **Connection string**.\n\n**10) Map the autoload flag into the sidecar**\n\nOpen the created sidecar container (**Edit container**) and map the autoload flag from the main app:\n\n- **Name:** OTEL\\_PHP\\_AUTOLOAD\\_ENABLED\n- **Value:** OTEL\\_PHP\\_AUTOLOAD\\_ENABLED *(select from the drop-down to reference the app setting)*\n\n**11) Set the Startup command for PHP**\n\nIn **Configuration (preview) → Stack settings**, set:\n\n``` cp /home/site/wwwroot/default /etc/nginx/sites-enabled/default && nginx -s reload && bash /home/site/wwwroot/startup.sh ```\n\n**12) Verify telemetry in Application Insights**\n\nAfter the app restarts, open your Application Insights resource and check **Application map**, **Live metrics**, or **Search** for spans with service.name = php-blessed-otel (or the value you set).\n\n#### Part I — Conclusion\n\nSidecar extensions turn observability into an additive step - with just a few settings and a lightweight startup script. With OTEL wired for PHP, you now have portable traces, metrics, and logs you can query and dashboard.\n\n**Next:** In **Part II**, we’ll connect the same app to **Elastic APM** using the OpenTelemetry – Elastic APM sidecar, with the few settings changes you need.\n\nPublished Nov 13, 2025\n\nVersion 1.0\n\n[azure app service](/tag/azure%20app%20service?nodeId=board%3AAppsonAzureBlog)\n\n[azure paas](/tag/azure%20paas?nodeId=board%3AAppsonAzureBlog)\n\n[modern apps](/tag/modern%20apps?nodeId=board%3AAppsonAzureBlog)\n\n[php](/tag/php?nodeId=board%3AAppsonAzureBlog)\n\n[web apps](/tag/web%20apps?nodeId=board%3AAppsonAzureBlog)\n\n[!\\[TulikaC&#x27;s avatar\\](https://techcommunity.microsoft.com/t5/s/gxcuf89792/m_assets/avatars/default/avatar-1.svg?image-dimensions=50x50)](/users/tulikac/1661700) [TulikaC](/users/tulikac/1661700) ![Icon for Microsoft rank](https://techcommunity.microsoft.com/t5/s/gxcuf89792/images/cmstNC05WEo0blc?image-dimensions=100x16&amp;constrain-image=true)Microsoft\n\nJoined December 21, 2022\n\n[View Profile](/users/tulikac/1661700)\n\n/category/azure/blog/appsonazureblog [Apps on Azure Blog](/category/azure/blog/appsonazureblog) Follow this blog board to get notified when there's new activity",
  "Tags": [],
  "ProcessedDate": "2025-11-13 07:05:30",
  "Author": "TulikaC",
  "Title": "Part I: OTEL sidecar extension on Azure App Service for Linux - Intro + PHP walkthrough",
  "FeedName": "Microsoft Tech Community",
  "FeedUrl": "https://techcommunity.microsoft.com/t5/s/gxcuf89792/rss/Category?category.id=Azure",
  "FeedLevelAuthor": "rss.livelink.threads-in-node"
}
