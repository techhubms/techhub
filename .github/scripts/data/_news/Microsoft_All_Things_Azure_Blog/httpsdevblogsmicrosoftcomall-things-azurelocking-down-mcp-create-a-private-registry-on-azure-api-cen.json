{
  "ProcessedDate": "2025-12-04 16:03:14",
  "Author": "tjsingh85",
  "FeedUrl": "https://devblogs.microsoft.com/all-things-azure/feed/",
  "Description": "Ever since MCP launched, every customer has asked the same thing: ‚ÄúHow does a private MCP registry actually work, and how do we configure it for our enterprise?‚Äù. So today, on a snowy, freezing Friday in Zurich, I grabbed a coffe, opened the GitHub docs, dove into Azure API Center portal, and decided to write the [‚Ä¶]\n\nThe post [Locking Down MCP: Create a Private Registry on Azure API Center and Enforce It in GitHub Copilot And VS Code](https://devblogs.microsoft.com/all-things-azure/locking-down-mcp-create-a-private-registry-on-azure-api-center-and-enforce-it-in-github-copilot-and-vs-code/) appeared first on [All things Azure](https://devblogs.microsoft.com/all-things-azure).",
  "FeedLevelAuthor": "All things Azure",
  "FeedName": "Microsoft All Things Azure Blog",
  "Link": "https://devblogs.microsoft.com/all-things-azure/locking-down-mcp-create-a-private-registry-on-azure-api-center-and-enforce-it-in-github-copilot-and-vs-code/",
  "PubDate": "2025-12-04T15:06:03+00:00",
  "Tags": [
    "Developer Productivity",
    "github",
    "GitHub Copilot",
    "MCP",
    "MCP (Model Context Protocol)"
  ],
  "EnhancedContent": "Ever since MCP launched, *every* customer has asked the same thing: **‚ÄúHow does a private MCP registry actually work, and how do we configure it for our enterprise?‚Äù.**\n\nSo today, on a snowy, freezing Friday in Zurich, I grabbed a coffe, opened the GitHub docs, dove into Azure API Center portal, and decided to write the blog I wish already existed.A few hours (and quite a few sighs) later, here I am. The docs are great but they definitely don‚Äôt cover all the tiny quirks, hidden settings, and errors you‚Äôll hit along the way.\n\n#### **What did the journey look like?**\n\n- üìö Reading way too many docs\n- ‚úÖ A data API that *seemed* to work\n- üîí Mysterious **401 Unauthorized** responses\n- üßä A **Save + publish** button permanently frozen in ‚ÄúNope‚Äù mode\n- üö´ **404 Not Found** and VS Code insisting the registry ‚Äúdoes not support version v0.1‚Äù\n- ü§Ø And finally‚Ä¶ the magical, undocumented discovery of\n`/workspaces/default/v0.1/servers`\n\nThis post is the guide I desperately needed: **a clean, step-by-step setup plus every weird error and how to fix it.** Enjoy!\n\n## Two Options: Pick Your MCP Registry Adventure üéí\n\nTo make an MCP registry that GitHub Copilot can actually talk to, you need two non-negotiables:\n\n- **A proper MCP Registry endpoint** that follows the v0.1 specification\n- **CORS enabled** so Copilot/VS Code can reach it from the browser environment\n\nAnd you‚Äôve got two ways to get there:\n\n## Option 1: Self-hosted MCP Registry\n\nSpin up your own service that fully implements the **v0.1 MCP Registry spec** and handles all the CORS requirements.Great for full control but not so great if you‚Äôre not in the mood to maintain yet another service.\n\n## Option 2: Azure API Center (the easy path)\n\nAzure API Center comes with:\n\n- ‚úîÔ∏è Built-in support for the **v0.1 MCP Registry spec**\n- ‚úîÔ∏è CORS configured out of the box\n- ‚úîÔ∏è A nice UI for managing MCP servers\n- ‚úîÔ∏è Zero infrastructure to run yourself\n\nSo for this blog (and for our sanity), **we‚Äôre going with Azure API Center**.\n\n## What We‚Äôre Building üöÄ\n\nWe‚Äôre setting up a **private MCP registry** using **Azure API Center** and wiring it so **GitHub Copilot** and **VS Code** only recognize and use the MCP servers we list there.\n\nIn other words:\n\n- **Azure API Center** becomes our private MCP registry\n- **GitHub Copilot + VS Code** automatically discover the approved MCP servers\n- **Only** those servers are allowed to run on the client\n\n![GitHub + Azure API Center + Vscode](https://cdn-images-1.medium.com/max/1600/1*VZLXH0EjIo56k0Ui6SLhpg.png)\n\n## Step 1: Create Your Azure API Center Instance\n\nIn the Azure portal:\n\n1. Search for **‚ÄúAPI Center‚Äù and** Click **+ Create**.\n2. Fill in:\n\n- **Subscription / Resource group**: choose your usual.\n- **Name**: e.g. `private-mcp-registry`\n.\n- **Region**: e.g. `East US`\n.\n- **SKU**: Free/Standard (Free is fine to experiment).\n\n3. Click **Review + create** ‚Üí **Create**.\n\nOnce deployment is done, open the resource and note the **data-plane endpoint**, which looks like:\n\n`https://private-mcp-registry.data.eastus.azure-apicenter.ms`\n\n![API Center Overview](data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAB9AAAALRAQMAAAA5kqo4AAAAA1BMVEXW1taWrGEgAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAAxklEQVR4nO3BMQEAAADCoPVPbQsvoAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4G8MJAAGUl7PZAAAAAElFTkSuQmCC)\n\n***This host is where the MCP registry will live (we‚Äôll refine the path later).***\n\n## Step 2 : Register MCP Servers\n\nAPI Center gives you two options:\n\n1Ô∏è‚É£ Create and expose **your own MCP server** through API Center, or\n\n2Ô∏è‚É£ Use one of the **pre-listed MCP servers** available in the Discovery section.\n\nIf you want to register your own MCP server, go to **Assets ‚Üí APIs ‚Üí Register an API**, fill in the details, and create a new **MCP-type API**.\n\nOr, if you prefer the easier path, you can use the **preview Discovery feature**, which lets you add ready-made MCP servers to your registry with a single click. Just go to **Discover ‚Üí MCP (preview)** on the left panel.\n\n![MCP Discovery Azure API Center](data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAABXgAAARpAQMAAABOOP3+AAAAA1BMVEXW1taWrGEgAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAA10lEQVR4nO3BgQAAAADDoPlTX+EAVQEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMBvCF0AAa2kE9cAAAAASUVORK5CYII=)\n\nFor this blog, I added **‚ÄúMicrosoft Docs‚Äù** and **‚ÄúAtlassian‚Äù**. Once saved, these MCP servers become part of your registry inventory, and you can view them under **Assets ‚Üí APIs**. For lifecycle management, you can also assign each server to an environment such as production, testing, or development.\n\n![API List on Azure API Center](data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAABXgAAAIlAQMAAABVcgLTAAAAA1BMVEXW1taWrGEgAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAAdElEQVR4nO3BMQEAAADCoPVPbQwfoAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOBveX8AAQQM2wIAAAAASUVORK5CYII=)\n\n## Step 3: Enable the API Center Portal and Anonymous Access\n\n### This is where the fun began for me.\n\nas per GitHub docs, *‚Äúto ensure GitHub Copilot can fetch your registry, in the visibility settings of your API Center, allow anonymous access‚Äù*.I expected a neat ‚ÄúAllow anonymous access‚Äù checkbox somewhere obvious. Instead, I got:\n\n- A **greyed-out ‚ÄúSave + publish‚Äù** button and\n- A `/v0.1/servers`\nendpoint that always returned **401**.\n\nHere‚Äôs the actual order that works.\n\n### Turn on the API Center portal (so Save + publish works)\n\n1. In your API Center resource, in the left menu, find **‚ÄúAPI Center portal‚Äù‚Üí Settings**.\n2. Go to the **Identity provider** tab.\n3. Click **Start set up** (or **Quick setup**).\n4. Complete the wizard\n5. Click **Save + publish**.\n\nUntil you do this, the global **Save + publish** button on the portal settings tends to be disabled or useless.\n\n### Enable anonymous access to the data API\n\n1. Still under **API Center portal ‚Üí Settings**, go to the **API visibility** tab.\n2. Look for **‚ÄúAnonymous access‚Äù**.\n3. Turn it **On**.\n4. Click **Save + publish** again.\n\nWhat this does:\n\n- It allows **unauthenticated read access** to the **data plane API**, so your MCP clients (GitHub, VS Code) can read the registry without dealing with Azure AD tokens.\n- If anonymous access is off, you‚Äôll see **401 Unauthorized** when you hit the registry endpoints.\n\n## Step 4: Find the Real MCP Registry Endpoint\n\nThis was the ‚Äúaha!‚Äù moment.At first, I assumed the registry was at: https://private-mcp-registry.data.eastus.azure-apicenter.ms/v0.1/servers\n\nCalling that gave me: **‚ÄúHTTP/1.1 404 Not Found‚Äù** and VS Code logs like: *The service at* [*https://private-mcp-registry.data.eastus.azure-apicenter.ms*](https://private-mcp-registry.data.eastus.azure-apicenter.ms/) *does not support version v0.1. Service returned status 404.*\n\nThe missing piece: **the registry endpoints live under a workspace**.\n\nAPI Center includes a default workspace, and your MCP registry endpoint **must** include the `workspaces/default` segment in the URL. If you prefer, you can create additional workspaces: just make sure to adjust the URL accordingly.\n\nIf you‚Äôre following this blog with my setup, your MCP registry endpoint will look like this: ‚Äú[https://private-mcp-registry.data.eastus.azure-apicenter.ms/workspaces/default/v0.1/servers](https://private-mcp-registry.data.eastus.azure-apicenter.ms/workspaces/default/v0.1/servers)‚Äù\n\nRun this:\n\n```default curl \"https://private-mcp-registry.data.eastus.azure-apicenter.ms/workspaces/default/v0.1/servers\" ```\n\nIf everything is configured correctly, you should see:\n\n```json { \"servers\": [ { \"server\": { \"$schema\": \"https://static.modelcontextprotocol.io/schemas/2025-09-29/server.schema.json\", \"name\": \"msdocs-mcp-server\", \"description\": \"AI assistant with real-time access to official Microsoft documentation.\", \"version\": \"Original\", \"remotes\": [ { \"type\": \"sse\", \"url\": \"https://learn.microsoft.com/api/mcp\" } ] }, \"_meta\": { \"io.modelcontextprotocol.registry/official\": { \"status\": \"active\", \"createdAt\": \"2025-11-21T10:57:54.753206+00:00\", \"updatedAt\": \"2025-11-21T10:58:01.1231068+00:00\", \"isLatest\": true }, \"x-ms-id\": \"b8c6e77d-f266-4a0a-a341-cc9e97c15280\" } }, { \"server\": { \"$schema\": \"https://static.modelcontextprotocol.io/schemas/2025-09-29/server.schema.json\", \"name\": \"atlassian-mcp-server\", \"description\": \"Connect to Jira and Confluence for issue tracking and documentation.\", \"version\": \"Original\", \"remotes\": [ { \"type\": \"sse\", \"url\": \"https://mcp.atlassian.com/v1/sse\" } ] }, \"_meta\": { \"io.modelcontextprotocol.registry/official\": { \"status\": \"active\", \"createdAt\": \"2025-11-21T10:58:13.1934455+00:00\", \"updatedAt\": \"2025-11-21T10:58:18.6788839+00:00\", \"isLatest\": true }, \"x-ms-id\": \"f9894e12-64f9-49ca-84a1-d01fcd4278c8\" } } ], \"metadata\": { \"count\": 2 } } ```\n\n```\n\n```\n\nThe key is the shape: ***&lt;data endpoint&gt; / workspaces / &lt;workspaceName&gt; / v0.1 / servers***\n\n## Step 5 : Configure GitHub‚Äôs MCP Registry URL\n\nNow that the endpoint works, we need to wire it into GitHub so Copilot and VS Code use it.\n\n*‚ö†Ô∏è Important: in GitHub‚Äôs config, you* ***do not*** *include* `/v0.1/servers` *.You point it at the* ***workspace base URL****, and the GitHub will append* `/v0.1/servers` *.*\n\nIn your GitHub Enterprise or org settings:\n\n1. Go to **Enteprise ‚Üí AI Coontrols ‚ÜíMCP**\n2. Find the **MCP Registry URL** field.\n3. Set it to:`https://private-mcp-registry.data.eastus.azure-apicenter.ms/workspaces/default`\n4. Choose your MCP policy:\n\n- - **Allow all MCP servers**, or\n- **Registry only** (only servers from this registry).\n\n![GitHub MCP Settings](data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAB0kAAAJ1AQMAAACGoVrjAAAAA1BMVEXW1taWrGEgAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAApUlEQVR4nO3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABcGUGFAAGA6tPLAAAAAElFTkSuQmCC)\n\n### Behind the scenes, VS Code will now call:\n\n```default https://private-mcp-registry.data.eastus.azure-apicenter.ms/workspaces/default/v0.1/servers ```\n\n##\n\n## Step 6: Test in VS Code\n\nOnce the enterprise settings have propagated, open VS Code and try accessing your previously installed MCP servers, you‚Äôll notice a **yellow exclamation mark** on them.\n\n![vscode Disabled servers](data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAABXgAAAMfAQMAAABW5C2sAAAAA1BMVEXW1taWrGEgAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAAn0lEQVR4nO3BMQEAAADCoPVP7WsIoAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB4AyVuAAGejbCgAAAAAElFTkSuQmCC)\n\nWhen you select an MCP server that isn‚Äôt part of the private registry enforced by your GitHub policies, VS Code will show a warning message:\n\n***‚ÄúThis MCP server is disabled because it is configured to be disabled in the editor.‚Äù***\n\n![Vscode MCP Server Disabled](data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAABXgAAAMKAQMAAAAF/76EAAAAA1BMVEXW1taWrGEgAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAAnElEQVR4nO3BAQ0AAADCoPdPbQ43oAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAODXABb+AAGuVjnhAAAAAElFTkSuQmCC)\n\nWhen you open the MCP access settings in VS Code, you‚Äôll see that **‚Äúregistry‚Äù** is selected as the control method for installing MCP servers. This setting is enforced by your GitHub policies, so the user cannot toggle it: the option is **greyed out**.\n\n![Vscode MCP settings](data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAABXgAAAJsAQMAAAB9JVl3AAAAA1BMVEXW1taWrGEgAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAAgElEQVR4nO3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwJ8Bqk8AAext2gEAAAAASUVORK5CYII=)\n\nNow let‚Äôs check which MCP servers are available for installation in VS Code. When you type **@MCP** in the extensions section, instead of seeing the full list of servers, you‚Äôll only see the **two MCP servers** we exposed through Azure API Center and included in our private MCP registry.\n\n![Vscode MCP extensions](data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAABIQAAAQAAQMAAACqPRC7AAAAA1BMVEXW1taWrGEgAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAAqElEQVR4nO3BMQEAAADCoPVPbQwfoAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAICXAUgeAAEHZZXRAAAAAElFTkSuQmCC)\n\nAnd to double-confirm that these MCP servers are coming from **your** registry, open the **Output** pane in VS Code and select the **‚ÄúWindow‚Äù** channel. You‚Äôll see the **registry URL** configured from Azure API Center, that‚Äôs where the server list is being fetched from.\n\n![Vscode logs](data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAABXgAAADtAQMAAAA/Vo8jAAAAA1BMVEXW1taWrGEgAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAAP0lEQVR4nO3BAQ0AAADCoPdPbQ43oAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB4MqLwAAHuc0LsAAAAAElFTkSuQmCC)\n\n***In the end, we reached our goal: a fully working private MCP registry in Azure API Center, with two MCP servers securely exposed to GitHub and successfully enforced in VS Code.***\n\n**Note:** *If you don‚Äôt see the correct registry being picked up, simply restart VS Code and try again.*\n\n## Summary\n\nSetting up a private MCP registry with Azure API Center is absolutely possible today, and once you know the correct workspace-scoped endpoint, things work smoothly with GitHub Copilot and VS Code. However, keep in mind that the Azure API Center registry endpoint is public when anonymous access is enabled. Currently, this is acceptable because Copilot integration depends on unauthenticated access. Even so, the ideal long-term approach is a private, authenticated MCP registry endpoint.\n\nThis capability isn‚Äôt supported yet, but I fully expect GitHub to introduce authentication and private-endpoint support in the near future. Until then, users can continue to rely on the public endpoint model.\n\nAlternatively, if you need full control right now, a self-hosted MCP registry offers the most flexibility. In exchange, you‚Äôll need to implement the *v0.1 MCP Registry specification* yourself and also ensure that CORS and endpoint behaviors are properly configured\n\nHopefully this guide saves you the hours I spent chasing 401s, frozen buttons, and mysterious 404s and helps you get your MCP registry up and running without the drama. Happy building! üöÄ\n\n## Troubleshooting\n\n| Issue | Solution | | --- | --- | | 401 Unauthorized | Verify you have the **correct user** role on the Azure API Center resource. | | Save + Publish Button Greyed Out | Enable anonymous access to the APIs | | 404 Not found | MCP registry endpoint **must** include the `workspaces/default`<br> segment in the URL |\n\n## Resources\n\n- [Configure MCP Registry](https://docs.github.com/en/enterprise-cloud@latest/copilot/how-tos/administer-copilot/manage-mcp-usage/configure-mcp-registry)\n- [Microsoft Azure API Center: MCP Overview](https://learn.microsoft.com/en-us/azure/api-management/mcp-server-overview)\n- [Configure MCP Server Access On GitHub](https://docs.github.com/en/enterprise-cloud@latest/copilot/how-tos/administer-copilot/manage-mcp-usage/configure-mcp-server-access)",
  "OutputDir": "_news",
  "Title": "Locking Down MCP: Create a Private Registry on Azure API Center and Enforce It in GitHub Copilot And VS Code"
}
