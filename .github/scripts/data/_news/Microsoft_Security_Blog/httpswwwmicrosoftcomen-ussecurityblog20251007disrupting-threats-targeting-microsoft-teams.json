{
  "FeedName": "Microsoft Security Blog",
  "FeedLevelAuthor": "Microsoft Security Blog",
  "Link": "https://www.microsoft.com/en-us/security/blog/2025/10/07/disrupting-threats-targeting-microsoft-teams/",
  "FeedUrl": "https://www.microsoft.com/en-us/security/blog/feed/",
  "Title": "Disrupting threats targeting Microsoft Teams",
  "Author": "Microsoft Threat Intelligence",
  "ProcessedDate": "2025-10-07 18:03:29",
  "EnhancedContent": "The extensive collaboration features and global adoption of Microsoft Teams make it a high-value target for both cybercriminals and state-sponsored actors. Threat actors abuse its core capabilities – messaging (chat), calls and meetings, and video-based screen-sharing – at different points along the attack chain. This raises the stakes for defenders to proactively monitor, detect, and respond.\n\nWhile under Microsoft’s [Secure Future Initiative](https://www.microsoft.com/en-us/trust-center/security/secure-future-initiative) (SFI), default security has been strengthened by design, defenders still need to make the most out of customer-facing security capabilities. Therefore, this blog recommends countermeasures and controls across identity, endpoints, data apps, and network layers to help harden enterprise Teams environments. To frame these defenses, we first examine relevant stages of the attack chain. This guidance complements, but doesn’t repeat, the guidance built into the [Microsoft Security Development Lifecycle (SDL)](https://www.microsoft.com/sdl/default.aspx) as outlined in the [Teams Security Guide](https://learn.microsoft.com/microsoftteams/teams-security-guide);  we will instead focus on guidance for disrupting adversarial objectives based on the relatively recently observed attempts to exploit Teams infrastructure and capabilities.\n\n## Attack chain\n\n![Diagram showing the stages of attack and relevant attacker behavior abusing Microsoft Teams features ](https://www.microsoft.com/en-us/security/blog/wp-content/uploads/2025/10/Teams-threats-attack-chain.webp)Figure 1. Attack techniques that abuse Teams along the attack chain\n\n### Reconnaissance\n\nEvery Teams user account is backed by a Microsoft Entra ID [identity](https://learn.microsoft.com/microsoftteams/identify-models-authentication). Each team member is an Entra ID [object](https://learn.microsoft.com/entra/identity/hybrid/cloud-sync/concept-attributes), and a team is a collection of channel objects. Teams may be configured for the cloud or a hybrid environment and supports [multi-tenant organizations (MTO)](https://techcommunity.microsoft.com/t5/microsoft-teams-blog/announcing-more-seamless-collaboration-in-microsoft-teams-for/ba-p/3901092) and [cross-tenant](https://support.microsoft.com/office/manage-accounts-and-organizations-in-microsoft-teams-7b221128-6643-465c-a317-679e48cd2ce9) communication and collaboration. There are [anonymous](https://learn.microsoft.com/microsoftteams/anonymous-users-in-meetings) participants, [guests](https://learn.microsoft.com/MicrosoftTeams/guest-access), and [external access](https://learn.microsoft.com/microsoftteams/manage-external-access) users. From an API perspective, Teams is an object type that can be queried and stored in a local database for reconnaissance by enumerating directory objects, and mapping relationships and privileges. For example, [federation tenant configuration](https://learn.microsoft.com/powershell/module/teams/set-cstenantfederationconfiguration?view=teams-ps) indicates whether the tenant allows external communication and can be inferred from the API response queries reflecting the effective tenant federation policy.\n\nWhile not unique to Teams, there are open-source frameworks that can specifically be leveraged to enumerate less secure users, groups, and tenants in Teams (mostly by repurposing the [Microsoft Graph API](https://learn.microsoft.com/graph/use-the-api) or gathering DNS), including ROADtools, TeamFiltration, [TeamsEnum](https://github.com/sse-secure-systems/TeamsEnum#readme-ov-file), and [MSFT-Recon-RS](https://github.com/copyleftdev/msft-recon-rs). These tools facilitate enumerating teams, members of teams and channels, tenant IDs and enabled domains, as well as permissiveness for communicating with external organizations and other properties, like presence. [Presence](https://learn.microsoft.com/microsoftteams/presence-admins#presence-states-in-teams) indicates a user’s current availability and status outside the organization if Privacy mode is not enabled, which could then be exploited if the admin has not [disabled](https://learn.microsoft.com/microsoftteams/trusted-organizations-external-meetings-chat?tabs=organization-settings) external meetings and chat with people and organizations outside the organization (or at least limited it to specified external domains).\n\nMany open-source tools are modular Python packages including reusable libraries and classes that can be directly imported or extended to support custom classes, meaning they are also interoperable with other custom open-source reconnaissance and discovery frameworks designed to identify potential misconfigurations.\n\n### Resource development\n\nMicrosoft continuously enhances protections against fraudulent Microsoft Entra ID Workforce tenants and the abuse of free tenants and trial subscriptions. As these defenses grow stronger, threat actors are forced to invest significantly more resources in their attempts to impersonate trusted users, demonstrating the effectiveness of our layered security approach. . This includes threat actors trying to compromise weakly configured legitimate tenants, or even actually purchasing legitimate ones if they have confidence they could ultimately profit. It should come as no surprise that if they can build a persona for social engineering, they will take advantage of the same resources as legitimate organizations, including [custom domains](https://learn.microsoft.com/entra/fundamentals/add-custom-domain) and [branding](https://learn.microsoft.com/en-us/entra/fundamentals/how-to-customize-branding), especially if it can lend credibility to impersonating internal help desk, admin, or IT support, which could then be used as a convincing pretext to compromise targets through chat messaging and phone calls. Sophisticated threat actors try to use the very same resources used by trustworthy organizations, such as acquiring multiple tenants for staging development or running separate operations across regions, and using everyday Teams features like scheduling private meetings through chat, and audio, video and screen-sharing capabilities for productivity.\n\n### Initial access\n\nTech support scams remain a generally popular pretext for delivery of malicious [remote monitoring and management](https://techcommunity.microsoft.com/blog/microsoftsecurityexperts/keys-to-the-kingdom-rmm-exploits-enabling-human-operated-intrusions-in-2024%E2%80%9325/4410903) (RMM) tools and information-stealing malware, [leading](https://www.microsoft.com/en-us/security/blog/2024/05/15/threat-actors-misusing-quick-assist-in-social-engineering-attacks-leading-to-ransomware) to credential theft, extortion, and [ransomware](https://learn.microsoft.com/security/ransomware/human-operated-ransomware). There are always new variants to bypass security awareness defenses, such as the rise in [email bombing](https://techcommunity.microsoft.com/blog/microsoftdefenderforoffice365blog/protection-against-email-bombs-with-microsoft-defender-for-office-365/4418048) to create a sense of stress and urgency to restore normalcy. In 2024, for instance, Storm-1811 impersonated tech support, claiming to be addressing junk email issues that it had initiated. They used RMM tools to deliver the ReedBed malware loader of ransomware payloads and remote command execution. Meanwhile, Midnight Blizard has successfully impersonated security and technical support teams to get targets to verify their identities under the pretext of protecting their accounts by entering authentication codes that complete the authentication flow for breaking into the accounts.\n\nSimilarly in May, Sophos [identified](https://news.sophos.com/en-us/2025/05/20/a-familiar-playbook-with-a-twist-3am-ransomware-actors-dropped-virtual-machine-with-vishing-and-quick-assist/) a 3AM ransomware (believed to be a rebranding of [BlackSuit](https://www.cisa.gov/news-events/cybersecurity-advisories/aa23-061a)) affiliate adopting techniques from [Storm-1811](https://www.microsoft.com/en-us/security/blog/2024/05/15/threat-actors-misusing-quick-assist-in-social-engineering-attacks-leading-to-ransomware), including flooding employees with unwanted emails followed by voice and video calls on Teams impersonating help desk personnel, claiming they needed remote access to stop the flood of junk emails. The threat actor reportedly spoofed the IT organization’s phone number.\n\nWith threat actors leveraging [deepfakes](https://www.microsoft.com/en-us/security/blog/2025/04/16/cyber-signals-issue-9-ai-powered-deception-emerging-fraud-threats-and-countermeasures/), perceived authority helps make this kind of social engineering even more effective. Threat actors seeking to spoof automated workflow notifications and interactions can naturally extend to spoofing legitimate bots and agents as they gain more traction, as threat actors are turning to language models to facilitate their objectives.\n\nPrevalent threat actors associated with ransomware campaigns, including the access broker tracked as Storm-1674 have used sophisticated red teaming tools, like [TeamsPhisher](https://www.microsoft.com/en-us/security/blog/2023/12/28/financially-motivated-threat-actors-misusing-app-installer), to distribute DarkGate malware and other malicious payloads over Teams. In December 2024, for example, Trend Micro [reported](https://www.trendmicro.com/en_us/research/24/l/darkgate-malware.html) an incident in which a threat actor impersonated a client during a Teams call to persuade a target to install AnyDesk. Remote access was reportedly then used also to deploy DarkGate. Threat actors may also just use Teams to gain initial access through drive-by-compromise activity to direct users to malicious websites.\n\nWidely available admin tools, including [AADInternals](https://aadinternals.com/aadinternals/#about), could be leveraged to deliver malicious links and payloads directly into Teams. Teams branding (like any communications brand asset) makes for effective bait, and has been used by [adversary-in-the-middle (AiTM) actors like Storm-00485](https://www.microsoft.com/en-us/security/blog/2025/05/29/defending-against-evolving-identity-attack-techniques/). Threat actors could place malicious advertisements in search results for a spoofed app like Teams to misdirect users to a download site hosting credential-stealing malware. In July 2025, for instance, Malwarebytes [reported](https://www.malwarebytes.com/blog/threat-intelligence/2024/07/fake-microsoft-teams-for-mac-delivers-atomic-stealer) observing a malvertising campaign delivering credential-stealing malware through a fake Microsoft Teams for Mac installer.\n\nWhether it is a core app that is part of Teams, an app created by Microsoft, a partner app validated by Microsoft, or a custom app created by your own organization—no matter how secure an app—they could still be spoofed to gain a foothold in a network. And similar to leveraging a trusted brand like Teams, threat actors will also continue to try and take advantage of trusted relationships as well to gain Teams access, whether leveraging an account with access or abusing delegated administrator relationships to reach a target environment.\n\n### Persistence\n\nThreat actors employ a variety of persistence techniques to maintain access to target systems—even after defenders attempt to regain control. These methods include abusing shortcuts in the Startup folder to execute malicious tools, or exploiting accessibility features like Sticky Keys (as seen in this ransomware [case study](https://learn.microsoft.com/security/ransomware/dart-ransomware-case-study)). Threat actors could try to create guest users in target tenants or add their own credentials to a Teams account to maintain access.\n\nPart of the reason device code phishing has been used to access target accounts is that it could enable persistent access for as long as the tokens remain valid. In February, Microsoft [reported](https://www.microsoft.com/en-us/security/blog/2025/02/13/storm-2372-conducts-device-code-phishing-campaign/) that Storm-2372 had been capturing authentication tokens by exploiting device code authentication flows, partially by masquerading as Microsoft Teams meeting invitations and initiating Teams chats to build rapport, so that when the targets were prompted to authenticate, they would use Storm-2372-generated device codes, enabling Storm-2372 to steal the authenticated sessions from the valid access tokens.\n\nTeams phishing lures themselves can sometimes be a disguised attempt to help threat actors maintain persistence. For example, in July 2025, the financially motivated Storm-0324 most likely relied on TeamsPhisher to send Teams phishing lures to deliver a custom malware JSSloader for the ransomware operator Sangria Tempest to use as an access vector to maintain a foothold.\n\n### Execution\n\nApart from admin accounts, which are an attractive target because they come with elevated privileges, threat actors try and trick everyday Teams users into clicking links or opening files that lead to malicious code execution, just like through email.\n\n### Privilege escalation\n\nIf threat actors successfully compromise accounts or register actor-controlled devices, they often times  try to change permission groups to escalate privileges. **** If a threat actor successfully compromises a Teams admin role, this could lead to abuse of the permissions to use the admin tools that belong to that role.\n\n### Credential access\n\nWith a valid refresh token, actors can impersonate users through Teams APIs. There is no shortage of administrator tools that can be maliciously repurposed, such as AADInternals, to intercept access to tokens with custom phishing flows. Tools like TeamFiltration could be leveraged just like for any other Microsoft 365 service for targeting Teams. If credentials are compromised through password spraying, threat actors use tools like this to request OAuth tokens for Teams and other services. Threat actors continue to try and bypass multifactor authentication (MFA) by repeatedly generating authentication prompts until someone accepts by mistake, and try to compromise MFA by adding alternate phone numbers or intercepting SMS-based codes.\n\nFor instance, the financially motivated threat actor [Octo Tempest](https://www.microsoft.com/en-us/security/blog/2025/07/16/protecting-customers-from-octo-tempest-attacks-across-multiple-industries/) uses aggressive social engineering, including over Teams, to take control of MFA for privileged accounts. They consistently socially engineer help desk personnel, targeting federated identity providers using tools like AADInternals to federate existing domains, or spoof legitimate domains by adding and then federating new domains to forge tokens.\n\n### Discovery\n\nTo refine targeting, threat actors analyze Teams configuration data from API responses, enumerate Teams apps if they obtain unauthorized access, and search for valuable files and directories by leveraging toolkits for contextualizing potential attack paths. For instance, [Void Blizzard](https://www.microsoft.com/en-us/security/blog/2025/05/27/new-russia-affiliated-actor-void-blizzard-targets-critical-sectors-for-espionage/) has used AzureHound to enumerate a compromised organization’s Microsoft Entra ID configuration and gather details on users, roles, groups, applications, and devices. In a small number of compromises, the threat actor accessed Teams conversations and messages through the web client. AADInternals can also be used to discover Teams group structures and permissions.\n\nThe state-sponsored actor Peach Sandstorm has delivered malicious [ZIP files](https://www.microsoft.com/en-us/security/blog/2024/08/28/peach-sandstorm-deploys-new-custom-tickler-malware-in-long-running-intelligence-gathering-operations/) through Teams, then used [AD Explorer](https://learn.microsoft.com/sysinternals/downloads/adexplorer) to take snapshots of on-premises Active Directory database and related files.\n\n### Lateral movement\n\nA threat actor that manages to obtain Teams admin access (whether directly or indirectly by purchasing an admin account through a rogue online marketplace) could potentially leverage external communication settings and enable trust relationships between organizations to move laterally. In late 2024, in a campaign dubbed [VEILdrive](https://www.hunters.security/en/blog/veildrive-microsoft-services-malware-c2) by Hunters’ Team AXON, the financially motivated cybercriminal threat actors Sangria Tempest and Storm-1674 used previously compromised accounts to impersonate IT personnel and convince a user in another organization through Teams to accept a chat request and grant access through a remote connection.\n\n### Collection\n\nThreat actors often target Teams to try and collect information from it that could help them to accomplish their objectives, such as to discover collaboration channels or high-privileged accounts. They could try to mine Teams for any information perceived as useful in furtherance of their objectives, including pivoting from a compromised account to data accessible to that user from OneDrive or SharePoint. AADInternals can be used to collect sensitive chat data and user profiles. Post-compromise, [GraphRunner](https://github.com/dafthack/GraphRunner) can leverage the Microsoft Graph API to search all chats and channels and export Teams conversations.\n\n### Command and control\n\nThreat actors attempt to deliver malware through file attachments in Teams chats or channels. A cracked version of Brute Ratel C4 (BRc4) includes features to establish C2 channels with platforms like Microsoft Teams by using their communications protocols to send and receive commands and data.\n\nPost-compromise, threat actors can use red teaming tool [ConvoC2](https://github.com/cxnturi0n/convoC2) to send commands through Microsoft Teams messages using the [Adaptive Card](https://learn.microsoft.com/microsoftteams/platform/task-modules-and-cards/cards/design-effective-cards?tabs=design) framework to embed data in hidden span tags and then exfiltrate using webhooks. But threat actors can also use legitimate remote access tools to try and establish interactive C2 through Teams.\n\n### Exfiltration\n\nThreat actors may use Teams messages or shared links to direct data exfiltration to cloud storage under their control. Tools like TeamFiltration include an exfiltration module that rely on a valid access token to then extract recent contacts and download chats and files through OneDrive or SharePoint.\n\n### Impact\n\nThreat actors try to use Teams messages to support financial theft through extortion, social engineering, or technical means.\n\nOcto Tempest has used communication apps, including Teams to send taunting and threatening messages to organizations, defenders, and incident response teams as part of extortion and ransomware payment pressure tactics. After gaining control of MFA through social engineering password resets, they sign in to Teams to identify sensitive information supporting their financially motivated operations.\n\n## Mitigation and protection guidance\n\n### Strengthen identity protection\n\n- [Enable sign-in and user risk policies](https://learn.microsoft.com/entra/id-protection/howto-identity-protection-configure-risk-policies) in Microsoft Entra ID Protection. Enforce access controls based on sign-in risk. Users must be registered for [Microsoft Entra multifactor authentication](https://learn.microsoft.com/entra/identity/authentication/howto-mfa-getstarted) before sign-in risk policies can be triggered.\n- Configure just-in-time access to privileged roles. [Use](https://learn.microsoft.com/entra/fundamentals/configure-security) Microsoft Entra [Privileged Identity Management](https://learn.microsoft.com/entra/id-governance/privileged-identity-management/pim-getting-started) (PIM) (preview) to provide as-needed and just-in-time access to Microsoft 365 roles to reduce standing privileges and limit exposure.\n\n### Harden endpoint security\n\n- Use [configuration analyzer](https://learn.microsoft.com/defender-office-365/configuration-analyzer-for-security-policies) to strengthen security posture. Identify and remediate security policies that are less secure than the Standard or Strict protection profiles in [preset security policies](https://learn.microsoft.com/defender-office-365/preset-security-policies).\n- Keep Teams clients, browsers, OS, and dependencies [updated](https://learn.microsoft.com/microsoftteams/teams-client-update).\n- [Enable network protection](https://learn.microsoft.com/defender-endpoint/network-protection#overview-of-network-protection) and [web protection capability](https://learn.microsoft.com/defender-endpoint/web-protection-overview) in Defender for Endpoint.\n- Enable [cloud-delivered protection](https://learn.microsoft.com/defender-endpoint/cloud-protection-microsoft-defender-antivirus) in Defender Antivirus. Cloud-delivered protection enables sharing detection status between Microsoft 365 and Defender for Endpoint. [Real-time protection blocking](https://learn.microsoft.com/defender-endpoint/configure-protection-features-microsoft-defender-antivirus), including on-access scanning, is not availablewhen Defender Antivirus is running only in passive mode. You can turn on [endpoint detection and response (EDR) in block mode](https://learn.microsoft.com/microsoft-365/security/defender-endpoint/edr-in-block-mode) even if Defender Antivirus isn’t your primary antivirus solution. EDR in block mode detects and remediates malicious items on the device post-breach.\n- Protect security settings from being disabled or changed with [tamper protection](https://learn.microsoft.com/defender-endpoint/prevent-changes-to-security-settings-with-tamper-protection).\n- [Require device compliance policies with Conditional Access](https://learn.microsoft.com/entra/identity/conditional-access/policy-all-users-device-compliance). Enhance conditional access, to the extent available, with real-time enforcement through [Continuous Access Evaluation (CAE)](https://learn.microsoft.com/entra/identity/conditional-access/concept-continuous-access-evaluation#key-benefits), so that user session revocation is enforced in near-real time. Teams is supported as a cloud app in Microsoft Entra, so that [conditional access policies apply](https://learn.microsoft.com/entra/identity/conditional-access/concept-conditional-access-cloud-apps#office-365) when a user signs in. The Teams desktop application supports [AppLocker](https://learn.microsoft.com/windows/security/threat-protection/windows-defender-application-control/applocker/requirements-to-use-applocker), but we recommend [using App Control](https://learn.microsoft.com/windows/security/application-security/application-control/app-control-for-business/appcontrol-and-applocker-overview), if feasible. Use Defender for Endpoint to [enforce device compliance with Microsoft Intune](https://learn.microsoft.com/intune/intune-service/protect/advanced-threat-protection).\n- If your organization utilizes another remote support tool such as [Remote Help](https://www.microsoft.com/security/business/endpoint-management/microsoft-intune-remote-help), disable or remove Quick Assist as a best practice, if it isn’t used within your environment.\n- Understand and use [attack surface reduction](https://learn.microsoft.com/microsoft-365/security/defender-endpoint/attack-surface-reduction)capabilities in your environment to prevent common techniques used in combination with Teams threat activity as part of your first line of defense.\n- [Block Win32 API calls from Office macros](https://learn.microsoft.com/defender-endpoint/attack-surface-reduction-rules-reference#block-win32-api-calls-from-office-macros)\n\n- [Block Office applications from injecting code into other processes](https://learn.microsoft.com/defender-endpoint/attack-surface-reduction-rules-reference#block-office-applications-from-injecting-code-into-other-processes)\n\n- [Block Office applications from creating executable content](https://learn.microsoft.com/defender-endpoint/attack-surface-reduction-rules-reference#block-office-applications-from-creating-executable-content)\n\n- [Block all Office applications from creating child processes](https://learn.microsoft.com/defender-endpoint/attack-surface-reduction-rules-reference#block-all-office-applications-from-creating-child-processes)\n\n- [Block credential stealing from the Windows local security authority subsystem](https://learn.microsoft.com/defender-endpoint/attack-surface-reduction-rules-reference?ocid=magicti_ta_learndoc#block-credential-stealing-from-the-windows-local-security-authority-subsystem)\n\n- [Block executable files from running unless they meet a prevalence, age, or trusted list criterion](https://learn.microsoft.com/microsoft-365/security/defender-endpoint/attack-surface-reduction-rules-reference)\n\n- [Block execution of potentially obfuscated scripts](https://learn.microsoft.com/microsoft-365/security/defender-endpoint/attack-surface-reduction-rules-reference)\n\n- [Block persistence through WMI event subscription](https://learn.microsoft.com/defender-endpoint/attack-surface-reduction-rules-reference#block-persistence-through-wmi-event-subscription)\n\n- [Block process creations originating from PSExec and WMI commands](https://learn.microsoft.com/defender-endpoint/attack-surface-reduction-rules-reference?ocid=magicti_ta_learndoc#block-process-creations-originating-from-psexec-and-wmi-commands)\n\n- [Block use of copied or impersonated system tools](https://learn.microsoft.com/defender-endpoint/attack-surface-reduction-rules-reference#block-use-of-copied-or-impersonated-system-tools)\n\n- [Block JavaScript or VBScript from launching downloaded executable content](https://learn.microsoft.com/microsoft-365/security/defender-endpoint/attack-surface-reduction-rules-reference?ocid=magicti_ta_learndoc#block-javascript-or-vbscript-from-launching-downloaded-executable-content)\n\n- [Use advanced protection against ransomware](https://learn.microsoft.com/defender-endpoint/attack-surface-reduction-rules-reference?ocid=magicti_ta_learndoc#use-advanced-protection-against-ransomware)\n\n### Secure Teams clients and apps\n\nImplementing some of these recommendations will require [Teams Administrator permissions](https://learn.microsoft.com/microsoftteams/using-admin-roles#teams-roles-and-capabilities).\n\n- Follow the Microsoft Teams recommendations on [Microsoft Secure Score](https://learn.microsoft.com/microsoft-365/security/defender/microsoft-secure-score).\n- [Manage Teams for iOS and Android with Microsoft Intune](https://learn.microsoft.com/intune/intune-service/apps/manage-microsoft-teams).\n- [Apply app-based Conditional Access](https://learn.microsoft.com/intune/intune-service/apps/manage-microsoft-teams#apply-conditional-access).\n\n- [Create Intune app protection policies](https://learn.microsoft.com/intune/intune-service/apps/manage-microsoft-teams)\n- [Configure Teams protection in Defender for Office 365](https://learn.microsoft.com/defender-office-365/mdo-support-teams-quick-configure).\n- [Turn on Safe Attachments](https://learn.microsoft.com/defender-office-365/safe-attachments-for-spo-odfb-teams-configure).\n\n- [Set up Safe Links policies](https://learn.microsoft.com/defender-office-365/safe-links-policies-configure).\n\n- Use SharePoint Online PowerShell to [prevent users from downloading malicious files](https://learn.microsoft.com/defender-office-365/safe-attachments-for-spo-odfb-teams-configure#step-2-recommended-use-sharepoint-online-powershell-to-prevent-users-from-downloading-malicious-files).\n\n- Use the Defender portal ([or PowerShell](https://learn.microsoft.com/powershell/exchange/connect-to-scc-powershell?view=exchange-ps)) to create an [alert policy for detected files](https://learn.microsoft.com/defender-xdr/alert-policies#default-alert-policies).\n\n- [Configure Zero-hour auto purge (ZAP)](https://learn.microsoft.com/defender-office-365/zero-hour-auto-purge#zero-hour-auto-purge-zap-in-microsoft-teams). ZAP can retroactively detect existing malicious chat messages in Teams. Set the [quarantine policy](https://learn.microsoft.com/defender-office-365/quarantine-policies#assign-quarantine-policies-in-supported-policies-in-the-microsoft-defender-portal) that is used for detections.\n- [Secure external access to Teams with Microsoft Entra ID](https://learn.microsoft.com/entra/architecture/9-secure-access-teams-sharepoint).\n- Manage [guest access in Teams](https://learn.microsoft.com/microsoftteams/guest-access).\n- Manage [call settings](https://learn.microsoft.com/en-us/microsoftteams/teams-calling-policy) in Teams. Inbound calls originating from the Public Switched Telephone Network (PSTN) on a tenant global level can be [blocked](https://learn.microsoft.com/microsoftteams/block-inbound-calls).\n- Use [meeting and event policies](https://learn.microsoft.com/microsoftteams/meeting-policies-overview) to control the features that are available to organizers and participants.\n- Use the Teams admin center or PowerShell to require anonymous users and people from untrusted organizations to [complete a verification check](https://learn.microsoft.com/microsoftteams/join-verification-check#manage-verification-checks-for-meetings-and-webinars-in-your-org) before joining the meeting.\n- Control access to meetings with [lobby policies](https://learn.microsoft.com/microsoftteams/who-can-bypass-meeting-lobby#control-whether-users-dialing-in-by-phone-can-bypass-the-lobby) (who can bypass it and eligibility for [admitting participants](https://learn.microsoft.com/microsoftteams/who-can-bypass-meeting-lobby#control-who-can-admit-participants-from-the-lobby)).\n- [Manage who can present and request control](https://learn.microsoft.com/microsoftteams/meeting-who-present-request-control#participants-can-give-or-request-control) to generally prevent external users by default without business justification from being able to automatically request control over a shared window or screen.\n- [Manage Teams recording policies for meetings and events](https://learn.microsoft.com/microsoftteams/meeting-recording) (as well as for [town halls](https://learn.microsoft.com/microsoftteams/plan-town-halls#town-hall-policy-and-setting-controls)).\n- [Manage external meetings and chat](https://learn.microsoft.com/microsoftteams/trusted-organizations-external-meetings-chat?tabs=organization-settings).\n- Specify which types of external meetings and chat to allow and which users should have access to these features. You can change the default setting to limit external access to only allowed domains or block specific domains and subdomains. By blocking external communication with trial-only tenants, users that do not have any purchased seats are not able to search and contact your users via chat, Teams calls, and meetings.\n\n- You can prevent users that are not managed by an organization from starting conversations or prevent chat with them. If you choose to allow anonymous users in your environment, you can [verify their identities](https://learn.microsoft.com/microsoftteams/anonymous-users-in-meetings#prerequisites) by email code to join meetings (Premium).\n- Monitor Teams activities using [activity policies](https://learn.microsoft.com/defender-cloud-apps/user-activity-policies) in Defender for Cloud Apps. If external users are enabled, you can monitor their presence. Defender for Cloud Apps integrates directly with [Microsoft 365 audit logs](https://learn.microsoft.com/microsoft-365/compliance/detailed-properties-in-the-office-365-audit-log?view=o365-worldwide&amp;preserve-view=true). Office 365 Cloud Apps Security has access to the features of Defender for Cloud Apps to support the Office 365 app connector.\n- Specify which users and groups can use [Microsoft Teams apps](https://learn.microsoft.com/microsoftteams/apps-in-teams) or a copilot agent and [control it on a per-app basis](https://learn.microsoft.com/microsoftteams/app-centric-management). You can change the default setting letting users install apps by default. [Evaluate](https://learn.microsoft.com/microsoftteams/app-permissions) the compliance, security, and data handling information of an app and also understand the permissions requested by the app before you allow an app to be used.\n\n**Protect sensitive data**\n\n- [Use meeting templates, sensitivity labels, and admin policies together for sensitive meetings](https://learn.microsoft.com/microsoftteams/meeting-templates-sensitivity-labels-policies).\n- Teams data is encrypted in transit and at rest in Microsoft services, between services, and between clients and services. For heightened confidentiality, you can also use [end-to-end](https://support.microsoft.com/office/use-end-to-end-encryption-for-teams-meetings-a8326d15-d187-49c4-ac99-14c17dbd617c) encryption in [advanced meeting protection](https://support.microsoft.com/office/advanced-meeting-protection-in-microsoft-teams-premium-46e39bcb-40e0-4617-84be-14be9dd99780) that is available with the [Teams Premium](https://learn.microsoft.com/MicrosoftTeams/enhanced-teams-experience) add-on [license](https://learn.microsoft.com/MicrosoftTeams/teams-add-on-licensing/licensing-enhance-teams). This encrypts audio, video, and video-based screen sharing at its origin and decrypts it at its destination.\n\n- You can use [end-to-end](https://support.microsoft.com/office/use-end-to-end-encryption-for-teams-meetings-a8326d15-d187-49c4-ac99-14c17dbd617c) encryption for up to 200 meeting participants and turn off the ability to copy and paste from meeting chats. The Premium add-on license may be required to [prevent users from sharing sensitive information when attending external meetings](https://learn.microsoft.com/microsoftteams/block-external-content-share) and [restrict recording to organizers in meetings with sensitive information](https://learn.microsoft.com/microsoftteams/manage-meeting-recording-options#manage-who-can-record-and-transcribe-meetings-teams-premium).\n- Block chats and channel messages that contain sensitive information with [Microsoft Purview Data Loss Prevention (DLP) for Teams](https://learn.microsoft.com/office365/servicedescriptions/microsoft-365-service-descriptions/microsoft-365-tenantlevel-services-licensing-guidance/microsoft-purview-service-description).\n- [Manage sharing settings](https://learn.microsoft.com/sharepoint/turn-external-sharing-on-or-off) for SharePoint and OneDrive.\n\n**Raise awareness**\n\n- Get started using [attack simulation training](https://learn.microsoft.com/defender-office-365/attack-simulation-training-get-started). The Teams [attack simulation training](https://learn.microsoft.com/defender-office-365/attack-simulation-training-teams) is currently in private preview. Build organizational resilience by raising awareness of QR code phishing, deepfakes including voice, and about protecting your organization from [tech support](https://support.microsoft.com/windows/protect-yourself-from-tech-support-scams-2ebf91bd-f94c-2a8a-e541-f5c800d18435) and [ClickFix](https://security.microsoft.com/threatanalytics3/bdf0d0c5-f5f3-435a-b4a1-6e3beb73b5b9/analystreport) scams.\n- Train developers to follow [best practices](https://learn.microsoft.com/graph/best-practices-concept)when working with the Microsoft Graph API. Apply these practices when detecting, defending against, and responding to malicious techniques targeting Teams.\n- Using server-side code to make Graph API calls that require access tokens helps protect against token interception or leakage. We [recommend](https://learn.microsoft.com/graph/sdks/choose-authentication-providers?tabs=csharp) using the most secure authentication flow available. For more information, see [Microsoft identity platform and OAuth 2.0 Resource Owner Password Credentials](https://learn.microsoft.com/entra/identity-platform/v2-oauth-ropc).\n- [Learn more](https://security.microsoft.com/threatanalytics3/a30d3a89-c61c-429e-9a44-007931931ba6/analystreport) about some of the frequent initial access threats impacting SharePoint servers. SharePoint is a [front end](https://learn.microsoft.com/SharePoint/teams-connected-sites) for Microsoft Teams and an attractive target.\n\n**Configure detection and response**\n\n- [Verify the auditing status](https://learn.microsoft.com/purview/audit-log-enable-disable) of your organization in Microsoft Purview to make sure you can investigate incidents. In Threat Explorer, Content malware includes files detected by Safe Attachments for Teams, and *URL clicks* include all user clicks in Teams.\n- [Customize](https://learn.microsoft.com/defender-office-365/submissions-teams#user-reporting-settings-for-teams-messages) how users report malicious messages, and then [view and triage](https://learn.microsoft.com/defender-office-365/submissions-teams#view-and-triage-user-reported-messages-in-teams)them.\n- Security Operations ([SecOps](https://learn.microsoft.com/defender-office-365/mdo-support-teams-sec-ops-guide#integrate-user-reported-teams-messages-into-secops-incident-response)) should be enabled to proactively [manage false negatives](https://learn.microsoft.com/defender-office-365/mdo-support-teams-sec-ops-guide#enable-secops-to-proactively-manage-false-negatives-in-microsoft-teams) and [false positives](https://learn.microsoft.com/defender-office-365/mdo-support-teams-sec-ops-guide#enable-secops-to-manage-false-positives-in-microsoft-teams), and to [hunt for threats and detections](https://learn.microsoft.com/defender-office-365/mdo-support-teams-sec-ops-guide#enable-secops-to-hunt-for-threats-and-detections-in-microsoft-teams). They should triage and investigate from the [Defender XDR incidents queue in the Defender portal](https://learn.microsoft.com/defender-office-365/mdo-sec-ops-manage-incidents-and-alerts).\n\n- If user reporting of messages is turned on in the Teams admin center, it also needs to be turned on in the Defender portal. We encourage you to submit user reported Teams messages to Microsoft [here](https://learn.microsoft.com/defender-office-365/submissions-admin#submit-user-reported-messages-to-microsoft-for-analysis).\n- [Search the audit log](https://learn.microsoft.com/purview/audit-teams-audit-log-events)for events in Teams.\n- Refer to the [table](https://learn.microsoft.com/purview/audit-log-activities#microsoft-teams-activities) listing the Microsoft Teams activities logged in the Microsoft 365 audit log. With the [Office 365 Management Activity API](https://learn.microsoft.com/office/office-365-management-api/office-365-management-activity-api-reference?toc=%2Fmicrosoft-365%2Fcompliance%2Ftoc.json&amp;bc=%2Fmicrosoft-365%2Fbreadcrumb%2Ftoc.json), you can retrieve information about user, admin, system, and policy actions and events including from Entra activity logs.\n- Familiarize yourself with relevant advanced hunting schema and available tables.\n- Advanced hunting supports [guided](https://learn.microsoft.com/defender-xdr/advanced-hunting-query-builder) and [advanced](https://learn.microsoft.com/defender-xdr/advanced-hunting-query-language) modes. You can use the advanced hunting queries in the advanced hunting section to hunt with these tables for Teams-related threats.\n\n- Several tables covering Teams-related threats are available in preview and populated by Defender for Office 365, including [MessageEvents](https://learn.microsoft.com/defender-xdr/advanced-hunting-messageevents-table), [MessagePostDeliveryEvents](https://learn.microsoft.com/defender-xdr/advanced-hunting-messagepostdeliveryevents-table), [MessageUrlInfo](https://learn.microsoft.com/defender-xdr/advanced-hunting-messageurlinfo-table), and [UrlClickEvents](https://learn.microsoft.com/defender-xdr/advanced-hunting-urlclickevents-table). These tables provide visibility into ZAP events and URLs in Teams messages, including allowed or blocked URL clicks in Teams clients. You can join these tables with others to gain more comprehensive insight into the progression of the attack chain and end-to-end threat activity.\n- [Connect](https://learn.microsoft.com/defender-cloud-apps/connect-office-365)Microsoft 365 to Microsoft Defender for Cloud Apps.\n- To hunt for Teams messages without URLs, use the [CloudAppEvents](https://learn.microsoft.com/en-us/defender-xdr/advanced-hunting-cloudappevents-table) table, populated by Defender for Cloud Apps. This table also includes chat monitoring events, meeting and Teams call tracking, and behavioral analytics. To make sure advanced hunting tables are populated by Defender for Cloud Apps data, go to the Defender portal and select Settings &gt; Cloud apps &gt; App connectors. Then, in the Select Microsoft 365 components page, select the Microsoft 365 activities checkbox. Control Microsoft 365 with [built-in policies and policy templates](https://learn.microsoft.com/defender-cloud-apps/protect-office-365) to detect and notify you about potential threats.\n- Create Defender for Cloud Apps [threat detection policies](https://learn.microsoft.com/defender-cloud-apps/policies-threat-protection).\n- Many of the detection types enabled by default apply to Teams and do not require custom policy creation, including sign-ins from geographically distant locations in a short time, access from a country not previously associated with a user, unexpected admin actions, mass downloads, activity from anonymous IP addresses, or from a device flagged as malware-infected by Defender for Endpoint, as well as Oauth app abuse (when [app governance is turned on](https://learn.microsoft.com/defender-cloud-apps/app-governance-get-started)).\n\n- Defender for Cloud Apps enables you to identify high-risk use and cloud security issues, detect abnormal user behavior, and prevent threats in your sanctioned cloud apps. You can i[ntegrate](https://learn.microsoft.com/defender-cloud-apps/siem-sentinel) Defender for Cloud Apps with Microsoft Sentinel (preview) or use the [supported APIs](https://learn.microsoft.com/defender-cloud-apps/siem).\n- [Detect and remediate illicit consent grants](https://learn.microsoft.com/defender-office-365/detect-and-remediate-illicit-consent-grants)in Microsoft 365.\n- Refer to the [compromised and malicious applications incident response playbook](https://learn.microsoft.com/security/operations/incident-response-playbook-compromised-malicious-app). This playbook includes relevant guidance for identifying and investigating malicious activity on third-party apps installed in Teams, custom apps using the Graph API for Teams, or OAuth abuse involving Teams permissions.\n- Discover and enable the [Microsoft Sentinel data lake](https://learn.microsoft.com/azure/sentinel/datalake/sentinel-lake-overview) in Defender XDR. Sentinel data lake brings together security logs from data sources like Microsoft Defender and Microsoft Sentinel, Microsoft 365, Microsoft Entra ID, Purview, Intune, Microsoft Resource Graph, firewall and network logs, identity and access logs, DNS, plus sources from hundreds of connectors and solutions, including [Microsoft Defender Threat Intelligence](https://learn.microsoft.com/azure/sentinel/connect-mdti-data-connector). Advanced hunting [KQL queries](https://learn.microsoft.com/azure/sentinel/datalake/kql-queries) can be run directly on the data lake. You can analyze the data [using Jupyter notebooks](https://learn.microsoft.com/azure/sentinel/datalake/notebook-examples).\n\n## Microsoft Defender detections\n\nMicrosoft Defender XDR customers can refer to the list of applicable detections below. Microsoft Defender XDR coordinates detection, prevention, investigation, and response across endpoints, identities, email, apps to provide integrated protection against attacks like the threat discussed in this blog.\n\nCustomers with provisioned access can also use [Microsoft Security Copilot in Microsoft Defender](https://learn.microsoft.com/en-us/defender-xdr/security-copilot-in-microsoft-365-defender) to investigate and respond to incidents, hunt for threats, and protect their organization with relevant threat intelligence.\n\n### Microsoft Defender XDR\n\nThe following alerts might indicate threat activity associated with this threat.\n\n- Malicious sign in from a risky IP address\n- Malicious sign in from an unusual user agent\n- Account compromised following a password-spray attack\n- Compromised user account identified in Password Spray activity\n- Successful authentication after password spray attack\n- Password Spray detected via suspicious Teams client (TeamFiltration)\n\n### Microsoft Entra ID Protection\n\nAny type of [sign-in and user risk detection](https://learn.microsoft.com/en-us/entra/id-protection/concept-identity-protection-risks#sign-in-risk-detections-mapped-to-riskeventtype) might also indicate threat activity associated with this threat. An example is listed below. These alerts, however, can be triggered by unrelated threat activity.\n\n- Impossible travel\n- Anomalous Microsoft Teams login from web client\n\n### Microsoft Defender for Endpoint\n\nThe following alerts might indicate threat activity associated with this threat.\n\n- Suspicious module loaded using Microsoft Teams\n\nThe following alerts might also indicate threat activity associated with this threat. These alerts, however, can be triggered by unrelated threat activity and are not monitored in the status cards provided with this report.\n\n- Suspicious usage of remote management software\n\n### Microsoft Defender for Office 365\n\nThe following alerts might indicate threat activity associated with this threat.\n\n- Malicious link shared in Teams chat\n- User clicked a malicious link in Teams chat\n\nWhen Microsoft Defender for Cloud Apps is enabled, the following alert might indicate threat activity associated with this threat.\n\n- Potentially Malicious IT Support Teams impersonation post mail bombing\n\nThe following alerts might also indicate threat activity associated with this threat. These alerts, however, can be triggered by unrelated threat activity and are not monitored in the status cards provided with this report.\n\n- A potentially malicious URL click was detected\n- Possible AiTM phishing attempt\n\n### Microsoft Defender for Identity\n\nThe following Microsoft Defender for Identity alerts can indicate associated threat activity:\n\n- Account enumeration reconnaissance\n- Suspicious additions to sensitive groups\n- Account Enumeration reconnaissance (LDAP)\n\n### Microsoft Defender for Cloud Apps\n\nThe following alerts might indicate threat activity associated with this threat.\n\n- Consent granted to application with Microsoft Teams permissions\n- Risky user installed a suspicious application in Microsoft Teams\n- Compromised account signed in to Microsoft Teams\n- Microsoft Teams chat initiated by a suspicious external user\n- Suspicious Teams access via Graph API\n\nThe following alerts might also indicate threat activity associated with this threat. These alerts, however, can be triggered by unrelated threat activity and are not monitored in the status cards provided with this report.\n\n- Possible mail exfiltration by app\n\n### Microsoft Security Copilot\n\n[Microsoft Security Copilot](https://learn.microsoft.com/defender-xdr/security-copilot-in-microsoft-365-defender) customers can use the [Copilot in Defender embedded experience](https://learn.microsoft.com/en-us/defender-xdr/security-copilot-in-microsoft-365-defender) to check the impact of this report and get insights based on their environment’s highest exposure level in Threat analytics, Intel profiles, Intel Explorer and Intel projects pages of the Defender portal.\n\nYou can also use Copilot in Defender to speed up [analysis of suspicious scripts and command lines](https://learn.microsoft.com/defender-xdr/security-copilot-m365d-script-analysis) by inspecting them below the incident graph on an incident page and in the timeline on the Device entity page without using external tools.\n\n## Threat intelligence reports\n\nMicrosoft customers can use the following reports in Microsoft products to get the most up-to-date information about the threat actor, malicious activity, and techniques discussed in this blog. These reports provide the intelligence, protection information, and recommended actions to prevent, mitigate, or respond to associated threats found in customer environments.\n\n### Microsoft Defender XDR threat analytics\n\n- [Technique Profile: Threats targeting Microsoft Teams](https://security.microsoft.com/threatanalytics3/54d1fc5c-f314-4e4f-aeae-1d4061769990/overview?tid=0527ecb7-06fb-4769-b324-fd4a3bb865ebhttps://security.microsoft.com/threatanalytics3/54d1fc5c-f314-4e4f-aeae-1d4061769990/overview)\n\nMicrosoft Security Copilot customers can also use the [Microsoft Security Copilot integration](https://learn.microsoft.com/defender/threat-intelligence/security-copilot-and-defender-threat-intelligence?bc=%2Fsecurity-copilot%2Fbreadcrumb%2Ftoc.json&amp;toc=%2Fsecurity-copilot%2Ftoc.json#turn-on-the-security-copilot-integration-in-defender-ti) in Microsoft Defender Threat Intelligence, either in the Security Copilot standalone portal or in the [embedded experience](https://learn.microsoft.com/defender/threat-intelligence/using-copilot-threat-intelligence-defender-xdr) in the Microsoft Defender portal to get more information about this threat actor.\n\n## Hunting queries\n\n### Microsoft Defender XDR\n\nAdvanced hunting allows you to view and query all the data sources available within the [unified Microsoft Defender portal](https://learn.microsoft.com/defender-xdr/microsoft-365-defender-portal), which include Microsoft Defender XDR and various Microsoft security services.\n\nAfter onboarding to the Microsoft Sentinel data lake, auxiliary log tables are no longer available in Microsoft Defender advanced hunting. Instead, you can access them through data lake exploration Kusto Query Language (KQL) queries in the Defender portal. For more information, see [KQL queries in the Microsoft Sentinel data lake](https://learn.microsoft.com/azure/sentinel/datalake/kql-queries).\n\nYou can design and tweak [custom detection rules](https://learn.microsoft.com/en-us/defender-xdr/custom-detection-rules) using the advanced hunting queries and set them to run at regular intervals, generating alerts and taking response actions whenever there are matches. You can also link the generated alert to this report so that it appears in the [Related incidents](https://learn.microsoft.com/en-us/defender-xdr/threat-analytics#set-up-custom-detections-and-link-them-to-threat-analytics-reports) tab in threat analytics. Custom detection rule can automatically [take actions](https://learn.microsoft.com/en-us/defender-xdr/custom-detection-rules#4-specify-actions) on devices, files, users, or emails that are returned by the query. To make sure you’re creating detections that trigger true alerts, take time to review your existing custom detections by following the steps in [Manage existing custom detection rules](https://learn.microsoft.com/en-us/defender-xdr/custom-detection-manage).\n\n**Detect potential data exfiltration from Teams**\n\n```\n\nlet timeWindow = 1h; let messageThreshold = 20; let trustedDomains = dynamic([\"trustedpartner.com\", \"anothertrusted.com\"]); CloudAppEvents | where Timestamp > ago(1d) | where ActionType == \"MessageSent\" | where Application == \"Microsoft Teams\" | where isnotempty(AccountObjectId) | where tostring(parse_json(RawEventData).ParticipantInfo.HasForeignTenantUsers) == \"true\" | where tostring(parse_json(RawEventData).CommunicationType) in (\"OneOnOne\", \"GroupChat\") | extend RecipientDomain = tostring(parse_json(RawEventData).ParticipantInfo.ParticipatingDomains[1]) | where RecipientDomain !in (trustedDomains) | extend SenderUPN = tostring(parse_json(RawEventData).UserId) | summarize MessageCount = count() by bin(Timestamp, timeWindow), SenderUPN, RecipientDomain | where MessageCount > messageThreshold | project Timestamp, MessageCount, SenderUPN, RecipientDomain | sort by MessageCount desc ```\n\n**Detect mail bombing that sometimes precedes technical support scams on Microsoft Teams**\n\n```\n\nEmailEvents | where Timestamp > ago(1d) | where DetectionMethods contains \"Mail bombing\" | project Timestamp, NetworkMessageId, SenderFromAddress, Subject, ReportId ```\n\n**Detect malicious Teams content from** ***MessageEvents***\n\n```\n\nMessageEvents | where Timestamp > ago(1d) | where ThreatTypes has \"Phish\" or ThreatTypes has \"Malware\" or ThreatTypes has \"Spam\" | project Timestamp, SenderDisplayName, SenderEmailAddress, RecipientDetails, IsOwnedThread, ThreadType, IsExternalThread, ReportId ```\n\n**Detect communication with external help desk/support representatives**\n\n```\n\nMessageEvents | where Timestamp > ago(5d) | where IsExternalThread == true | where (RecipientDetails contains \"help\" and RecipientDetails contains \"desk\") or (RecipientDetails contains \"it\" and RecipientDetails contains \"support\") or (RecipientDetails contains \"working\" and RecipientDetails contains \"home\") or (SenderDisplayName contains \"help\" and SenderDisplayName contains \"desk\") or (SenderDisplayName contains \"it\" and SenderDisplayName contains \"support\") or (SenderDisplayName contains \"working\" and SenderDisplayName contains \"home\") | project Timestamp, SenderDisplayName, SenderEmailAddress, RecipientDetails, IsOwnedThread, ThreadType ```\n\n**Expand detection of communication with external help desk/support representatives by searching for linked process executions**\n\n```\n\nlet portableExecutable = pack_array(\"binary.exe\", \"portable.exe\"); let timeAgo = ago(30d); MessageEvents | where Timestamp > timeAgo | where IsExternalThread == true | where (RecipientDetails contains \"help\" and RecipientDetails contains \"desk\") or (RecipientDetails contains \"it\" and RecipientDetails contains \"support\") or (RecipientDetails contains \"working\" and RecipientDetails contains \"home\") | summarize spamEvent = min(Timestamp) by SenderEmailAddress | join kind=inner ( DeviceProcessEvents | where Timestamp > timeAgo | where FileName in (portableExecutable) ) on $left.SenderEmailAddress == $right.InitiatingProcessAccountUpn | where spamEvent ```\n\n**Surface Teams threat activity using Microsoft Security Copilot**\n\n[Microsoft Security Copilot in Microsoft Defender](https://learn.microsoft.com/en-us/defender-xdr/security-copilot-in-microsoft-365-defender) comes with a query assistant capability in advanced hunting. You can also run the following prompt in Microsoft Security Copilot pane in the Advanced hunting page or by reopening Copilot from the top of the query editor:\n\n```\n\nShow me recent activity in the last 7 days that matches attack techniques described in the Microsoft Teams technique profile. Include relevant alerts, affected users and devices, and generate advanced hunting queries to investigate further. ```\n\n### Microsoft Sentinel\n\n**Possible Teams phishing activity**\n\nThis query specifically monitors Microsoft Teams for one-on-one chats involving impersonated users (e.g., 'Help Desk', 'Microsoft Security').\n\n```\n\nlet suspiciousUpns = DeviceProcessEvents | where DeviceId == \"alertedMachine\" | where isnotempty(InitiatingProcessAccountUpn) | project InitiatingProcessAccountUpn; CloudAppEvents | where Application == \"Microsoft Teams\" | where ActionType == \"ChatCreated\" | where isempty(AccountObjectId) | where RawEventData.ParticipantInfo.HasForeignTenantUsers == true | where RawEventData.CommunicationType == \"OneonOne\" | where RawEventData.ParticipantInfo.HasGuestUsers == false | where RawEventData.ParticipantInfo.HasOtherGuestUsers == false | where RawEventData.Members[0].DisplayName in (\"Microsoft Security\", \"Help Desk\", \"Help Desk Team\", \"Help Desk IT\", \"Microsoft Security\", \"office\") | where AccountId has \"@\" | extend TargetUPN = tolower(tostring(RawEventData.Members[1].UPN)) | where TargetUPN in (suspiciousUpns) ```\n\n**Files uploaded to Teams and access summary**\n\nThis query identifies files uploaded to Microsoft Teams chat files and their access history, specifically mentioning operations from SharePoint. It allows tracking of potential file collection activity through Teams-related storage.\n\n```\n\nOfficeActivity | where RecordType =~ \"SharePointFileOperation\" | where Operation =~ \"FileUploaded\" | where UserId != \"app@sharepoint\" | where SourceRelativeUrl has \"Microsoft Teams Chat Files\" | join kind= leftouter ( OfficeActivity | where RecordType =~ \"SharePointFileOperation\" | where Operation =~ \"FileDownloaded\" or Operation =~ \"FileAccessed\" | where UserId != \"app@sharepoint\" | where SourceRelativeUrl has \"Microsoft Teams Chat Files\" ) on OfficeObjectId | extend userBag = bag_pack(UserId1, ClientIP1) | summarize make_set(UserId1, 10000), make_bag(userBag, 10000) by TimeGenerated, UserId, OfficeObjectId, SourceFileName | extend NumberUsers = array_length(bag_keys(bag_userBag)) | project timestamp=TimeGenerated, UserId, FileLocation=OfficeObjectId, FileName=SourceFileName, AccessedBy=bag_userBag, NumberOfUsersAccessed=NumberUsers | extend AccountName = tostring(split(UserId, \"@\")[0]), AccountUPNSuffix = tostring(split(UserId, \"@\")[1]) | extend Account_0_Name = AccountName | extend Account_0_UPNSuffix = AccountUPNSuffix ```\n\n## References\n\n- [A familiar playbook with a twist: 3AM ransomware actors dropped virtual machine with vishing and Quick Assist](https://news.sophos.com/en-us/2025/05/20/a-familiar-playbook-with-a-twist-3am-ransomware-actors-dropped-virtual-machine-with-vishing-and-quick-assist/) (Sophos)\n- [convoC2](https://github.com/cxnturi0n/convoC2) (Cxnuri0n)\n- [EvilSlackbot](https://github.com/Drew-Sec/EvilSlackbot) (Drew-Sec)\n- [Fake Microsoft Teams Emails Phish for Credentials](https://www.darkreading.com/cloud-security/fake-microsoft-teams-emails-phish-for-credentials) (Dark Reading)\n- [Fake Microsoft Teams for Mac delivers Atomic Stealer](https://www.malwarebytes.com/blog/threat-intelligence/2024/07/fake-microsoft-teams-for-mac-delivers-atomic-stealer) (Malwarebytes)\n- [GraphRunner](https://github.com/dafthack/GraphRunner) (Dafthack)\n- [Inside the Microsoft Teams attack matrix: unpacking the frontier in collaboration threats](https://cyberdom.blog/inside-the-microsoft-teams-attack-matrix-unpacking-the-the-frontier-in-collaboration-threats/) (Cyberdom)\n- [Microsoft 365 Attack Surfaces: Elevation of Privilege Vulnerabilities](https://www.coreview.com/blog/elevation-of-privilege-vulnerabilities#attackvectordark) (CoreView)\n- [Microsoft 365 secure configuration baselines](https://www.cisa.gov/resources-tools/services/secure-cloud-business-applications-scuba-project) (CISA)\n- [MSFT-Recon-RS](https://github.com/copyleftdev/msft-recon-rs) (Copyleftdev)\n- [Ongoing Email Bombing Campaigns leading to Remote Access and Post-Exploitation](https://www.esentire.com/security-advisories/ongoing-email-bombing-campaigns-leading-to-remote-access-and-post-exploitation) (eSentire)\n- [Playing for the wrong team: dangerous functionalities in Microsoft Teams enable phishing and malware delivery by attackers](https://www.proofpoint.com/us/blog/threat-insight/dangerous-functionalities-in-microsoft-teams-enable-phishing) (Proofpoint)\n- [Signed. Sideloaded. Compromised!](https://www.ontinue.com/resource/blog-signed-sideloaded-compromised/) (Ontinue)\n- [Sophos MDR tracks two ransomware campaigns using “email bombing,” Microsoft Teams “vishing”](https://news.sophos.com/en-us/2025/01/21/sophos-mdr-tracks-two-ransomware-campaigns-using-email-bombing-microsoft-teams-vishing/) (Sophos)\n- [TeamsEnum](https://github.com/sse-secure-systems/TeamsEnum) (Secure Systems Engineering)\n- [TeamsPhisher](https://github.com/Octoberfest7/TeamsPhisher) (Octoberfest7)\n- [Thinking Outside the Mailbox: Modernized Phishing Techniques](https://www.praetorian.com/blog/modernized-phishing-techniques/) (Praetorian)\n- [Unmasking VEILDrive: Threat Actors Exploit Microsoft Services for C2](https://www.hunters.security/en/blog/veildrive-microsoft-services-malware-c2) (Hunters)\n- [Vishing via Microsoft Teams Facilitates DarkGate Malware Intrusion](https://www.trendmicro.com/en_us/research/24/l/darkgate-malware.html) (Trend Micro)\n\n## Learn more\n\nFor the latest security research from the Microsoft Threat Intelligence community, check out ff\n\nTo get notified about new publications and to join discussions on social media, follow us on [LinkedIn](https://www.linkedin.com/showcase/microsoft-threat-intelligence), [X (formerly Twitter)](https://x.com/MsftSecIntel), and [Bluesky](https://bsky.app/profile/threatintel.microsoft.com).\n\nTo hear stories and insights from the Microsoft Threat Intelligence community about the ever-evolving threat landscape, listen to the [Microsoft Threat Intelligence podcast](https://thecyberwire.com/podcasts/microsoft-threat-intelligence).",
  "Tags": [],
  "PubDate": "2025-10-07T17:00:00+00:00",
  "OutputDir": "_news",
  "Description": "Threat actors seek to abuse Microsoft Teams features and capabilities across the attack chain, underscoring the importance for defenders to proactively monitor, detect, and respond effectively. In this blog, we recommend countermeasures and optimal controls across identity, endpoints, data apps, and network layers to help strengthen protection for enterprise Teams users.\n\nThe post [Disrupting threats targeting Microsoft Teams](https://www.microsoft.com/en-us/security/blog/2025/10/07/disrupting-threats-targeting-microsoft-teams/) appeared first on [Microsoft Security Blog](https://www.microsoft.com/en-us/security/blog)."
}
