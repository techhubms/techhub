---
layout: post
title: Mitigating Active Exploitation of On-Premises SharePoint Vulnerabilities
author: Microsoft Threat Intelligence
canonical_url: https://www.microsoft.com/en-us/security/blog/2025/07/22/disrupting-active-exploitation-of-on-premises-sharepoint-vulnerabilities/
viewing_mode: external
feed_name: Microsoft Security Blog
feed_url: https://www.microsoft.com/en-us/security/blog/feed/
date: 2025-07-22 13:00:00 +00:00
permalink: /security/news/Mitigating-Active-Exploitation-of-On-Premises-SharePoint-Vulnerabilities
tags:
- AMSI
- Antimalware
- ASP.NET Machine Key
- Credential Theft
- CVE 49704
- CVE 53770
- CVE 53771
- IIS
- Impacket
- Incident Response
- Linen Typhoon
- Microsoft Defender
- Microsoft Defender For Endpoint
- Mimikatz
- PowerShell
- Ransomware
- Security Update
- SharePoint Server
- Storm 2603
- Violet Typhoon
- Vulnerability Management
- Web Shell
section_names:
- security
---
Microsoft Threat Intelligence reports on recent attacks exploiting SharePoint vulnerabilities, with actionable defense steps for organizations. This summary highlights author guidance for defenders and SharePoint administrators facing these advanced threats.<!--excerpt_end-->

# Mitigating Active Exploitation of On-Premises SharePoint Vulnerabilities

## Overview

Recent activity tracked by Microsoft Threat Intelligence highlights active exploitation of critical vulnerabilities in on-premises SharePoint Server by Chinese nation-state actors Linen Typhoon and Violet Typhoon, as well as Storm-2603. These attacks have resulted in web shell deployment and credential theft, with confirmed ransomware incidents. Microsoft urges urgent action to patch and harden affected SharePoint environments.

## Key Vulnerabilities and Impacted Versions

- **Vulnerabilities:**
  - [CVE-2025-53770](https://msrc.microsoft.com/update-guide/vulnerability/CVE-2025-53770): ToolShell Auth Bypass and RCE
  - [CVE-2025-49704](https://msrc.microsoft.com/update-guide/vulnerability/CVE-2025-49704): Remote Code Execution
  - [CVE-2025-53771](https://msrc.microsoft.com/update-guide/vulnerability/CVE-2025-53771): Path Traversal
  - CVE-2025-49706: Post-auth RCE
- **Affected Products:**
  - SharePoint Server Subscription Edition
  - SharePoint Server 2019
  - SharePoint Server 2016

## Threat Actor Activity

- **Storm-2603** exploited SharePoint flaws to deploy ransomware following initial access via tailored payloads like `spinstall0.aspx` web shell.
- **Linen Typhoon** and **Violet Typhoon** performed reconnaissance, exploitation, persistence, and credential theft targeting government and private sector entities.

## Attack Chain & Tactics

- **Initial Access:** POST request to ToolPane endpoint exploits SharePoint vulnerability.
- **Web Shell Deployment:** Uploads like `spinstall0.aspx`, enabling device control and credential extraction.
- **Persistence:** Scheduled tasks, IIS manipulation to load suspicious .NET assemblies.
- **Credential Access:** Use of tools such as Mimikatz (LSASS dumping) and Impacket for lateral movement.
- **Impact:** Deployment of ransomware (Warlock, Lockbit), modification of Group Policy Objects for ransomware distribution.
- **Disabling AV:** Abuse of `services.exe` for registry modifications disabling Microsoft Defender.

## Indicators of Compromise (IOCs)

- Malicious files: `spinstall0.aspx`, `IIS_Server_dll.dll`, `SharpHostInfo.x64.exe`, `xd.exe`, `debug_dev.js`  
- Hashes, file paths, and C2 domains provided for precise threat hunting.

## Mitigation and Protection Guidance

1. **Upgrade and Patch:** Use supported SharePoint versions (2016/2019/Subscription Edition) and [apply all latest security updates](https://www.microsoft.com/en-us/security/blog/2025/07/22/disrupting-active-exploitation-of-on-premises-sharepoint-vulnerabilities/).
2. **Enable AMSI and Defender:** Integrate [Antimalware Scan Interface](https://learn.microsoft.com/windows/win32/amsi/antimalware-scan-interface-portal) (enable Full Mode) and [Microsoft Defender Antivirus](https://learn.microsoft.com/defender-endpoint/microsoft-defender-antivirus-on-windows-server) on all servers.
3. **Deploy Defender for Endpoint:** Detection and response for post-exploit activity.
4. **Rotate Machine Keys:** Use PowerShell (`Set-SPMachineKey`) or Central Admin to rotate ASP.NET machine keys.
5. **Restart IIS:** Use `iisreset.exe` on all affected servers.
6. **Incident Response:** Implement your IR plan immediately. Review logs for known IOCs.
7. **Additional Hardening:**
   - Set up block mode for [Microsoft Defender EDR](https://learn.microsoft.com/en-us/defender-endpoint/edr-in-block-mode).
   - Enable LSASS protection, credential guard, attack surface reduction rules, and tamper protection.
   - Limit internet exposure and use VPN/proxy with authentication if AMSI cannot be enabled.

## Detection and Hunting

- Use [provided hashes and file paths](https://msrc.microsoft.com/update-guide/vulnerability/CVE-2025-53770) from this report for threat hunting.
- Employ advanced hunting queries for [Microsoft Defender XDR](https://learn.microsoft.com/en-us/defender-xdr/security-copilot-in-microsoft-365-defender) and vulnerability management.

## References & Further Reading

- [Microsoft Security Blog: Disrupting exploitation of on-premises SharePoint vulnerabilities](https://www.microsoft.com/en-us/security/blog/2025/07/22/disrupting-active-exploitation-of-on-premises-sharepoint-vulnerabilities/)
- [MSRC Blog on CVE-2025-53770](https://msrc.microsoft.com/blog/2025/07/customer-guidance-for-sharepoint-vulnerability-cve-2025-53770/)
- [SharePoint and AMSI Integration](https://learn.microsoft.com/en-us/sharepoint/security-for-sharepoint-server/configure-amsi-integration)

---
**Note from Microsoft Threat Intelligence:** Continued vigilance and timely patching are critical. Monitor for new indicators and mitigation guidance as investigations continue.

This post appeared first on "Microsoft Security Blog". [Read the entire article here](https://www.microsoft.com/en-us/security/blog/2025/07/22/disrupting-active-exploitation-of-on-premises-sharepoint-vulnerabilities/)
